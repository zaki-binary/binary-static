function localizeName(){return text.localize(this.name)}function changeUrlToSameDomain(a){var b=new RegExp("^(http|https)://[.a-zA-Z0-9-]+/"),c=window.location.protocol+"//"+window.location.hostname,d=a.replace(b,c+"/");return d}function formEffects(){var a=function(){$(this).addClass("focus").siblings().addClass("focus").parents("fieldset").addClass("focus")},b=function(){$(this).removeClass("focus").siblings().removeClass("focus").parents("fieldset").removeClass("focus")},c=function(){$(this).parent("div").addClass("focus").parents("fieldset").addClass("focus")},d=function(){$(this).parent("div").removeClass("focus").parents("fieldset").removeClass("focus")};this.set=function(e){e.delegate("select","focus",a).delegate("select","blur",b),e.delegate("input[type=text],input[type=password],textarea","focus",c).delegate("input[type=text],input[type=password],textarea","blur",d)}}function add_click_effect_to_button(){var a=function(a){for(var b=a.split(/\s+/),c="button",d=b.shift();d;){if(d&&d!=c&&!d.match(/-focus|-hover/)){c=d;break}d=b.shift()}return c},b=function(a,b){a.removeClass(b).children(".button").removeClass(b).end().parent(".button").removeClass(b)},c=function(a,b){a.addClass(b).children(".button").addClass(b).end().parent(".button").addClass(b)};$("#content,#popup").delegate(".button","mousedown",function(){var b=a(this.className)+"-focus";c($(this),b)}).delegate(".button","mouseup",function(){var c=a(this.className)+"-focus";b($(this),c)}).delegate(".button","mouseover",function(){var b=a(this.className)+"-hover";c($(this),b)}).delegate(".button","mouseout",function(){var c=a(this.className)+"-hover";b($(this),c)})}function clearInputErrorField(a){var b=document.getElementById(a);if(b){var c=b.parentNode;if(c){var d=document.createElement("p");return d.id=b.id,d.className=b.className,c.replaceChild(d,b),d}return b}}function swithTabIfError(a){return a?($(".errorfield").each(function(){this.innerHTML.length>0&&MenuContent.trigger({content_id:$(this).parents("[id*=-content]").attr("id")})}),1):0}function push_data_layer(){for(var a=gtm_data_layer_info(),b=0;b<a.length;b++)dataLayer[0]=a[b].params,dataLayer.push(a[b].params),dataLayer.push({event:a[b].event})}function updateLiveChart(a){live_chart&&(chart_closed||live_chart.close_chart(),live_chart=null),live_chart="tick"==a.resolution?new LiveChartTick(a):new LiveChartOHLC(a),live_chart.show_chart(),chart_closed=!1}function LiveChartTick(a){LiveChart.call(this,a)}function LiveChartOHLC(a){LiveChart.call(this,a),this.candlestick={},this.candlestick.period=1e3*this.config.resolution_seconds()}function DateTimePicker(a){var b=this;this.date_inp="#"+a.id+"_date",this.time_inp="#"+a.id+"_time",this.minDateTime=a.minDateTime||new Date(2010,1,1),this.maxDateTime=a.maxDateTime||new Date,this.onChange=a.onChange||function(){},$(this.date_inp).datepicker({minDate:this.minDateTime,maxDate:this.maxDateTime,dateFormat:"yy-mm-dd",monthNames:[text.localize("January"),text.localize("February"),text.localize("March"),text.localize("April"),text.localize("May"),text.localize("June"),text.localize("July"),text.localize("August"),text.localize("September"),text.localize("October"),text.localize("November"),text.localize("December")],dayNamesShort:[text.localize("Su"),text.localize("Mo"),text.localize("Tu"),text.localize("We"),text.localize("Th"),text.localize("Fr"),text.localize("Sa")],nextText:text.localize("Next"),prevText:text.localize("Previous")}),$(this.date_inp).change(function(){var a=b.getDateTime();a<b.minDateTime?b.setDateTime(b.minDateTime):a>b.maxDateTime&&b.setDateTime(b.maxDateTime),b.onChange(b.getDateTime())}),$(this.time_inp).change(function(){$(this).val().match(/^([01][0-9]|2[0-3]):[0-5][0-9](:[0-5][0-9])?$/)||$(this).val("00:00:00");var a=b.getDateTime();a<b.minDateTime?b.setDateTime(b.minDateTime):a>b.maxDateTime&&b.setDateTime(b.maxDateTime),b.onChange(b.getDateTime())})}function confirm_popup_action(){$(".bom_confirm_popup_link").on("click",function(a){a.preventDefault(),$.ajax({type:"GET",url:this.href,data:"ajax_only=1",success:function(a){SpotLight.set_content(a),SpotLight.show()}})})}function get_login_page_url(){var a="";try{var b=page.language();if(!b)throw new Error("failed to detect page language");a+="?l="+b}catch(c){console.log("error while getting page language. "+c)}return"https://"+page.settings.get("domains")["private"]+"/login"+a}function listen_to_chart_element(){{var a=null,b=$("#form_chart_director"),c=(document.getElementById("chart_director_imageholder"),$("#chart_properties")),d=$("#chart_overlay_or_new"),e={},f=$("#lightchart_texts").find("li"),g=$("#chart_compare_underlying");$("#chart_period")}f.each(function(){e[this.id]=this.innerHTML});var h=$("#instrument-content");h.find("input[value="+g.find("li:first input[name=overlay]").val()+"]").attr("checked","checked"),$("#form_chart_director input[name=symbol]").val(g.find("li:first input[name=overlay]").val().replace(/-$/,"")),draw_chart(),rearrange_compare_underlying_list();var i=function(){a.removeClass("hover").find(".menu-wrap-a .tm-a").unwrap().unwrap()},j={},k={};$(".drop-down").on("mouseover",".tm-li",function(b){var c=$(b.target);c.hasClass(".tm-li")||(c=c.parents(".tm-li")),a=c,c.parents(".tm-ul").find(".menu-wrap-a .tm-a").unwrap().unwrap().end().end().siblings().removeClass("hover").end().find(".tm-a").wrap('<span class="menu-wrap-a"><span class="menu-wrap-b"></span></span>')}).on("mouseout",".tm-li",function(b){a.hasClass("hover")||$(b.target).parents(".tm-ul").find(".menu-wrap-a .tm-a").unwrap().unwrap()});var l={};$("#form_chart_director").find("input[type=radio]").each(function(){this.checked&&(l[this.name]=this.id)}).end().on("click","input[name=period],input[name=interval]",function(a){var b=$(a.target);"interval"==b.attr("name")&&(b=$(document.getElementById("pr_1")).attr("checked","checked"),$("#settings-content").find("input[value=CLOSE]").attr("checked","checked")),draw_chart(function(){return b.parents("#chart_period").find(".button").removeClass("disabled").end().end().siblings("label").addClass("disabled").children().addClass("disabled"),!0})}).on("click","#settings-content input,input[value=None]",function(){draw_chart()}).on("click","#band-content input,#indicator-content input,#moving-average-content input,#instrument-content input",function(a){var d=a.target.value,e=d.replace(/-$/,""),f=a.target.name,h=a.target.id;if("checkbox"==a.target.type.toLowerCase()&&!a.target.checked)return $("#chart_compare_underlying").find("ul").find("li input[value^="+$(this).val()+"]").parents("li").remove(),$("#form_chart_director input[name=symbol]").val($("#chart_compare_underlying").find("li:first input[name=overlay]").val().replace(/-$/,"")),draw_chart(),!0;if(a.target.checked&&(k=a.target),"__selsym"==f){var l=g.find("li");return l.size()>5&&l.filter(":nth-child(2)").remove(),l.filter(":last").after("<li>"+$(a.target).next().html()+'<input type="checkbox" checked="checked" value="'+d+'-" name="overlay" /></li>'),$("#form_chart_director input[name=symbol]").val(d),rearrange_compare_underlying_list(),i(),draw_chart(),!0}return"object"==typeof j[e]?(j[e].removeClass("invisible").data("related_input_name",f).data("related_input_id",h),i(),!0):void $.get(b.attr("action")+"&"+b.serialize()+"&getdesc="+e+"&prefix="+f,function(a){return a?(j[e]=$('<div class="popupbox">'+decodeURIComponent(a)+"</div>").appendTo(c),void j[e].removeClass("invisible").data("related_input_name",f).data("related_input_id",h)):(draw_chart(),!1)})}).on("click","div.popupbox .close-button",function(a){var b=$(a.target).parents("div.popupbox").addClass("invisible");$("#"+l[b.data("related_input_name")]).attr("checked","checked"),$(k).removeAttr("checked")}).on("click","div.popupbox button[type=submit]",function(a){a.preventDefault();var b=$(a.target).parents("div.popupbox"),c=check_input_error(b);c&&(l[b.data("related_input_name")]=b.data("related_input_id"),draw_chart(function(){b.addClass("invisible")})),k=null}).on("mouseover","#chart_compare_underlying li",function(a){$(a.target).addClass("hover").parents("li").addClass("hover")}).on("mouseout","#chart_compare_underlying li",function(a){$(a.target).removeClass("hover").parents("li").removeClass("hover")}).on("click","#chart_overlay_or_new .draw-overlay",function(){if("overlay"==d.find("input:checked").val()){var a=g.find("li");a.size()>5&&a.filter(":nth-child(2)").remove(),a.filter(":last").after('<li><a href="#">'+d.find("h4").html()+'</a><input type="checkbox" checked="checked" value="'+l[d.data("related_input_name")]+'" name="overlay"></li>'),g.find("li").each(function(a){this.className="line_"+(a+1)})}}),$("li.interval").hover(function(){$("#intraday_interval").show()},function(){$("#intraday_interval").hide()})}function currencyConvertorCalculator(){var a=document.getElementById("currencyto");a.options.length>0&&(a.options.length=0);var b=0;return $("#currencyfrom").find("option").each(function(){this.selected!==!0&&(a.options[b]=new Option(this.value,this.text),b++)}),!0}function checkCurrencyAmountFormat(a){var b=$(a).val(),c="^\\d+(\\.)?(\\d)?(\\d)?$",d=new RegExp(c),e=$("#currencyconverterror"),f=$("#currencysubmit");return""===b?(e.addClass("invisible button-disabled"),f.attr("disabled","disabled").addClass("button-disabled").parents(".button").addClass("button-disabled"),1):(!d.test(b)&&e?(e.removeClass("invisible"),f.attr("disabled","disabled").addClass("button-disabled").parents(".button").addClass("button-disabled")):(e.addClass("invisible"),f.removeAttr("disabled").removeClass("button-disabled").parents(".button").removeClass("button-disabled")),!1)}function initialize_pricing_table(){calculate_button_event(),bet_type_select(),select_underlying_change(),select_strike_type(),expiry_date_picker()}function requestTradeAnalysis(){"use strict";$.ajax({method:"POST",url:page.url.url_for("trade/trading_analysis"),data:{underlying:sessionStorage.getItem("underlying"),formname:sessionStorage.getItem("formname"),contract_category:Contract.form(),barrier:Contract.barrier()}}).done(function(a){var b=document.getElementById("trading_bottom_content");b.innerHTML=a,sessionStorage.setItem("currentAnalysisTab",getActiveTab()),bindAnalysisTabEvent(),loadAnalysisTab()})}function bindAnalysisTabEvent(){"use strict";var a=document.querySelector("#trading_bottom_content #betsBottomPage");a&&a.addEventListener("click",function(a){if(a.target&&"A"===a.target.nodeName){a.preventDefault();var b=a.target,c=b.parentElement,d=c.classList.contains("active");sessionStorage.setItem("currentAnalysisTab",c.id),d||loadAnalysisTab()}})}function loadAnalysisTab(){"use strict";var a=getActiveTab(),b=document.querySelector("#"+a+" a"),c=document.getElementById(a+"-content"),d=document.querySelector("#trading_bottom_content #betsBottomPage");if(toggleActiveNavMenuElement(d,b.parentElement),toggleActiveAnalysisTabs(),"tab_graph"===a)BetAnalysis.tab_live_chart.reset(),BetAnalysis.tab_live_chart.render(!0);else{var e=b.getAttribute("href");$.ajax({method:"GET",url:e}).done(function(b){c.innerHTML=b,"tab_intradayprices"===a?bindSubmitForIntradayPrices():"tab_ohlc"===a&&bindSubmitForDailyPrices()})}}function toggleActiveAnalysisTabs(){"use strict";var a=getActiveTab(),b=document.getElementById("bet_bottom_content");if(b){for(var c=b.children,d=document.getElementById(a+"-content"),e=d.classList,f=0,g=c.length;g>f;f++)c[f].classList.remove("selectedTab"),c[f].classList.add("invisible");e.add("selectedTab"),e.remove("invisible")}}function getActiveTab(){var a=sessionStorage.getItem("currentAnalysisTab")||"tab_explanation",b=document.getElementById(a);return b&&b.classList.contains("invisible")&&(a="tab_explanation",sessionStorage.setItem("currentAnalysisTab","tab_explanation")),a}function bindSubmitForIntradayPrices(){var a=document.getElementById("intraday_prices_submit");a&&a.addEventListener("click",function(a){a.preventDefault();var b=document.getElementById("analysis_intraday_prices_form"),c=document.querySelector("#tab_intradayprices-content"),d=c.querySelector('select[name="underlying"]'),e=c.querySelector('select[name="date"]');$.ajax({method:"GET",url:b.getAttribute("action")+"&underlying="+d.value+"&date="+e.value}).done(function(a){c.innerHTML=a,bindSubmitForIntradayPrices()})})}function bindSubmitForDailyPrices(){var a=document.getElementById("daily_prices_submit");a&&a.addEventListener("click",function(a){a.preventDefault();var b=document.getElementById("analysis_daily_prices_form"),c=document.querySelector("#tab_ohlc-content"),d=sessionStorage.getItem("underlying"),e=c.querySelector('input[name="days_to_display"]');$.ajax({method:"GET",url:b.getAttribute("action")+"&underlying_symbol="+d+"&days_to_display="+e.value}).done(function(a){c.innerHTML=a,bindSubmitForDailyPrices()})})}function displayContractForms(a,b,c){"use strict";{var d=document.getElementById(a),e=document.createDocumentFragment();b.length}if(d.innerHTML="",b){for(var f=getContractCategoryTree(b),g=0;g<f.length;g++){var h=f[g],i=document.createElement("li");if(i.classList.add("tm-li"),0===g?i.classList.add("first"):g===f.length-1&&i.classList.add("last"),"object"==typeof h){for(var j=document.createDocumentFragment(),k=0,l="",m=0;m<h[1].length;m++){var n=h[1][m],o=document.createElement("li"),p=document.createElement("a"),q=document.createTextNode(b[n]);o.classList.add("tm-li-2"),0===m?(l=n.toLowerCase(),o.classList.add("first")):m===h[1].length-1&&o.classList.add("last");c&&c===n.toLowerCase()&&(o.classList.add("active"),p.classList.add("a-active"),k=1),p.classList.add("tm-a-2"),p.appendChild(q),p.setAttribute("menuitem",n.toLowerCase()),p.setAttribute("id",n.toLowerCase()),o.appendChild(p),j.appendChild(o)}if(j.hasChildNodes()){var r=document.createElement("ul"),s=document.createElement("a"),t=document.createTextNode(b[h[0]]);s.appendChild(t),s.setAttribute("class","tm-a"),s.setAttribute("menuitem",l),r.appendChild(j),r.setAttribute("class","tm-ul-2"),k&&i.classList.add("active"),i.appendChild(s),i.appendChild(r)}}else{var u=document.createTextNode(b[h]),v=document.createElement("a");c&&c===h.toLowerCase()&&(v.classList.add("a-active"),i.classList.add("active")),v.appendChild(u),v.classList.add("tm-a"),v.setAttribute("menuitem",h),v.setAttribute("id",h.toLowerCase()),i.appendChild(v)}e.appendChild(i)}if(d){d.appendChild(e);for(var w=d.getElementsByClassName("tm-li"),x=0;x<w.length;x++){var y=w[x];y.addEventListener("mouseover",function(){this.classList.add("hover")}),y.addEventListener("mouseout",function(){this.classList.remove("hover")})}}}}function displayMarkets(a,b,c){"use strict";for(var d=document.getElementById(a),e=document.createDocumentFragment();d&&d.firstChild;)d.removeChild(d.firstChild);for(var f in b)if(b.hasOwnProperty(f)){var g=document.createElement("option"),h=document.createTextNode(b[f].name);if(g.setAttribute("value",f),c&&c===f&&g.setAttribute("selected","selected"),b[f].is_active||g.setAttribute("disabled",""),g.appendChild(h),e.appendChild(g),b[f].submarkets&&Object.keys(b[f].submarkets).length)for(var i in b[f].submarkets)i&&(g=document.createElement("option"),g.setAttribute("value",i),c&&c===i&&g.setAttribute("selected","selected"),b[f].submarkets[i].is_active||g.setAttribute("disabled",""),g.textContent="    "+b[f].submarkets[i].name,e.appendChild(g))}d&&d.appendChild(e)}function displayOptions(a,b,c){"use strict";for(var d=document.getElementById(a),e=document.createDocumentFragment();d&&d.firstChild;)d.removeChild(d.firstChild);for(var f in b)if(b.hasOwnProperty(f)){var g=document.createElement("option"),h=document.createTextNode(b[f]);g.setAttribute("value",f),c&&c===f&&g.setAttribute("selected","selected"),g.appendChild(h),e.appendChild(g)}d&&d.appendChild(e)}function displayUnderlyings(a,b,c){"use strict";for(var d=document.getElementById(a),e=document.createDocumentFragment();d&&d.firstChild;)d.removeChild(d.firstChild);if(b){var f=Object.keys(b).sort(function(a,c){return b[a].display.localeCompare(b[c].display)});f.forEach(function(a){if(b.hasOwnProperty(a)){var d=document.createElement("option"),f=document.createTextNode(b[a].display);d.setAttribute("value",a),1!==b[a].is_active&&d.setAttribute("disabled",!0),c&&c===a&&d.setAttribute("selected","selected"),d.appendChild(f),e.appendChild(d)}})}d&&d.appendChild(e)}function getFormNameBarrierCategory(a){"use strict";var b={};return a?"risefall"===a?(b.formName="callput",b.barrierCategory="euro_atm"):"higherlower"===a?(b.formName="callput",b.barrierCategory="euro_non_atm"):"callput"===a?(b.formName=a,b.barrierCategory="euro_atm"):(b.formName=a,b.barrierCategory=""):(b.formName="callput",b.barrierCategory="euro_atm"),b}function contractTypeDisplayMapping(a){"use strict";var b={CALL:"top",PUT:"bottom",ASIANU:"top",ASIAND:"bottom",DIGITMATCH:"top",DIGITDIFF:"bottom",EXPIRYRANGE:"top",EXPIRYMISS:"bottom",RANGE:"top",UPORDOWN:"bottom",ONETOUCH:"top",NOTOUCH:"bottom",SPREADU:"top",SPREADD:"bottom"};return a?b[a]:"top"}function isVisible(a){"use strict";return 0===a.offsetWidth&&0===a.offsetHeight?!1:!0}function hideLoadingOverlay(){"use strict";var a=document.getElementById("loading_container");a&&(a.style.display="none")}function showLoadingOverlay(){"use strict";var a=document.getElementById("loading_container");a&&(a.style.display="block")}function showPriceOverlay(){"use strict";var a=document.getElementById("loading_container2");a&&(a.style.display="block")}function hidePriceOverlay(){"use strict";var a=document.getElementById("loading_container2");a&&(a.style.display="none")}function hideOverlayContainer(){"use strict";var a=document.getElementById("contract_confirmation_container");a&&(a.style.display="none");var b=document.getElementById("contracts_list");b&&(b.style.display="flex")}function compareMarkets(a,b){"use strict";var c={forex:0,indices:1,stocks:2,commodities:3,random:4};return c[a.toLowerCase()]<c[b.toLowerCase()]?-1:c[a.toLowerCase()]>c[b.toLowerCase()]?1:0}function getContractCategoryTree(a){"use strict";var b=[["updown",["risefall","higherlower"]],"touchnotouch",["inout",["endsinout","staysinout"]],"asian","digits","spreads"];return a&&(b=b.map(function(b){return"object"==typeof b?(b[1]=b[1].filter(function(b){return a[b]}),b[1].length||(b="")):a[b]||(b=""),b}),b=b.filter(function(a){return a.length})),b}function getCookieItem(a){"use strict";return a?decodeURIComponent(document.cookie.replace(new RegExp("(?:(?:^|.*;)\\s*"+encodeURIComponent(a).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=\\s*([^;]*).*$)|^.*$"),"$1"))||null:null}function displayPriceMovement(a,b,c){"use strict";a.classList.remove("price_moved_down"),a.classList.remove("price_moved_up"),parseFloat(c)>parseFloat(b)?(a.classList.remove("price_moved_down"),a.classList.add("price_moved_up")):parseFloat(c)<parseFloat(b)&&(a.classList.remove("price_moved_up"),a.classList.add("price_moved_down"))}function toggleActiveNavMenuElement(a,b){"use strict";var c=a.getElementsByTagName("li"),d=b.classList;if(!d.contains("active")){for(var e=0,f=c.length;f>e;e++)c[e].classList.remove("active");d.add("active")}}function toggleActiveCatMenuElement(a,b){"use strict";var c=document.getElementById(b),d=a.querySelectorAll(".active, .a-active"),e=c.classList;if(!e.contains("active")){for(var f=0,g=d.length;g>f;f++)d[f].classList.remove("active"),d[f].classList.remove("a-active");e.add("a-active"),f=0;for(var h;(h=c.parentElement)&&h.id!==a.id&&10>f;)"LI"===h.tagName&&h.classList.add("active"),c=h,f++}}function setFormPlaceholderContent(a){"use strict";var b=document.getElementById("contract_form_nav_placeholder");b&&(a=a||sessionStorage.getItem("formname"),b.textContent=Contract.contractForms()[a])}function displayCommentPrice(a,b,c,d){"use strict";if(a&&c&&d){var e=d-c,f=e/c*100,g=Content.localize().textNetProfit+": "+b+" "+e.toFixed(2)+" | "+Content.localize().textReturn+" "+f.toFixed(0)+"%";isNaN(e)||isNaN(f)?a.hide():(a.show(),a.textContent=g)}}function displayCommentSpreads(a,b,c){"use strict";if(a&&c){var d=document.getElementById("amount_per_point").value,e=document.querySelector('input[name="stop_type"]:checked').value,f=document.getElementById("stop_loss").value,g=0;isNaN(f)||isNaN(d)?a.hide():(g=parseFloat("point"===e?parseFloat(d)*parseFloat(f):f),a.textContent=Content.localize().textSpreadDepositComment+" "+b+" "+g+" "+Content.localize().textSpreadRequiredComment+": "+c+" "+Content.localize().textSpreadPointsComment)}}function debounce(a,b,c){"use strict";var d,e=b||500;return function(){var b=this,f=arguments,g=function(){d=null,c||a.apply(b,f)},h=c&&!d;clearTimeout(d),d=setTimeout(g,e),h&&a.apply(b,f)}}function getDefaultMarket(){"use strict";var a=sessionStorage.getItem("market"),b=Symbols.markets(1);return a&&b[a]||(a=Object.keys(b)[0]),a}function addEventListenerForm(){"use strict";document.getElementById("websocket_form").addEventListener("submit",function(a){return a.currentTarget.classList.add("submitted"),a.preventDefault(),!1},!1)}function submitForm(a){"use strict";var b=a.ownerDocument.createElement("input");b.style.display="none",b.type="submit",a.appendChild(b).click(),a.removeChild(b)}function displayIndicativeBarrier(){"use strict";var a=document.getElementById("duration_units"),b=Tick.quote(),c=document.getElementById("indicative_barrier_tooltip"),d=document.getElementById("indicative_high_barrier_tooltip"),e=document.getElementById("indicative_low_barrier_tooltip"),f=document.getElementById("barrier"),g=document.getElementById("barrier_high"),h=document.getElementById("barrier_low");if(a&&"d"!==a.value&&b&&!isNaN(b)){var i=countDecimalPlaces(b);c&&isVisible(c)&&(c.textContent=(parseFloat(b)+parseFloat(f.value)).toFixed(i)),d&&isVisible(d)&&(d.textContent=(parseFloat(b)+parseFloat(g.value)).toFixed(i)),e&&isVisible(e)&&(e.textContent=(parseFloat(b)+parseFloat(h.value)).toFixed(i))}else c.textContent="",d.textContent="",e.textContent=""}function durationOrder(a){"use strict";var b={t:1,s:2,m:3,h:4,d:5};return b[a]}function displayTooltip(a,b){"use strict";var c=document.getElementById("symbol_tip");a.match(/^random/)?(c.show(),c.setAttribute("href","https://www.binary.com/get-started/random-markets")):b.match(/^SYN/)?(c.show(),c.setAttribute("href","https://www.binary.com/smart-indices")):c.hide()}function countDecimalPlaces(a){"use strict";if(!isNaN(a)){var b=a.toString();return-1!==b.indexOf(".")?b.split(".")[1].length:0}}function displayCurrencies(a){"use strict";for(var b=document.getElementById("currency"),c=document.createDocumentFragment(),d=JSON.parse(sessionStorage.getItem("currencies")).payout_currencies;b&&b.firstChild;)b.removeChild(b.firstChild);d.forEach(function(b){var d=document.createElement("option"),e=document.createTextNode(b);d.setAttribute("value",b),a&&a==key&&d.setAttribute("selected","selected"),d.appendChild(e),c.appendChild(d)}),b.appendChild(c)}function processActiveSymbols(a){"use strict";Symbols.details(a);var b=getDefaultMarket();sessionStorage.setItem("market",b),displayMarkets("contract_markets",Symbols.markets(),b),processMarket(),setTimeout(function(){if(1===TradeSocket.socket().readyState){{document.getElementById("underlying").value}Symbols.getSymbols(0)}},6e4)}function processMarket(a){"use strict";var b=sessionStorage.getItem("market"),c=sessionStorage.getItem("underlying"),d=Symbols.need_page_update()||a;!d||c&&Symbols.underlyings()[b][c]&&Symbols.underlyings()[b][c].is_active||(c=void 0),displayUnderlyings("underlying",Symbols.underlyings()[b],c),d&&processMarketUnderlying()}function processMarketUnderlying(){"use strict";var a=document.getElementById("underlying").value;sessionStorage.setItem("underlying",a),processForgetTickId(),TradeSocket.send({ticks:a}),Contract.getContracts(a),displayTooltip(sessionStorage.getItem("market"),a),requestTradeAnalysis()}function processContract(a){"use strict";Contract.setContracts(a);var b,c=Contract.contractForms();if(sessionStorage.getItem("formname")&&c[sessionStorage.getItem("formname")])b=sessionStorage.getItem("formname");else{var d=getContractCategoryTree(c);d[0]&&(b="object"==typeof d[0]?d[0][1][0]:d[0])}sessionStorage.setItem("formname",b),setFormPlaceholderContent(b),displayContractForms("contract_form_name_nav",c,b),processContractForm()}function processContractForm(){Contract.details(sessionStorage.getItem("formname")),displayStartDates(),Durations.display(),displayPrediction(),displaySpreads(),processPriceRequest()}function displayPrediction(){var a=document.getElementById("prediction_row");"digits"===sessionStorage.getItem("formname")?a.show():a.hide()}function displaySpreads(){var a=document.getElementById("amount_type"),b=document.getElementById("amount_per_point_label"),c=document.getElementById("amount"),d=document.getElementById("amount_per_point"),e=document.getElementById("spread_element_container"),f=document.getElementById("stop_type_dollar_label"),g=document.getElementById("expiry_row");"spreads"===sessionStorage.getItem("formname")?(a.hide(),c.hide(),g.hide(),b.show(),d.show(),e.show(),f.textContent=document.getElementById("currency").value):(b.hide(),d.hide(),e.hide(),g.show(),a.show(),c.show())}function processForgetPriceIds(){"use strict";if(Price){showPriceOverlay();var a=Price.bufferRequests(),b=Price.getFormId(),c=Price.bufferedIds();for(var d in a)a[d]&&a[d].passthrough.form_id!==b&&(TradeSocket.send({forget:d}),delete a[d],delete c[d]);Price.clearMapping()}}function processPriceRequest(){"use strict";Price.incrFormId(),processForgetPriceIds(),showPriceOverlay();for(var a in Contract.contractType()[Contract.form()])Contract.contractType()[Contract.form()].hasOwnProperty(a)&&TradeSocket.send(Price.proposal(a))}function processForgetTickId(){"use strict";if(Tick){var a=Tick.bufferedIds();for(var b in a)a.hasOwnProperty(b)&&(TradeSocket.send({forget:b}),delete a[b])}}function processTick(a){"use strict";Tick.details(a),Tick.display(),WSTickDisplay.updateChart(a),Purchase.update_spot_list(a),Barriers.isBarrierUpdated()||(Barriers.display(),Barriers.setBarrierUpdate(!0))}function processProposal(a){"use strict";var b=Price.bufferRequests(),c=Price.getFormId();(!b[a.proposal.id]&&a.echo_req.hasOwnProperty("passthrough")&&a.echo_req.passthrough.hasOwnProperty("form_id")&&a.echo_req.passthrough.form_id===c||b[a.proposal.id]&&b[a.proposal.id].passthrough.form_id===Price.getFormId())&&(hideOverlayContainer(),Price.display(a,Contract.contractType()[Contract.form()]),hidePriceOverlay(),1===c&&(document.getElementById("trading_socket_container").classList.add("show"),document.getElementById("trading_init_progress").style.display="none"))}function processTradingTimesRequest(a){var b=Durations.trading_times();b.hasOwnProperty(a)?processPriceRequest():(showPriceOverlay(),TradeSocket.send({trading_times:a}))}function processTradingTimes(a){Durations.trading_times();Durations.processTradingTimesAnswer(a),processPriceRequest()}function compareStartDate(a,b){"use strict";return a.date<b.date?-1:a.date>b.date?1:0}function displayStartDates(){"use strict";var a=Contract.startDates();if(a&&a.list.length){var b=document.getElementById("date_start"),c=document.createDocumentFragment(),d=document.getElementById("date_start_row");for(d.style.display="flex";b&&b.firstChild;)b.removeChild(b.firstChild);if(a.has_spot){var e=document.createElement("option"),f=document.createTextNode(Content.localize().textNow);e.setAttribute("value","now"),e.appendChild(f),c.appendChild(e)}a.list.sort(compareStartDate),a.list.forEach(function(a){var b=moment.unix(a.open).utc(),d=moment.unix(a.close).utc(),g=3e5,h=moment();for(moment(h).isAfter(moment(b))&&(b=h),b=moment(Math.ceil(+b/g)*g).utc();b.isBefore(d);)e=document.createElement("option"),e.setAttribute("value",b.utc().unix()),f=document.createTextNode(b.format("HH:mm ddd")),e.appendChild(f),c.appendChild(e),b.add(5,"minutes")}),b.appendChild(c)}else document.getElementById("date_start_row").style.display="none"}function showLoadingImage(a){var b=page.settings.get("image_link");a.empty().append('<div id="std_loading_img"><p>'+text.localize("loading...")+'</p><img src="'+b.hourglass+'" /></div>')}function getFormParams(a){var b=[];if(!a)return"";for(var c=a.elements,d=0,e=0;e<c.length;e++)if(c[e].name){if("INPUT"==c[e].nodeName&&c[e].type.match(/radio|checkbox/)&&!c[e].checked)continue;b[d]=c[e].name+"="+encodeURIComponent(c[e].value),d++}var f=b.join("&");return f}function virgule(a){if(isNaN(a))return a;var b="",c=a;if(0>a&&(c=-1*c,b="-"),1e3>c)return b+c;var d=",";arguments.length>1&&(d=arguments[1]);var e=c,f="",g=/(\d{3,})\.(\d+)/.exec(c);g&&(e=g[1],f="."+g[2]);var h=/(\d+)(\d\d\d)$/.exec(e);return b+virgule(h[1],d)+d+h[2]+f}function getImageLink(){var a=page.settings.get("image_link");return'<img src="'+a.hourglass+'" class="bet_bottom_loading_image" />'}function price_moved(a,b,c){b>c?(a.removeClass("price_moved_up"),a.addClass("price_moved_down")):c>b?(a.removeClass("price_moved_down"),a.addClass("price_moved_up")):(a.removeClass("price_moved_down"),a.removeClass("price_moved_up"))}function get_highest_zindex(a){a||(a="div,p,area,nav,section,header,canvas,aside,span");var b=[],c=function(){if($(this).is(":visible")){var a=$(this).css("z-index");isNaN(a)||b.push(a)}};return $(a).each(c),b.length?Math.max.apply(Math,b):null}function stylized_price(a){var b="0",c="00";if(a){a=Math.round(100*a)/100;var d=a.toString(),e=d.split(".");b=virgule(e[0]),c=e[1]||"00",c.length<2&&(c+="0")}return{units:b,cents:"."+c}}function element_data_attrs(a){if(a&&a instanceof jQuery&&(a=a.get().pop()),!a||!a.attributes)throw console.log(a),new Error("Can not get data attributes from none element parameter");var b={},c=a.attributes;if(c.length)for(var d=["id","class","name","style","href","src","title","onclick"],e=0;e<c.length;e++){var f=c[e];d.indexOf(f.name.toLowerCase())>-1||(b[f.name]=f.value)}return b}function element_data_attrs_as_form_params(a){var b,c=element_data_attrs(a),d=[];for(b in c)if(c.hasOwnProperty(b)){var e=c[b];if(void 0===e)continue;d.push(b+"="+encodeURIComponent(e))}return d.join("&")}function snake_case_to_camel_case(a,b,c){c=c||"_-";var d=function(a){return a[1].toUpperCase()},e=new RegExp("["+c+"]([a-zA-Z])","g"),f=a.replace(e,d);return f.replace("_",""),b&&(f=f[0].toLowerCase()+f.substr(1)),f}function attach_date_picker(a,b){var c,d=$(a);if(!d||!d.length)return!1;var e=new Date,f=new Date;f.setDate(e.getDate()+365);var g={dateFormat:"yy-mm-dd",maxDate:f};for(c in b)b.hasOwnProperty(c)&&(g[c]=b[c]);return d.datepicker(g)}function attach_time_picker(a,b){var c,d,e=$(a);if(!e||!e.length)return!1;var f={timeSeparator:":",showLeadingZero:!0,howMinutesLeadingZero:!0,hourText:text.localize("Hour"),minuteText:text.localize("Minute"),minTime:{},maxTime:{}},g=element_data_attrs(e),h=/^time\:(.+)/;for(c in g)if(g.hasOwnProperty(c)){var i=c.match(h);if(i){var j=g[c],k=i[1].trim();switch("true"==j?j=!0:"false"==j&&(j=!1),k=snake_case_to_camel_case(k,!0).toLowerCase()){case"mintimehour":f.minTime.hour=j;break;case"mintimeminute":f.minTime.minute=j;break;case"maxtimehour":f.maxTime.hour=j;break;case"maxtimeminute":f.maxTime.minute=j}}}for(d in b)b.hasOwnProperty(d)&&(f[d]=b[d]);return e.timepicker(f)}function attach_inpage_popup(a){var b=$(a),c=[],d=/^popup-(.+)/;return b.each(function(){var a,b,e=element_data_attrs(this),f={};for(a in e)e.hasOwnProperty(a)&&(b=a.match(d),b&&(f[b[1]]=e[a]));var g=new InPagePopup(f);g.attach(this),c.push(g)}),c}function get_container_width(){var a=960;return a=$(".chart_holder").length>0?$(".chart_holder").width():$(".grd-container").width()}function find_active_jqtab(a){var b=$(a),c=b.children("ul");if(!c)throw new Error("Invalid parameter. element is not a jquery UI tab container");c=c.filter(":first");for(var d=c.children("li"),e=0;e<d.length;e++)if($(d[e]).hasClass("active"))return e;return 0}function attach_tabs(a){var b=$(a);return b.each(function(){var a=$(this),b={},c=0;try{c=find_active_jqtab(a)}catch(d){console.log(d),console.log(a)}c&&(b.active=c,$("li.active",a).removeClass("active")),a.tabs(b)}),b}window.applicationCache&&(window.applicationCache.addEventListener("updateready",function(){if(window.applicationCache.status===window.applicationCache.UPDATEREADY)try{window.applicationCache.swapCache();
var a=$("#appcache-reload-message");a.css("display","block"),a.on("click","#appcache-refresh-link",function(){return window.location.reload(),!1})}catch(b){}},!1),setInterval(function(){try{window.applicationCache.update()}catch(a){}},3e5));var InPagePopup=function(a){a||(a={}),"object"!=typeof a&&(a={content:a}),this.element=null,this._container=null,this.width=a.width||null,this.close_on_escape="undefined"==typeof a.close_on_escape?!0:a.close_on_escape,this.draggable="undefined"==typeof a.draggable?!0:a.draggable,this.drag_handle=a.drag_handle||".drag-handle",this.ajax_conf=a.ajax_conf||null,this._content=a.content||""};InPagePopup.prototype.config=function(a){a.width&&(this.width=a.width),"undefined"!=typeof a.close_on_escape&&(this.close_on_escape=!!a.close_on_escape),"undefined"!=typeof a.draggable&&(this.draggable=!!a.draggable),a.drag_handle&&(this.drag_handle=a.drag_handle),a.ajax_conf&&(this.ajax_conf=a.ajax_conf)},InPagePopup.prototype.content=function(a){var b=this;return"undefined"==typeof a?this._container?$(".inpage_popup_content",b._container).html():this._content:(this._container?$(".inpage_popup_content",b._container).html(_new_content):this._content=a,this)},InPagePopup.prototype.find_element_popup_content=function(a){if(!a)throw new Error("failed to detect element contents. no element specified");var b=$(a),c=b.length;for(i=0;c>i;i++){var d=b.get(i),e=$(d).attr("id");if(e){var f=e+"-content",g=$(".inpage_popup_content#"+f);if(g.length)return g.first()}}return null},InPagePopup.prototype._ajax_request=function(a,b){return conf={},this.ajax_conf&&(conf="function"==typeof this.ajax_conf?this.ajax_conf():this.ajax_conf),"object"!=typeof conf&&(conf={url:conf}),a&&(conf.success=a),b&&(conf.error=b),$.ajax(conf),this},InPagePopup.prototype.fetch_remote_content=function(a,b,c,d){var e=this;d||(d=function(a,b,c){throw new Error("Failed to fetch contents of the popup: "+c)});var f=function(d,f,g){return b&&(d=b(d,f,g,e),!d)?!1:(e.content(d),a!==!1&&e.show(),void(c&&c(d,f,g,e)))};return this._ajax_request(f,d),this},InPagePopup.prototype._init_container=function(){this.close();var a=this,b=$('<div class="inpage_popup_container"><a class="close">x</a></div>'),c=this.element?this.find_element_popup_content(this.element):null,d=c?c.clone():null;return d||(d=$('<div class="inpage_popup_content">'+this._content+"</div>")),b.append(d),b.hide(),d.show().removeClass("invisible"),$(document.body).append(b),a.width&&b.width(a.width),this._container=b,b.find(".close").on("click",function(){a.close()}),this.close_on_escape&&$(document).on("keydown",function(b){27==b.which&&a.close()}),this.draggable&&(handle=this.drag_handle,drag_opts={},$(handle,b).length&&(drag_opts.handle=handle),b.draggable(drag_opts)),this.reposition(),b},InPagePopup.prototype.reposition=function(a,b){if(this._container){var c=$(window),d=this._container;"undefined"==typeof a&&(a=Math.max(Math.floor((c.width()-d.width())/2),50)+c.scrollLeft()),"undefined"==typeof b&&(b=Math.max(Math.floor((c.height()-d.height())/2),50)+c.scrollTop()),this._container.offset({left:a,top:b})}return this},InPagePopup.prototype.container=function(){return this._container||this._init_container(),this._container},InPagePopup.prototype.show=function(){return this.container().show(),this},InPagePopup.prototype.close=function(){return this._container&&this._container.hide().remove(),this._container=null,this},InPagePopup.prototype.attach=function(a){var b=this;this.detach();var c=$(a);if(!c.length)throw new Error("Failed to attach inpage popup. no such element exists for: "+a);return this.element=c,this.element.on("click",function(a){a.preventDefault(),b.show()}),c.each(function(){this.inpage_popup=b}),this},InPagePopup.prototype.detach=function(){return this.element&&(this.element.off("click"),this.element.each(function(){this.inpage_popup=null})),this.element=null,this};var Markets=function(a,b){this.all=[];for(var c=a.length;c--;){var d=a[c],e=b[d],f=new Market(d,e.label,e.submarkets);this.all.push(f)}};Markets.prototype={each:function(a){for(var b=this.all.length;b--;)a.call(this.all[b])},by_symbol:function(a){for(var b=this.all.length;b--;){var c=this.all[b].by_symbol(a);if(c)return c}},get:function(a){for(var b=this.all.length;b--;)if(this.all[b].name==a)return this.all[b]}};var Market=function(a,b,c){this.name=a,this.display_name=b,this.submarkets=[],this.all_submarkets=[];for(var d=c.length;d--;){var e=c[d],f=new SubMarket(e.name,e.label,e.instruments);this.submarkets.push(f),this.all_submarkets.push(f)}};Market.prototype={translated_display_name:function(){return text.localize(this.display_name)},by_symbol:function(a){for(var b=this.submarkets.length;b--;)if(found=this.submarkets[b].by_symbol(a))return found.market=this,found},each:function(a){for(var b=this.all_submarkets.length;b--;)a.call(this.all_submarkets[b])},get:function(a){if("ALL"==a.toUpperCase())return this.all_submarkets;for(var b=this.submarkets.length;b--;)if(this.submarkets[b].name==a)return this.submarkets[b]}};var SubMarket=function(a,b,c){this.name=a,this.display_name=b,this.underlyings=[];for(var d=c.length;d--;){var e=c[d],f={name:e.label,symbol:e.value,translated_display_name:localizeName};this.underlyings.push(f)}};SubMarket.prototype={translated_display_name:function(){return text.localize(this.display_name)},each:function(a){for(var b=this.underlyings.length;b--;)a.call(this.underlyings[b])},by_symbol:function(a){for(var b=this.underlyings.length;b--;)if(this.underlyings[b].symbol==a)return{submarket:this,underlying:this.underlyings[b]}}};var MenuContent=function(){var a=[],b={init:function(a){a.filter(":not(.follow-default)").delegate(".tm-a,.tm-a-2","click",function(a){a.preventDefault();var c=$(a.target),d=c.parents("li:first").attr("id");if(d){var e=c.parents(".tm-ul"),f=e.find(".tm-a,.tm-a-2").removeClass("a-active").end().find(".menu-wrap-a .tm-a").unwrap().unwrap().end().end().addClass("a-active").parents(".tm-li").addClass("active").removeClass("hover").find(".tm-li-2").addClass("active").end().find(".tm-a").wrap('<span class="menu-wrap-a"><span class="menu-wrap-b"></span></span>').end().siblings().removeClass("active").find(".tm-li-2").removeClass("active").end().end().end(),g=e.find("span.tm-a");g.replaceWith('<a href="#" class="'+g.attr("class")+'">'+g.html()+"</a>");var h=f.parents("li"),i=h.find(".tm-ul-2 .a-active"),j=h.attr("id");i.length||(i=h.find(".tm-a-2:first").addClass("a-active"),i.length?(f=i,j=i.parents("li").attr("id"),k=$("#"+j+"-content").removeClass("invisible")):j=h.attr("id"));var k=$("#"+j+"-content").removeClass("invisible").siblings(":not(.sticky)").addClass("invisible").end();b.push_to_listeners({id:j,target:f,content:k,menu:h.parents("ul.tm-ul"),event:a})}return!1})},push_to_listeners:function(b){for(var c=0;c<a.length;c++)a[c](b)},listen_click:function(b){return"function"!=typeof b?!1:void a.push(b)},find_selected_tab:function(a){var b=$("#"+a),c=b.find(".a-active").parents(".tm-li");return c.length||(c=b.find(".active")),c},is_tab_selected:function(a){return a.hasClass("active")},hide_tab:function(a){a.addClass("invisible").find(".menu-wrap-a .tm-a").unwrap().unwrap(),$("#"+a.attr("id")+"-content").addClass("invisible")},show_tab:function(a){a.removeClass("invisible")},trigger:function(a){var b=a.tab_id,c=a.content_id;if(!b&&"undefined"!=typeof c){var d=c.match(/^(.+)-content$/);d&&d[1]&&(b=d[1])}if(!b)return!1;var e=$("#"+b);if(!e.size()||e.hasClass("invisible"))return!1;var f=e.find(".tm-a");return f.size()?f.trigger("click"):e.find(".tm-a-2").trigger("click")}};return b}();!function(){"use strict";var a=window.onerror;window.jsErrors=[],window.onerror=function(b,c,d){window.jsErrors.push(b),a&&a(b,c,d)}}();var text,gtm_data_layer_info=function(){var a=[];return $(".gtm_data_layer").each(function(){var b={},c="";$(this).children().each(function(){var a=$(this).attr("id"),d=$(this).html();"json"==$(this).attr("data-type")&&(d=JSON.parse($(this).html())),"event"==a?c=d:b[a]=d}),b.url=document.URL;var d={};d.params=b,d.event=c,a.push(d)}),a},User=function(){this.email=$.cookie("email");var a=$.cookie("loginid_list");if(null===this.email||"undefined"==typeof this.email)this.is_logged_in=!1;else if(this.is_logged_in=!0,null!==a&&"undefined"!=typeof a){for(var b=[],c=a.split("+").sort(),d=0;d<c.length;d++){var e=!1,f=!1,g=c[d].split(":");"R"==g[1]&&(e=!0),"D"==g[2]&&(f=!0);var h={id:g[0],real:e,disabled:f};/MLT/.test(g[0])&&(h.non_financial=!0),/MF/.test(g[0])&&(h.financial=!0),b.push(h)}this.loginid_array=b}},Client=function(){this.loginid=$.cookie("loginid"),this.residence=$.cookie("residence"),this.is_logged_in=!1,this.is_real=!1,null===this.loginid||"undefined"==typeof this.loginid?this.type="logged_out":/VRT/.test(this.loginid)?(this.type="virtual",this.is_logged_in=!0):(this.type="real",this.is_logged_in=!0,this.is_real=!0);var a=gtm_data_layer_info();if(a.length>0)for(var b=0;b<a.length;b++)"log_in"==a[b].event&&SessionStore.set("client_info",this.loginid+":"+a[b].params.bom_firstname+":"+a[b].params.bom_lastname+":"+a[b].params.bom_email+":"+a[b].params.bom_phone);var c=SessionStore.get("client_info");if(c){var d=c.split(":");this.is_logged_in&&d[0]==this.loginid?(this.first_name=d[1],this.last_name=d[2],this.name=this.first_name+" "+this.last_name,this.email=d[3],this.phone=d[4]):SessionStore.remove("client_info")}},URL=function(a){this.is_valid=!0,this.history_supported=window.history&&window.history.pushState,this.location="undefined"!=typeof a?$("<a>",{href:decodeURIComponent(a)})[0]:window.location};URL.prototype={url_for:function(a,b,c){var d="/";/.cgi/.test(a)&&(d="cached"==c?"/c/":"/d/");var e="https://"+this.location.host+d+a;return b?(e+="?"+b,e+="&l="+page.language()):e+="?l="+page.language(),e},reset:function(){this.location=window.location,this._param_hash=void 0,this.is_valid=!0,$(this).trigger("change",[this])},invalidate:function(){this.is_valid=!1},update:function(a){var b={container:"content",url:a,useClass:"pjaxload"};this.history_supported&&(history.pushState(b,"",a),this.reset()),this.is_valid=!0},param:function(a){var b=this.params_hash();return b[a]},param_if_valid:function(a){return this.is_valid?this.param(a):void 0},path_matches:function(a){var b=this.location.pathname.replace(/\/[d|c]\//g,""),c=a.location.pathname.replace(/\/[d|c]\//g,"");return b==c||"/"+b==c},params_hash_to_string:function(a){var b=[];for(var c in a)a.hasOwnProperty(c)&&b.push(c+"="+a[c]);return b.join("&")},is_in:function(a){if(this.path_matches(a)){for(var b=this.params(),c=b.length,d=0;c--;)a.param(b[c][0])==b[c][1]&&d++;if(d==b.length)return!0}return!1},params_hash:function(){if(!this._param_hash){this._param_hash={};for(var a=this.params(),b=a.length;b--;)this._param_hash[a[b][0]]=a[b][1]}return this._param_hash},params:function(){for(var a=[],b=this.location.search.substr(1).split("&"),c=b.length;c--;){var d=b[c].split("=");a.push(d)}return a}};var Menu=function(a){this.page_url=a;var b=this;$(this.page_url).on("change",function(){b.activate()})};Menu.prototype={on_unload:function(){this.reset()},activate:function(){$("#menu-top li").removeClass("active"),this.hide_main_menu();var a=this.active_menu_top(),b=$("#menu-top li:eq(3)");if(a)a.addClass("active"),b.is(a)&&this.show_main_menu();else{var c=/^\/$|\/login|\/home|\/smart-indices|\/ad|\/open-source-projects|\/white-labels|\/bulk-trader-facility|\/partners|\/payment-agent$/.test(window.location.pathname);c||(b.addClass("active"),this.show_main_menu())}},show_main_menu:function(){$("#main-menu").removeClass("hidden"),this.activate_main_menu()},hide_main_menu:function(){$("#main-menu").addClass("hidden")},activate_main_menu:function(){$("#main-menu li.item").removeClass("active"),$("#main-menu li.item").removeClass("hover"),$("#main-menu li.sub_item a").removeClass("a-active");var a=this.active_main_menu();a.subitem&&a.subitem.addClass("a-active"),a.item&&(a.item.addClass("active"),a.item.addClass("hover")),this.on_mouse_hover(a.item);var b=$.cookie("allowed_markets");if(b){var c=b.split(","),d=$("li#topMenuStartBetting ul.sub_items");d.find("li").each(function(){var a=$(this).attr("id").split("_")[1];if(c.indexOf(a)<0){var b=$(this).find("a");c.indexOf(b.attr("id"))<0&&(b.addClass("disabled-link"),b.removeAttr("href"))}})}},reset:function(){$("#main-menu .item").unbind(),$("#main-menu").unbind()},on_mouse_hover:function(a){$("#main-menu .item").on("mouseenter",function(){$("#main-menu li.item").removeClass("hover"),$(this).addClass("hover")}),$("#main-menu").on("mouseleave",function(){$("#main-menu li.item").removeClass("hover"),a&&a.addClass("hover")})},active_menu_top:function(){var a,b=window.location.pathname;return $("#menu-top li a").each(function(){b.indexOf(this.pathname)>=0&&(a=$(this).closest("li"))}),a},active_main_menu:function(){var a=window.location.pathname;a=a.replace(/\/$/,""),a=decodeURIComponent(a);var b,c,d=this;return $("#main-menu .items a").each(function(){var a=new URL($(this).attr("href"));a.is_in(d.page_url)&&(b=$(this).closest(".item"))}),$("#main-menu .sub_items a").each(function(){var a=$(this).attr("href");if(a){var e=new URL(a);e.is_in(d.page_url)&&(b=$(this).closest(".item"),c=$(this))}}),{item:b,subitem:c}},register_dynamic_links:function(){var a=page.url.param("market")||LocalStore.get("bet_page.market")||"forex",b=$.cookie("allowed_markets");if(b){var c=b.split(",");c.indexOf(a)<0&&(a=c[0],LocalStore.set("bet_page.market",a))}var d=$("#topMenuStartBetting a:first"),e=d.attr("href");a&&(/market=/.test(e)?e=e.replace(/market=\w+/,"market="+a):e+="&market="+a,d.attr("href",e),$("#menu-top li:eq(3) a").attr("href",e),$("#mobile-menu #topMenuStartBetting a.trading_link").attr("href",e)),d.on("click",function(a){a.preventDefault(),load_with_pjax(e)}).addClass("unbind_later"),$("#menu-top li:eq(3) a").on("click",function(a){a.preventDefault(),load_with_pjax(e)}).addClass("unbind_later")}};var Header=function(a){this.user=a.user,this.client=a.client,this.settings=a.settings,this.menu=new Menu(a.url),this.clock_started=!1};Header.prototype={on_load:function(){this.show_or_hide_login_form(),this.register_dynamic_links(),this.clock_started||this.start_clock(),this.simulate_input_placeholder_for_ie()},on_unload:function(){this.menu.reset()},show_or_hide_login_form:function(){if(this.user.is_logged_in&&this.client.is_logged_in){for(var a="",b=this.user.loginid_array,c=0;c<b.length;c++)if(!b[c].disabled){var d=b[c].id,e=b[c].real,f="";d==this.client.loginid&&(f=' selected="selected" ');var g;g=e?b[c].financial?text.localize("Investment Account")+" ("+d+")":b[c].non_financial?text.localize("Gaming Account")+" ("+d+")":text.localize("Real Account")+" ("+d+")":text.localize("Virtual Account")+" ("+d+")",a+='<option value="'+d+'" '+f+">"+g+"</option>"}$("#client_loginid").html(a)}},simulate_input_placeholder_for_ie:function(){var a=document.createElement("input");"placeholder"in a||$("input[placeholder]").each(function(){var a=$(this);$(a).val(a.attr("placeholder")),$(a).focus(function(){a.val()==a.attr("placeholder")&&a.val("")}),$(a).blur(function(){(""===a.val()||a.val()==a.attr("placeholder"))&&a.val(a.attr("placeholder"))})})},register_dynamic_links:function(){var a=page.url.url_for("");this.client.is_logged_in&&(a=page.url.url_for("user/my_account")),$("#logo").attr("href",a).on("click",function(b){b.preventDefault(),load_with_pjax(a)}).addClass("unbind_later"),this.menu.register_dynamic_links()},start_clock:function(){var a=$("#gmt-clock");if(0!==a.length){var b,c=this,d=function(){var d=(new Date).getTime();$.ajax({crossDomain:!0,url:page.url.url_for("timestamp"),async:!0,dataType:"json"}).done(function(e){var f=e.timestamp;c.time_now=1e3*f+((new Date).getTime()-d)/2;var g=function(a){c.time_now+=a},h=function(){a.html(moment(c.time_now).utc().format("YYYY-MM-DD HH:mm")+" GMT")};h(),clearInterval(b),b=setInterval(function(){g(1e3),h()},1e3)})};d(),setInterval(function(){d()},9e5),this.clock_started=!0}}};var ToolTip=function(){this.tooltip=$("#tooltip"),0===this.tooltip.length&&(this.tooltip=$('<div id="tooltip"></div>'),this.tooltip.css("display","none").appendTo("body")),this.showing={};var a=this;$(window).resize(function(){a.resize_tooltip()})};ToolTip.prototype={attach:function(){var a=this;this.detach();var b=$("[rel~=tooltip]"),c=!1;b.on("mouseenter",function(){return c=$(this).attr("title"),c&&""!==c?(a.showing.target=$(this),a.showing.tip=c,a.showing.target.removeAttr("title"),a.tooltip.html(c),a.resize_tooltip(),a.reposition_tooltip_for(a.showing.target),void a.show_tooltip($(this))):!1}),b.on("mouseleave",function(){a.showing.target&&a.showing.target.attr("title",a.showing.tip),a.hide_tooltip()}),b.on("click",function(){a.showing.target&&a.showing.target.attr("title",a.showing.tip),a.hide_tooltip()})},detach:function(){$("[rel~=tooltip]").off("mouseenter"),$("[rel~=tooltip]").off("mouseleave"),this.tooltip.off("click")},show_tooltip:function(a){this.tooltip.css({display:""}),this.tooltip.zIndex(a.zIndex()+100)},hide_tooltip:function(){this.tooltip.html(""),this.tooltip.css({top:0,left:0,display:"none"}),this.tooltip.addClass("invisible")},resize_tooltip:function(){$(window).width()<1.5*this.tooltip.outerWidth()?this.tooltip.css("max-width",$(window).width()/2):this.tooltip.css("max-width",340)},reposition_tooltip_for:function(a){this.tooltip.removeClass("invisible");var b=a.offset().left+a.outerWidth()/2-this.tooltip.outerWidth()/2,c=a.offset().top-(this.tooltip.outerHeight()+10);this.tooltip.removeClass("left"),this.tooltip.removeClass("right"),this.tooltip.removeClass("top"),0>b&&(b=a.offset().left+a.outerWidth()/2-20,this.tooltip.addClass("left")),b+this.tooltip.outerWidth()>$(window).width()&&(b=a.offset().left-this.tooltip.outerWidth()+a.outerWidth()/2+20,this.tooltip.addClass("right")),0>c&&(c=a.offset().top+a.outerHeight()+20,this.tooltip.addClass("top")),this.tooltip.css({left:b,top:c})}};var Contents=function(a,b){this.client=a,this.user=b,this.tooltip=new ToolTip};Contents.prototype={on_load:function(){this.activate_by_client_type(),this.topbar_message_visibility(),this.update_body_id(),this.update_content_class(),this.tooltip.attach(),this.init_draggable()},on_unload:function(){this.tooltip.detach(),$(".unbind_later").length>0&&$(".unbind_later").off()},activate_by_client_type:function(){$(".by_client_type").addClass("invisible"),this.client.is_logged_in?this.client.is_real?($(".by_client_type.client_real").removeClass("invisible"),$(".by_client_type.client_real").show(),$("#topbar").addClass("dark-blue"),$("#topbar").removeClass("orange"),/^CR/.test(this.client.loginid)||($("#payment-agent-section").addClass("invisible"),$("#payment-agent-section").hide()),/^MF|MLT/.test(this.client.loginid)||($("#account-transfer-section").addClass("invisible"),$("#account-transfer-section").hide())):($(".by_client_type.client_virtual").removeClass("invisible"),$(".by_client_type.client_virtual").show(),$("#topbar").addClass("orange"),$("#topbar").removeClass("dark-blue"),$("#account-transfer-section").addClass("invisible"),$("#account-transfer-section").hide()):($(".by_client_type.client_logged_out").removeClass("invisible"),$(".by_client_type.client_logged_out").show(),$("#topbar").removeClass("orange"),$("#topbar").addClass("dark-blue"),$("#account-transfer-section").addClass("invisible"),$("#account-transfer-section").hide())},update_body_id:function(){$("body").attr("id",""),$("body").attr("id",$("#body_id").html())},update_content_class:function(){$("#content").removeClass(),$("#content").addClass($("#content_class").html())},init_draggable:function(){$(".draggable").draggable()},topbar_message_visibility:function(){if(this.client.is_logged_in){var a=this.user.loginid_array,b=page.settings.get("countries_list")[this.client.residence];if(this.client.is_real){var c=!1;if(b&&"maltainvest"==b.financial_company||"gb"==this.client.residence&&/^MLT/.test(this.client.loginid)){c=!0;for(var d=0;d<a.length;d++)if(a[d].financial){c=!1;break}}c?($("#financial-upgrade-link").removeClass("invisible"),$("#investment_message").length>0&&$("#investment_message").removeClass("invisible")):($("#financial-upgrade-link").addClass("invisible"),$("#investment_message").length>0&&$("#investment_message").addClass("invisible"))}else{for(var e=!0,f=0;f<a.length;f++)if(a[f].real){$("#virtual-upgrade-link").addClass("invisible"),$("#vr-financial-upgrade-link").addClass("invisible"),e=!1;break}e&&(b&&"none"==b.gaming_company&&"maltainvest"==b.financial_company?($("#virtual-upgrade-link").addClass("invisible"),$("#vr-financial-upgrade-link").removeClass("invisible")):($("#virtual-upgrade-link").removeClass("invisible"),$("#vr-financial-upgrade-link").addClass("invisible")))}}}};var Page=function(a){a="undefined"!=typeof a?a:{},this.user=new User,this.client=new Client,this.url=new URL,this.settings=new InScriptStore(a.settings),this.header=new Header({user:this.user,client:this.client,settings:this.settings,url:this.url}),this.contents=new Contents(this.client,this.user)};Page.prototype={language:function(){return $("#language_select").length>0?$("#language_select").attr("class").toUpperCase():page.url.param("l")?page.url.param("l"):"EN"},on_load:function(){this.url.reset(),this.localize_for(this.language()),this.header.on_load(),this.on_change_language(),this.on_change_loginid(),this.record_affiliate_exposure(),this.contents.on_load(),this.on_click_acc_transfer(),this.on_click_view_balances(),$("#current_width").val(get_container_width())},on_unload:function(){this.header.on_unload(),this.contents.on_unload()},on_change_language:function(){var a=this;$("#language_select").on("change","select",function(){var b=$(this).find("option:selected").attr("class");document.location=a.url_for_language(b)})},on_change_loginid:function(){$("#client_loginid").on("change",function(){LocalStore.set("active_loginid",$(this).val()),$("#loginid-switch-form").submit()})},on_click_acc_transfer:function(){$("#acc_transfer_submit").on("click",function(){var a=$("#acc_transfer_amount").val();return!/^[0-9]+\.?[0-9]{0,2}$/.test(a)||.1>a?($("#invalid_amount").removeClass("invisible"),$("#invalid_amount").show(),!1):void $("#acc_transfer_submit").submit()})},on_click_view_balances:function(){$("#view-balances").on("click",function(a){return a.preventDefault(),$(this).hasClass("disabled")?!1:($(this).addClass("disabled"),void $.ajax({url:page.url.url_for("user/balance"),dataType:"text",success:function(a){var b=$("#client-balances");b&&b.remove(),b=$("<div id='client-balances' class='lightbox'></div>").appendTo("body"),middle=$("<div />").appendTo(b),$("<div>"+a+"</div>").appendTo(middle),$("#client-balances [bcont=1]").on("click",function(){$("#client-balances").remove()})}}).always(function(){$("#view-balances").removeClass("disabled")}))})},localize_for:function(a){text=texts[a],moment.locale(a.toLowerCase())},url_for_language:function(a){a=a.trim().toUpperCase(),SessionStore.set("selected.language",a);var b=document.location,c=b.search||"?",d=b.protocol+"//"+b.host+b.pathname;return c.indexOf("l=")>=0?d+=c.replace(/(\?|&)l=[A-Z_]{2,5}/,"$1l="+a):(a=c.length>1?"&l="+a:"l="+a,d+=c+a),d},record_affiliate_exposure:function(){var a=this.url.param("t"),b=/\w{32}/.test(a),c=/\w{1}/.test(this.url.param("s"));if(!b)return!1;var d=$.cookie("affiliate_tracking");if(d){var e=JSON.parse(d);if(c&&e&&e.t)return!1}var f={};b&&(f.t=a.toString()),c&&(f.s="1"),$.cookie("affiliate_tracking",JSON.stringify(f),{expires:365,path:"/",domain:"."+location.hostname.split(".").slice(-2).join(".")})}};var URLPjaxQueueElement=function(a,b){this.method=a,this.url=b?new RegExp(b):/.*/};URLPjaxQueueElement.prototype={fire:function(a){this.url.test(a)&&this.method()}};var IDPjaxQueueElement=function(a,b){this.method=a,this.sel="#"+b};IDPjaxQueueElement.prototype={fire:function(){$(this.sel).length>0&&this.method()}};var PjaxExecQueue=function(){this.url_exec_queue=[],this.id_exec_queue=[],this.fired=!1,this.content=$("#content")};PjaxExecQueue.prototype={queue:function(a){this.url_exec_queue.unshift(new URLPjaxQueueElement(a))},queue_for_url:function(a,b){this.url_exec_queue.unshift(new URLPjaxQueueElement(a,b))},queue_if_id_present:function(a,b){this.id_exec_queue.unshift(new IDPjaxQueueElement(a,b))},fire:function(){if(!this.fired){for(var a=window.location.pathname,b=this.url_exec_queue.length;b--;)this.url_exec_queue[b].fire(a);for(b=this.id_exec_queue.length;b--;)this.id_exec_queue[b].fire(a)}this.fired=!0},reset:function(){this.fired=!1},loading:function(){this.reset()},count:function(){return exec_queue.length},show:function(a){for(var b=0;b<exec_queue.length;b++)a?exec_queue[b].url.test(a)&&console.log(""+exec_queue[b].method):console.log(exec_queue[b].url+" : "+exec_queue[b].method)}};var pjax_config_page=function(a,b){var c=b();c.onLoad&&onLoad.queue_for_url(c.onLoad,a),c.onUnload&&onUnload.queue_for_url(c.onUnload,a)},pjax_config=function(){return{container:"content",beforeSend:function(){onLoad.loading(),onUnload.fire()},complete:function(){onLoad.fire(),onUnload.reset()},error:function(){var a=SessionStore.get("errors.500");a?$("#content").html(a):$.get("/errors/500.html").always(function(a){var b=document.createElement("div");b.innerHTML=a,tmpNodes=b.getElementsByTagName("div");for(var c=0,d=tmpNodes.length;d>c;c++)if("content"==tmpNodes[c].id){SessionStore.set("errors.500",tmpNodes[c].innerHTML),$("#content").html(tmpNodes[c].innerHTML);break}}),$("#server_clock").html("GMT Time: "+moment(page.header.time_now).utc().format("YYYY-MM-DD HH:mm"))},useClass:"pjaxload"}},init_pjax=function(){var a=document.URL;/backoffice/.test(a)||pjax.connect(pjax_config())},load_with_pjax=function(a){if(!page.url.is_in(new URL(a))){var b=pjax_config();b.url=a,b.update_url=a,b.history=!0,pjax.invoke(b)}},SpotLight=function(){var a={};return a.spot_light_box=function(){var a=$("#spot-light-box");return a.size()||(a=$('<div id="spot-light-box" class="invisible"></div>').appendTo("body")),a},a.cover_page=function(){var a=$("#transparent-cover");a.size()||(a=$('<div id="transparent-cover"></div>').appendTo("body")),a.removeClass("invisible")},a.uncover_page=function(){$("#transparent-cover").addClass("invisible")},a.show=function(){a.spot_light_box().removeClass("invisible"),a.cover_page(),a.activate_buttons()},a.hide=function(){a.spot_light_box().addClass("invisible"),a.uncover_page()},a.set_content=function(b){a.spot_light_box().get(0).innerHTML=b},a.attach_click_event=function(b,c){a.spot_light_box().delegate(b,"click",c)},a.activate_buttons=function(){$(".close_button").on("click",function(){$(this).parents(".rbox-shadow-popup").toggleClass("invisible"),$("#transparent-cover").toggleClass("invisible")}),$(".no_button").on("click",function(){$(this).parents(".rbox-shadow-popup").toggleClass("invisible"),$("#transparent-cover").toggleClass("invisible")})},a}(),isStorageSupported=function(a){if("undefined"==typeof a)return!1;var b="test";try{return a.setItem(b,"1"),a.removeItem(b),!0}catch(c){return!1}},Store=function(a){this.storage=a};Store.prototype={get:function(a){return this.storage.getItem(a)?this.storage.getItem(a):void 0},set:function(a,b){"undefined"!=typeof b&&this.storage.setItem(a,b)},remove:function(a){this.storage.removeItem(a)},clear:function(){this.storage.clear()}};var InScriptStore=function(a){this.store="undefined"!=typeof a?a:{}};InScriptStore.prototype={get:function(a){return this.store[a]},set:function(a,b){this.store[a]=b},remove:function(a){this.store[a]=void 0},clear:function(){this.store={}}};var CookieStorage=function(a){this.initialized=!1,this.cookie_name=a,this.domain="."+document.domain.split(".").slice(-2).join("."),this.expires=new Date("Thu, 1 Jan 2037 12:00:00 GMT"),this.value={}};CookieStorage.prototype={read:function(){var a=$.cookie(this.cookie_name);try{this.value=a?JSON.parse(a):{}}catch(b){this.value={}}this.initialized=!0},get:function(a){return this.initialized||this.read(),this.value[a]},set:function(a,b){this.initialized||this.read(),this.value[a]=b,$.cookie(this.cookie_name,JSON.stringify(this.value),{expires:this.expires,path:"/",domain:this.domain})}};var Localizable=function(a){this.texts="undefined"!=typeof a?a:{}};Localizable.prototype={localize:function(a){var b=a.replace(/[\s|.]/g,"_");return this.texts[b]||a}},$(document).ajaxSuccess(function(){var a=new Contents(page.client,page.user);a.on_load()});var onLoad=new PjaxExecQueue,onUnload=new PjaxExecQueue,SessionStore,LocalStore;isStorageSupported(window.localStorage)&&(LocalStore=new Store(window.localStorage)),isStorageSupported(window.sessionStorage)&&(LocalStore||(LocalStore=new Store(window.sessionStorage)),SessionStore=new Store(window.sessionStorage)),SessionStore&&LocalStore||(LocalStore||(LocalStore=new InScriptStore),SessionStore||(SessionStore=new InScriptStore));var Settings=new CookieStorage("settings"),page=new Page(window.page_params);onLoad.queue(function(){page.on_load()}),onUnload.queue(function(){page.on_unload()});var bo_url,make_mobile_menu=function(){$("#mobile-menu-container").is(":visible")&&$("#mobile-menu").mmenu({position:"right",zposition:"front",slidingSubmenus:!1,searchfield:!0,onClick:{close:!0}},{selectedClass:"active"})};onLoad.queue(function(){$(".tm-ul > li").hover(function(){$(this).addClass("hover")},function(){$(this).removeClass("hover")}),MenuContent.init($(".content-tab-container").find(".tm-ul")),add_click_effect_to_button(),make_mobile_menu();var a=new formEffects;a.set($("form.formObject"));var b=window.location.href.split("#");if(2==b.length)for(var c=document.getElementsByTagName("a"),d=0;d<c.length;d++)if(c[d].href.substr(c[d].href.length-b[1].length-1)=="#"+b[1]){c[d].click();break}}),onLoad.queue(function(){attach_date_picker(".has-date-picker"),attach_time_picker(".has-time-picker"),attach_inpage_popup(".has-inpage-popup"),attach_tabs(".has-tabs")}),$(window).on("storage",function(a){"active_loginid"===a.originalEvent.key&&window.setTimeout(function(){location.href=page.url.url_for("user/my_account?loginid="+LocalStore.get("active_loginid"))},2e3)}),DatePicker=function(a,b){this.component_id=a,this.select_type="undefined"==typeof b?"date":b,this.localizations={},this.localizations.monthNames=[text.localize("January"),text.localize("February"),text.localize("March"),text.localize("April"),text.localize("May"),text.localize("June"),text.localize("July"),text.localize("August"),text.localize("September"),text.localize("October"),text.localize("November"),text.localize("December")],this.localizations.monthNamesShort=[text.localize("Jan"),text.localize("Feb"),text.localize("Mar"),text.localize("Apr"),text.localize("May"),text.localize("Jun"),text.localize("Jul"),text.localize("Aug"),text.localize("Sep"),text.localize("Oct"),text.localize("Nov"),text.localize("Dec")],this.localizations.dayNames=[text.localize("Sunday"),text.localize("Monday"),text.localize("Tuesday"),text.localize("Wednesday"),text.localize("Thursday"),text.localize("Friday"),text.localize("Saturday")],this.localizations.nextText=text.localize("Next"),this.localizations.prevText=text.localize("Previous")},DatePicker.prototype={show:function(a){this.create(this.config(a))},hide:function(){$("#"+this.component_id+".hasDatepicker").length>0&&$("#"+this.component_id).datepicker("destroy"),$("#"+this.component_id).off("keydown")},create:function(a){var b=this;$("#"+this.component_id).keydown(function(a){return 13==a.which?(a.preventDefault(),a.stopPropagation(),"date"==b.select_type&&$(this).datepicker("setDate",$(this).val()),$(this).datepicker("hide"),$(this).blur(),$(b).trigger("enter_pressed"),!1):void 0}).datepicker(a),$("button.ui-datepicker-trigger").remove()},config:function(a){a="undefined"==typeof a?365:a;var b=new Date,c=new Date;c.setDate(b.getDate()+a);var d={dateFormat:"yy-mm-dd",monthNames:this.localizations.monthNames,monthNamesShort:this.localizations.monthNamesShort,dayNames:this.localizations.dayNames,nextText:this.localizations.nextText,prevText:this.localizations.prevText,minDate:b,maxDate:c},e=this;
return d.onSelect=function(a){if("diff"==e.select_type){var b=moment.utc(),c=moment.utc(a+" 23:59:59"),d=c.diff(b,"days");$(this).val(d),$(e).trigger("change",[d])}else"date"==e.select_type&&($(this).val(a),$(e).trigger("change",[a]))},d}},DatePicker.SelectedDates=function(a,b){this.component_id=a,this._super=new DatePicker(a,b),this.dates=[];var c=this;$(this._super).on("enter_pressed",function(){$(c).trigger("enter_pressed")}),$(this._super).on("change",function(a,b){$(c).trigger("change",[b])})},DatePicker.SelectedDates.prototype={show:function(a){this.dates=a,this._super.create(this.config())},hide:function(){$("#"+this.component_id+".hasDatepicker").length>0&&$("#"+this.component_id).datepicker("destroy")},config:function(){var a=this._super.config(),b=this;return a.beforeShowDay=function(a){var c=moment.utc([a.getFullYear(),a.getMonth(),a.getDate()]).format("YYYY-MM-DD");return b.dates.indexOf(c)>=0?[1]:[0]},a.beforeShow=function(){return{defaultDate:$("#"+b.component_id).val()}},a}},TimePicker=function(a){this.component_id=a},TimePicker.prototype={show:function(a,b){var c=this;$("#"+this.component_id).keydown(function(a){return 13==a.which?(a.preventDefault(),a.stopPropagation(),$(this).timepicker("setTime",$(this).val()),$(this).timepicker("hide"),$(this).blur(),$(c).trigger("enter_pressed"),!1):void 0}).timepicker(this.config(a,b))},hide:function(){$("#"+this.component_id+".hasTimepicker").length>0&&$("#"+this.component_id).timepicker("destroy"),$("#"+this.component_id).off("keydown")},time_now:function(){return moment.utc(page.header.time_now)},config:function(a,b){var c=this;a=moment.utc(a),b=moment.utc(b);var d=this.time_now();a.isBefore(d)&&(a=this.time_now());var e={minTime:{hour:parseInt(a.hour()),minute:parseInt(a.minute())},maxTime:{hour:parseInt(b.hour()),minute:parseInt(b.minute())}};return e.onSelect=function(a){if(a.match(/^(:?[0-3]\d):(:?[0-5]\d):(:?[0-5]\d)$/))$(c).trigger("change",[a]);else{var b=a.match(/([a-z0-9]*):([a-z0-9]*):?([a-z0-9]*)?/),d=c.time_now().format("hh"),e=c.time_now().format("mm"),f=c.time_now().format("ss");"undefined"!=typeof b[1]&&isFinite(b[1])&&(d=parseInt(b[1]),10>d&&(d="0"+d)),"undefined"!=typeof b[2]&&isFinite(b[2])&&(e=parseInt(b[2]),parseInt(e)<10&&(e="0"+e)),"undefined"!=typeof b[3]&&isFinite(b[3])&&(f=parseInt(b[3]),10>f&&(f="0"+e));var g=moment(c.time_now().format("YYYY-MM-DD")+" "+d+":"+e+":"+f);$(this).val(g.format("HH:mm")),$(c).trigger("change",[g.format("HH:mm")])}},e}},window._trackJs={onError:function(a){function b(a,b){for(var c=0;c<b.length;c++)if(a.indexOf(b[c])>-1)return!0;return!1}var c=["[object Event]","Script error.","Error loading script","DealPly","Unexpected token <"];return b(a.message,c)?!1:(a.network=a.network.filter(function(b){return 403===b.statusCode&&a.message.indexOf("intercom")>-1?!1:!0}),!0)}},"undefined"!=typeof trackJs&&trackJs.configure(window._trackJs),onLoad.queue(push_data_layer);var live_chart,chart_closed,ticks_array=[],LiveChart=function(a){a&&(this.config=a,this.shift=!1,a.trade_visualization||(this.on_duration_change(),this.highlight_duration()))};LiveChart.prototype={show_chart:function(){$(".notice").hide(),this.chart=new Highcharts.StockChart(this.chart_params()),this.chart.showLoading()},close_chart:function(){$(".live_charts_stream_button").off("click"),this.ev&&this.ev.close(),!chart_closed&&live_chart&&(this.chart&&this.chart.destroy(),chart_closed=!0,live_chart=null)},add_indicator:function(a){this.config.add_indicator(a),a.paint(this)},remove_indicator:function(a){var b=this.config.remove_indicator(a);b&&b.remove(this)},exporting_menu:function(){for(var a=[],b=Highcharts.getOptions(),c=b.exporting.buttons.contextButton.menuItems,d=0;d<c.length;d++)a.push(c[d]);return a},connect_to_stream:function(){var a=this,b=window.location.protocol+"//"+this.config.streaming_server,c=this.config.to?"/"+this.config.to:"";b+="/stream/ticks/"+this.config.symbol.symbol+"/"+this.config.from+c+"?adjust_start_time=1&with_trades="+this.config.with_trades,"tick"!=this.config.resolution&&(b+="&ohlc="+this.config.resolution),this.ev=new EventSource(b,{withCredentials:!0}),this.ev.onmessage=function(b){a.process_message(b)},this.ev.onerror=function(){a.ev.close()}},process_contract:function(a){this.tradeSeries||(this.tradeSeries=this.chart.addSeries({name:"Contracts",type:"flags",data:[],onSeries:"primary_series",shape:"circlepin",includeInCSVExport:!1},!1,!1));var b=1e3*parseInt(a.start_time),c="Contract ID: "+a.buy_id+"<br>"+a.long_code,d="white";a.is_sold&&(a.won?(c+="<br>Result: Won",d="green"):(c+="<br>Result: Lost",d="red"));var e={x:b,title:"C",fillColor:d,text:c};this.tradeSeries.addPoint(e,!1,!1,!1)},chart_params:function(){var a=this,b={chart:{height:this.config.renderHeight,renderTo:this.config.renderTo,events:{load:function(){a.connect_to_stream()}}},credits:{enabled:!1},exporting:{buttons:{contextButton:{menuItems:this.exporting_menu()}},enabled:!0},plotOptions:{series:{dataGrouping:{dateTimeLabelFormats:{millisecond:["%A, %b %e, %H:%M:%S.%L GMT","%A, %b %e, %H:%M:%S.%L","-%H:%M:%S.%L GMT"],second:["%A, %b %e, %H:%M:%S GMT","%A, %b %e, %H:%M:%S","-%H:%M:%S GMT"],minute:["%A, %b %e, %H:%M GMT","%A, %b %e, %H:%M","-%H:%M GMT"],hour:["%A, %b %e, %H:%M GMT","%A, %b %e, %H:%M","-%H:%M GMT"],day:["%A, %b %e, %Y","%A, %b %e","-%A, %b %e, %Y"],week:["Week from %A, %b %e, %Y","%A, %b %e","-%A, %b %e, %Y"],month:["%B %Y","%B","-%B %Y"],year:["%Y","%Y","-%Y"]},turboThreshold:3e3},marker:{enabled:this.config.with_markers,radius:2}},candlestick:{turboThreshold:4e3}},xAxis:{type:"datetime",min:1e3*this.config.from},yAxis:{opposite:!1,labels:{align:"left",x:0,formatter:function(){return this.value}},title:{text:null}},rangeSelector:{enabled:!1},title:{text:this.config.symbol.translated_display_name()}};return this.config.with_marker&&(b.plotOptions.line={marker:{enabled:!0}}),this.configure_series(b),b},process_message:function(a){var b=JSON.parse(a.data);if(b.error)return void this.ev.close();if(b.notice)return void $("#"+b.notice+"_notice").show();b[0]instanceof Array||(b=[b]);for(var c=b.length,d=0;c>d;d++)this.process_data(b[d]);if(c>0&&this.spot){if(this.config.repaint_indicators(this),this.chart.redraw(),!this.navigator_initialized){this.navigator_initialized=!0;var e=this.chart.series[0].xData,f=e.length;f&&this.chart.xAxis[0].setExtremes(e[0],e[f-1],!0,!1)}this.chart.hideLoading(),this.shift=1==this.config.shift?!0:!1}},highlight_duration:function(){$("#live_chart_duration").find(".live_charts_stream_button").each(function(){$(this).find("span").removeClass("current")}),$("#live_chart_duration li[data-live="+this.config.live+"] span").addClass("current")},on_duration_change:function(){var a=this;$(".live_charts_stream_button").on("click",function(){a.config.update({live:$(this).data("live"),update_url:1}),a.highlight_duration(),updateLiveChart(a.config);var b=jQuery.Event("duration_change",{target:this,config:a.config});$("#live_chart_duration").trigger(b)})}},LiveChartTick.prototype=new LiveChart,LiveChartTick.prototype.constructor=LiveChartTick,LiveChartTick.prototype.configure_series=function(a){a.chart.type="line",a.xAxis.labels={format:"{value:%H:%M:%S}"},a.series=[{name:this.config.symbol.translated_display_name(),data:[],dataGrouping:{enabled:!1},id:"primary_series",tooltip:{xDateFormat:"%A, %b %e, %H:%M:%S GMT"},type:"line"}]},LiveChartTick.prototype.process_data=function(a){if("tick"==a[0]){var b={epoch:parseInt(a[1]),quote:parseFloat(a[2])};if(!this.chart)return;if(!this.chart.series)return;this.chart.series[0].addPoint([1e3*b.epoch,b.quote],!1,this.shift,!1),this.spot=b.quote,b.epoch>this.config.contract_start_time&&ticks_array.length<this.config.how_many_ticks&&ticks_array.push(b)}else"contract"==a[0]&&this.process_contract(a[1])},LiveChartOHLC.prototype=new LiveChart,LiveChartOHLC.prototype.constructor=LiveChartOHLC,LiveChartOHLC.prototype.configure_series=function(a){a.chart.type="candlestick",a.series=[{name:this.config.symbol.translated_display_name(),data:[],color:"red",upColor:"green",id:"primary_series",type:"candlestick"}]},LiveChartOHLC.prototype.process_data=function(a){var b=a.shift();"ohlc"==b?this.process_ohlc(a):"tick"==b?this.accept_ticks&&this.process_tick(a):"corp_action"==b?this.process_corp_action(a):"contract"==b&&this.process_contract(a[0])},LiveChartOHLC.prototype.process_corp_action=function(a){this.flagSeries||(this.flagSeries=this.chart.addSeries({name:"Events",type:"flags",data:[],shape:"flag"},!1,!1));var b=1e3*parseInt(a[0].epoch),c=a[0].description,d={x:b,title:"CA",text:c};this.flagSeries.addPoint(d,!1,!1,!1)},LiveChartOHLC.prototype.process_ohlc=function(a){var b=parseInt(a[0]);if(this.chart&&this.chart.series){var c={x:1e3*b,open:parseFloat(a[1]),y:parseFloat(a[1]),high:parseFloat(a[2]),low:parseFloat(a[3]),close:parseFloat(a[4])};this.chart.series[0].addPoint(c,!1,!1,!1),this.spot=c.close,this.accept_ticks=!0}},LiveChartOHLC.prototype.process_tick=function(a){var b={epoch:1e3*parseInt(a[0]),quote:parseFloat(a[1]),squote:a[1]};if(this.spot=b.quote,this.chart&&this.chart.series){var c=this.chart.series[0].options.data;if(c.length>0&&c[c.length-1].x>b.epoch-this.candlestick.period){var d=c[c.length-1];b.quote!=d.close&&(d.close=b.quote,d.low>b.quote&&(d.low=b.quote),d.high<b.quote&&(d.high=b.quote),this.chart.series[0].isDirty=!0,this.chart.series[0].isDirtyData=!0)}else{var e={x:b.epoch,open:b.quote,y:b.quote,high:b.quote,low:b.quote,close:b.quote};this.chart.series[0].addPoint(e,!1,!1,!1)}}};var LiveChartConfig=function(a){a=a||{},this.renderTo=a.renderTo||"live_chart_div",this.renderHeight=a.renderHeight||450,this.shift="undefined"!=typeof a.shift?a.shift:1,this.with_trades="undefined"!=typeof a.with_trades?a.with_trades:1,this.streaming_server=page.settings.get("streaming_server"),this.with_marker="undefined"!=typeof a.with_marker?a.with_marker:0,this.force_tick="undefined"!=typeof a.force_tick?a.force_tick:0,this.indicators=[],this.resolutions={tick:{seconds:0,interval:3600},"1m":{seconds:60,interval:86400},"5m":{seconds:300,interval:604800},"30m":{seconds:1800,interval:2678400},"1h":{seconds:3600,interval:5356800},"8h":{seconds:28800,interval:15811200},"1d":{seconds:86400,interval:94867200}},this.resolution="tick",this.with_markers="undefined"!=typeof a.with_markers?a.with_markers:!1;var b,c,d=window.location.hash;if(b=d.match(/^#([A-Za-z0-9_]+):(10min|1h|1d|1w|1m|3m|1y)$/))c=markets.by_symbol(b[1]),c&&(this.symbol=c.underlying,this.market=c.market,this.live=b[2]);else if(b=d.match(/^#([A-Za-z0-9_]+):([0-9]+)-([0-9]+)$/))c=markets.by_symbol(b[1]),c&&(this.symbol=c.underlying,this.market=c.market,this.from=parseInt(b[2]),this.to=parseInt(b[3]),this.resolution=this.best_resolution(this.from,this.to));else{c=markets.by_symbol(a.symbol)||markets.by_symbol(LocalStore.get("live_chart.symbol"))||markets.by_symbol("frxAUDJPY"),this.symbol=c.underlying,this.market=c.market;var e=a.from||LocalStore.get("live_chart.from"),f=a.to||LocalStore.get("live_chart.to");e&&f&&"null"!=e&&"null"!=f?(this.from=e,this.to=f,this.resolution=this.best_resolution(this.from,this.to)):this.live=a.live||LocalStore.get("live_chart.live")||"10min"}this.live&&(this.from=this.calculate_from(this.live),this.resolution=this.best_resolution(this.from,(new Date).getTime()/1e3))};LiveChartConfig.prototype={add_indicator:function(a){this.indicators.push(a)},remove_indicator:function(a){for(var b,c=this.indicators.length;c--;)this.indicators[c].name==a&&(b=this.indicators[c],this.indicators.splice(c,1));return b},has_indicator:function(a){for(var b=this.indicators.length;b--;)if(this.indicators[b].name==a)return!0;return!1},repaint_indicators:function(a){for(var b=this.indicators.length;b--;)this.indicators[b].repaint(a)},calculate_from:function(a){var b=new Date,c=Math.floor(b.getTime()/1e3),d={min:60,h:3600,d:86400,w:604800,m:2678400,y:31622400},e=a.match(/^([0-9]+)([hdwmy]|min)$/);return e?c-parseInt(e[1])*d[e[2]]:void 0},update:function(a){if(a.interval){var b=parseInt(a.interval.from.getTime()/1e3),c=parseInt(a.interval.to.getTime()/1e3);this.resolution=this.best_resolution(b,c),delete a.interval,this.from=b,this.to=c,delete this.live}if(a.live&&(delete this.to,LocalStore.remove("live_chart.to"),LocalStore.remove("live_chart.from"),this.from=this.calculate_from(a.live),this.live=a.live,LocalStore.set("live_chart.live",a.live),this.resolution=this.best_resolution(this.from,(new Date).getTime()/1e3)),a.symbol){var d=markets.by_symbol(a.symbol);d&&(this.symbol=d.underlying,this.market=d.market,LocalStore.set("live_chart.symbol",d.symbol))}if(a.update_url){var e="#";e+=this.from&&this.to?this.symbol.symbol+":"+this.from+"-"+this.to:this.symbol.symbol+":"+this.live;var f=window.location.pathname+window.location.search+e;page.url.update(f)}a.shift&&(this.shift=a.shift),a.with_trades&&(this.with_trades=a.with_trades),a.with_markers&&(this.with_markers=a.with_markers),a.force_tick&&(this.force_tick=a.force_tick)},best_resolution:function(a,b){if(this.force_tick)return"tick";var c=parseInt(b-a);for(var d in this.resolutions)if(this.resolutions[d].interval>=c)return d;return"1d"},resolution_seconds:function(a){return a="undefined"!=typeof a?a:this.resolution,this.resolutions[a].seconds}};var configured_livechart=!1,configure_livechart=function(){configured_livechart||Highcharts.setOptions({lang:{loading:text.localize("loading..."),printChart:text.localize("Print chart"),downloadJPEG:text.localize("Save as JPEG"),downloadPNG:text.localize("Save as PNG"),downloadSVG:text.localize("Save as SVG"),downloadPDF:text.localize("Save as PDF"),downloadCSV:text.localize("Save as CSV"),rangeSelectorFrom:text.localize("From"),rangeSelectorTo:text.localize("To"),rangeSelectorZoom:text.localize("Zoom"),months:[text.localize("January"),text.localize("February"),text.localize("March"),text.localize("April"),text.localize("May"),text.localize("June"),text.localize("July"),text.localize("August"),text.localize("September"),text.localize("October"),text.localize("November"),text.localize("December")],shortMonths:[text.localize("Jan"),text.localize("Feb"),text.localize("Mar"),text.localize("Apr"),text.localize("May"),text.localize("Jun"),text.localize("Jul"),text.localize("Aug"),text.localize("Sep"),text.localize("Oct"),text.localize("Nov"),text.localize("Dec")],weekdays:[text.localize("Sunday"),text.localize("Monday"),text.localize("Tuesday"),text.localize("Wednesday"),text.localize("Thursday"),text.localize("Friday"),text.localize("Saturday")]},navigator:{series:{includeInCSVExport:!1}}}),configured_livechart=!0};DateTimePicker.prototype={getDateTime:function(){var a=$(this.date_inp).val().match(/^(\d\d\d\d)-(\d\d)-(\d\d)$/);if(!a)return null;var b=a[1],c=a[2],d=a[3],e=$(this.time_inp).val().match(/^([01][0-9]|2[0-3]):([0-5]\d)(:([0-5]\d))?$/),f=0,g=0,h=0;return e&&(f=e[1],g=e[2],h=e[3]?e[4]:0),new Date(Date.UTC(b,c-1,d,f,g,h))},setDateTime:function(a){var b=a.getUTCFullYear()+"-"+(a.getUTCMonth()+1)+"-"+a.getUTCDate();$(this.date_inp).datepicker("setDate",b);var c=a.getUTCHours()||0;10>c&&(c="0"+c);var d=a.getUTCMinutes()||0;10>d&&(d="0"+d);var e=a.getUTCSeconds()||0;10>e&&(e="0"+e),$(this.time_inp).val(c+":"+d+":"+e),this.onChange(this.getDateTime())},setMinDateTime:function(a){this.minDateTime=a,this.getDateTime<a&&this.setDateTime(a),$(this.date_inp).datepicker("option","minDate",a)},setMaxDateTime:function(a){this.maxDateTime=a,this.getDateTime>a&&this.setDateTime(a),$(this.date_inp).datepicker("option","maxDate",a)},clear:function(){$(this.date_inp).val(""),$(this.time_inp).val("")}};var LiveChartIndicator={};LiveChartIndicator.Barrier=function(a){this.name=a.name,this.value="object"!=typeof a.value?parseFloat(a.value):a.value,this.color=a.color||"blue",this.width=a.width||2,this.id="barrier_"+this.name,this.is_relative=/^[+-]/.test(a.value),this.painted=!1,this.label=a.label||"",this.axis=a.axis||"y",this.nomargin=a.nomargin||!1},LiveChartIndicator.Barrier.prototype={remove:function(a){if(a.chart)if("y"==this.axis){if(!a.chart.yAxis)return;a.chart.yAxis[0].removePlotLine(this.id)}else{if(!a.chart.xAxis)return;a.chart.xAxis[0].removePlotLine(this.id)}},repaint:function(a){return this.is_relative||!this.painted?(this.remove(a),this.paint(a),!0):!1},paint:function(a){var b=this.value;if(this.is_relative){if(!a.spot)return;b=a.spot+b}var c={value:b,color:this.color,width:this.width,id:this.id};if(this.label&&(c.label="x"==this.axis?this.nomargin?{text:text.localize(this.label),verticalAlign:"middle",textAlign:"center"}:{text:text.localize(this.label),verticalAlign:"middle",x:-10,textAlign:"center"}:{text:text.localize(this.label),align:"center"}),a.chart){if("y"==this.axis){if(!a.chart.yAxis)return;a.chart.yAxis[0].addPlotLine(c)}else{if(!a.chart.xAxis)return;a.chart.xAxis[0].addPlotLine(c)}this.painted=!0}}};var texts={};for(var key in texts_json)texts_json.hasOwnProperty(key)&&(texts[key]=new Localizable(texts_json[key]));var markets=new Markets(markets_list,markets_json);init_pjax(),$(function(){onLoad.fire()});var trade_event_bindings={},trading_times_init=function(){var a="#trading-tabs",b=$(a);b.tabs();var c=location.href;$("#tradingdate").datepicker({minDate:0,maxDate:"+1y",dateFormat:"yy-mm-dd",autoSize:!0,onSelect:function(a){b.tabs("destroy"),showLoadingImage(b),c=page.url.url_for("resources/trading_times","date="+a,"cached"),$.ajax({url:c,data:{ajax_only:1},success:function(a){b.replaceWith(a),b=$("#trading-tabs"),"JA"===page.language()?b.tabs("disable"):b.tabs(),page.url.update(c)},error:function(a,c){b.empty().append(c)}})}})},asset_index_init=function(){var a="#asset-tabs";$(a).tabs()},hide_payment_agents=function(){var a=page.language();"JA"==a&&$(".payment_agent_methods").addClass("invisible")};onLoad.queue_for_url(trading_times_init,"trading_times"),onLoad.queue_for_url(asset_index_init,"asset_index"),onLoad.queue_for_url(confirm_popup_action,"my_account|confirm_popup"),onLoad.queue_for_url(hide_payment_agents,"cashier"),onLoad.queue_for_url(function(){$("div.further-info").children("div").hide().end().children("a").click(function(){return $(this).siblings("div").toggle(),!1})},"/c/paymentagent_list");var trade_contract_back=function(){$("#find_another_contract").on("click",function(a){page.url.history_supported&&(a.preventDefault(),window.history.back())}).addClass("unbind_later")},toggleStreaming=function(){document.hidden||document.webkitHidden?(BetForm.spot.clear(),BetPrice.streaming.stop(),BetPrice.order_form.hide_buy_button()):BetPrice.streaming.start()};pjax_config_page("/trade.cgi",function(){return{onLoad:function(){trade_contract_back(),BetForm.init(),BetAnalysis.register_actions(),BetForm.restore(),"undefined"!=typeof document.webkitHidden?document.addEventListener&&document.addEventListener("webkitvisibilitychange",toggleStreaming,!1):"undefined"!=typeof document.hidden&&document.addEventListener&&document.addEventListener("visibilitychange",toggleStreaming)},onUnload:function(){BetForm.unregister_actions(),BetPrice.deregister(),BetPrice.clear_buy_results(),BetPrice.streaming.stop(),BetAnalysis.reset(),"undefined"!=typeof document.webkitHidden?document.removeEventListener("webkitvisibilitychange",toggleStreaming):"undefined"!=typeof document.hidden&&document.removeEventListener("visibilitychange",toggleStreaming)}}}),pjax_config_page("rise_fall_table",function(){var a;return{onLoad:function(){var b=new BetForm.TradingTime,c=new BetForm.Time.Duration(b);b.init(),b.underlying=function(){return"R_100"};var d;b.value=function(b){if(b&&(d=b),!d){{var c=page.url.param("duration_amount");page.url.param("duration_units")}if("undefined"==typeof a||"undefined"==typeof a){var e=this.min_unit();c=e.min,unit=e.units}d=c+unit}return d},c.init(),c.register(),c.update_ui(),$("#atleast").on("change",function(){c.update_units_select(),c.update_ui()}).addClass("unbind_later"),$("#rise_fall_calculate").on("click",function(a){a.preventDefault();$(this).hide(),$("#rise_fall_calculating").show();var b=$("form[name=rise_fall]").get(0),c=page.url.url_for("resources/rise_fall_table",getFormParams(b));$("#rise_fall_prices_div").html(""),$.ajax({url:c,data:{ajax_only:1,prices_only:1}}).done(function(a){$("#rise_fall_prices_div").html(a),page.url.update(c),$("#rise_fall_calculating").hide(),$("#rise_fall_calculate").show()})}).addClass("unbind_later")}}}),pjax_config_page("portfolio|trade.cgi|statement|f_manager_statement|f_manager_history|f_profit_table|profit_table",function(){return{onLoad:function(){BetSell.register()},onUnload:function(){BetSell.cleanup()}}}),pjax_config_page("chart_application",function(){return{onLoad:function(){load_chart_app()}}}),pjax_config_page("trading",function(){return{onLoad:function(){TradingEvents.init(),Content.populate(),TradeSocket.init(),Symbols.getSymbols(1),document.getElementById("websocket_form")&&addEventListenerForm()},onUnload:function(){TradeSocket.close()}}});var BetAnalysis=function(){var a=!1,b=!1;return{reset:function(){b=!1,this.tab_live_chart.reset()},register_actions:function(){var b=this;a||(a=!0,MenuContent.listen_click(function(a){if("betsBottomPage"==a.menu.attr("id")){b.save(a);var c=a.id,d=!1;"tab_explanation"==c?(b.tab_explanation.render(a),d=!0):"tab_ohlc"==c&&BetForm.attributes.show_ohlc()?(b.tab_ohlc.render(a),d=!0):"tab_intradayprices"==c?(b.tab_intradayprices.render(a),d=!0):"tab_last_digit"==c?(b.tab_last_digit.render(a),d=!0):"tab_graph"==c?(b.tab_live_chart.render(),d=!0):"tab_pricing_table"==c&&(b.tab_pricing_table.render(a),d=!0),d||b.tab_explanation.render(a)}}))},save:function(a){SessionStore.set("bet_page.selected_analysis_tab",a.id)},restore:function(){b||(this.show_tab(SessionStore.get("bet_page.selected_analysis_tab")),b=!0)},show_tab:function(a){a&&$("#".tab)||(a="tab_explanation"),this.is_showing_tab(a)||MenuContent.trigger({tab_id:a})},is_showing_tab:function(a){return MenuContent.is_tab_selected($("#"+a))},was_showing_tab:function(a){return SessionStore.get("bet_page.selected_analysis_tab")==a},bet_type_changed:function(){var a=SessionStore.get("bet_page.selected_analysis_tab");this.is_showing_tab("tab_explanation")&&MenuContent.trigger({tab_id:a})},underlying_changed:function(){var a=SessionStore.get("bet_page.selected_analysis_tab");(this.is_showing_tab("tab_graph")||this.is_showing_tab("tab_pricing_table"))&&MenuContent.trigger({tab_id:a})},duration_changed:function(){var a=SessionStore.get("bet_page.selected_analysis_tab");(this.is_showing_tab("tab_graph")||this.is_showing_tab("tab_pricing_table"))&&MenuContent.trigger({tab_id:a})},get_price_data:function(a,b,c){var d=this,e=changeUrlToSameDomain(a.action),f=$(a).serialize()+"&id="+Math.floor(83720*Math.random()),g=b.find("span.button");g.addClass("invisible"),g.after(getImageLink()),$.ajax(ajax_loggedin({url:e,async:!0,data:f,success:function(a){b.html(a),d.set_submit_event(c)}}))},set_submit_event:function(a){var b=this,c=$("#"+a+"-content"),d=c.find("button[type=submit]");$(d.closest("form")[0]).on("submit",function(a){return a.preventDefault(),!1}),d.on("click",function(){b.get_price_data($(this).closest("form")[0],c,a)})},tab_explanation:function(){return{render:function(a){var b=this;showLoadingImage(a.content),$.get(b.url(),function(b){a.content.html(b)})},url:function(){var a=$("#tab_explanation").find("a"),b=a.attr("href").replace(/form_name=\w+/,"form_name="+BetForm.attributes.bet_type());return a.attr("href",b),b}}}(),tab_ohlc:function(){return{render:function(a){showLoadingImage(a.content),$.get(this.url(a),function(b){a.content.html(b)}).done(function(){BetAnalysis.set_submit_event(a.id)})},url:function(a){return a.target.attr("href").replace(/&underlying_symbol=\w+/,"&underlying_symbol="+BetForm.attributes.underlying())},show_tab:function(){var a=$("#tab_ohlc");MenuContent.show_tab(a);var b=SessionStore.get("bet_page.selected_analysis_tab");"tab_ohlc"==b&&MenuContent.trigger({tab_id:b})},hide_tab:function(){var a=$("#tab_ohlc");MenuContent.hide_tab(a)}}}(),tab_intradayprices:function(){return{render:function(a){showLoadingImage(a.content),$.get(this.url(a),function(b){a.content.html(b)}).done(function(){BetAnalysis.set_submit_event(a.id)})},url:function(a){return a.target.attr("href").replace(/underlying=\w+/,"underlying="+BetForm.attributes.underlying())},show_tab:function(){var a=$("#tab_intradayprices");MenuContent.show_tab(a);var b=SessionStore.get("bet_page.selected_analysis_tab");"tab_intradayprices"==b&&MenuContent.trigger({tab_id:b})},hide_tab:function(){var a=$("#tab_intradayprices");MenuContent.hide_tab(a)}}}(),tab_pricing_table:function(){return{render:function(a){showLoadingImage(a.content);var b=BetForm.attributes.expiry_type();formData={underlying_symbol:BetForm.attributes.underlying(),H:BetForm.attributes.barrier_1(),L:BetForm.attributes.barrier_2(),barrier_type:BetForm.attributes.barrier_type(),currency:BetForm.attributes.currency(),amount_type:"payout",amount:100,form_name:BetForm.attributes.bet_type(),expiry_type:b},"duration"===b?(formData.duration_amount=BetForm.attributes.duration_amount(),formData.duration_units=BetForm.attributes.duration_units()):(formData.expiry_date=BetForm.attributes.expiry_date(),formData.expiry_time=BetForm.attributes.expiry_time()),$.ajax({type:"POST",url:this.url(a),data:formData,success:function(b){a.content.html(b),attach_tabs("#pricing_table_tabs")},error:function(b,c){a.content.html(c)}})},url:function(a){return a.target.attr("href")},show_tab:function(){var a=$("#tab_pricing_table");MenuContent.show_tab(a);var b=SessionStore.get("bet_page.selected_analysis_tab");"tab_pricing_table"==b&&MenuContent.trigger({tab_id:b})},hide_tab:function(){var a=$("#tab_pricing_table");MenuContent.hide_tab(a)}}}()}}();BetAnalysis.DigitInfo=function(){this.chart_config={chart:{renderTo:"last_digit_histo",defaultSeriesType:"column",backgroundColor:"#eee",borderWidth:1,borderColor:"#ccc",plotBackgroundColor:"#fff",plotBorderWidth:1,plotBorderColor:"#ccc",height:225},title:{text:""},credits:{enabled:!1},exporting:{enabled:!1},legend:{enabled:!1},tooltip:{borderWidth:1,formatter:function(){var a=this,b=$("select[name='tick_count']").val(),c=a.y/b*100;return"<b>Digit:</b> "+a.x+"<br/><b>Percentage:</b> "+c.toFixed(1)+" %"}},plotOptions:{column:{shadow:!1,borderWidth:.5,borderColor:"#666",pointPadding:0,groupPadding:0,color:"#e1f0fb"},series:{dataLabels:{enabled:!0,formatter:function(){var a=$("select[name='tick_count']").val(),b=this.point.y/a*100;return b.toFixed(2)+" %"}}}},xAxis:{categories:["0","1","2","3","4","5","6","7","8","9"],lineWidth:0,lineColor:"#999",tickLength:10,tickColor:"#ccc"},yAxis:{title:{text:""},maxPadding:0,gridLineColor:"#e9e9e9",tickWidth:1,tickLength:3,tickColor:"#ccc",lineColor:"#ccc",endOnTick:!0,opposite:!1,labels:{align:"left",x:0,enabled:!1,formatter:function(){var a=$("select[name='tick_count']").val(),b=parseInt(this.value/a*100);return b+" %"}}}},this.spots=[]},BetAnalysis.DigitInfo.prototype={render:function(a){this.id=a.id;var b=this;$.get(this.url(a),function(b){a.content.html(b)}).done(function(){b.on_latest(),b.show_chart(BetForm.attributes.underlying())})},url:function(){var a=$("#tab_last_digit").find("a"),b=a.attr("href").replace(/underlying=\w+/,"underlying="+BetForm.attributes.underlying());return a.attr("href",b),b},on_latest:function(){var a=this,b=$("#"+this.id+"-content"),c=b.find("form:first");c.on("submit",function(a){return a.preventDefault(),!1}).addClass("unbind_later");var d=function(){var d=c.attr("action");$.ajax({url:d,async:!0,data:c.serialize(),success:function(d){a.chart.destroy(),b.html(d),a.on_latest();var e=$("[name=underlying]",c).val();a.show_chart(e)}})};$("[name=underlying]",c).on("change",d).addClass("unbind_later"),$("[name=tick_count]",c).on("change",d).addClass("unbind_later")},show_chart:function(a){this.chart_config.xAxis.title={text:$("#last_digit_title").html()},this.spots=$.parseJSON($("#last_digit_data").html()),this.chart=new Highcharts.Chart(this.chart_config),this.chart.addSeries({name:a,data:[]}),this.update()},update:function(a,b){if("undefined"!=typeof this.chart){var c=this.chart.series[0];c.name!=a&&(b=void 0),"undefined"!=typeof b&&(this.spots.unshift(b.slice(-1)),this.spots.pop());for(var d=[],e=10,f=function(a){return a==e},g=[];e--;){var h=this.spots.filter(f).length;d[e]=h,"undefined"==typeof g[h]&&(g[h]=0),g[h]++}var i=Math.min.apply(null,d),j=Math.max.apply(null,d),k=d.indexOf(i),l=d.indexOf(j);return 1===g[i]&&(d[k]={y:i,color:"#CC0000"}),1===g[j]&&(d[l]={y:j,color:"#2E8836"}),c.setData(d)}},show_tab:function(){var a=$("#tab_last_digit");MenuContent.show_tab(a);var b=SessionStore.get("bet_page.selected_analysis_tab");"tab_last_digit"==b&&MenuContent.trigger({tab_id:b})},hide_tab:function(){var a=$("#tab_last_digit");MenuContent.hide_tab(a),"undefined"!=typeof this.chart&&this.chart.destroy(),this.chart=void 0,this.spots=[]}},BetAnalysis.tab_last_digit=new BetAnalysis.DigitInfo,BetAnalysis.tab_live_chart=function(){var a=!1,b=!1;return{reset:function(){"undefined"!=typeof live_chart&&null!==live_chart&&(live_chart.close_chart(),live_chart=null)},render:function(c){b=c||!1,a&&$("#live_chart_div").length>0?this.update_live_chart():this.get_live_chart()},get_live_chart:function(){var a=this;$.ajax(ajax_loggedin({url:"/d/trade_livechart.cgi?l="+page.language(),dataType:"html",success:function(b){a.set_live_chart(b)}}))},set_live_chart:function(b){$("#trade_live_chart").html(b);var c=this;this.load_timer||(showLoadingImage($("#live_chart_div")),this.load_timer=setInterval(function(){"undefined"!=typeof Highcharts&&(configure_livechart(),c.update_live_chart(),a=!0,clearInterval(c.load_timer),c.load_timer=void 0)},80))},update_live_chart:function(){this.update_chart_config()&&updateLiveChart(this.live_chart_config),this.add_spot();var a=this;b||BetForm.barriers.each(function(b){a.add_barrier(b)})},update_chart_config:function(){var a=b?sessionStorage.getItem("underlying"):BetForm.attributes.underlying(),c=SessionStore.get("live_chart_duration")||this.get_duration()||"10min";if(!this.live_chart_config)return this.live_chart_config=new LiveChartConfig({renderTo:"live_chart_div",symbol:a,live:c}),!0;var d={},e=!1;return this.live_chart_config.live!=c&&(d.live=c,e=!0),this.live_chart_config.symbol.symbol!=a&&(d.symbol=a,e=!0),e&&this.live_chart_config.update(d),live_chart||(e=!0),e},add_spot:function(){live_chart.config.has_indicator("spot")&&live_chart.remove_indicator("spot");var a=new LiveChartIndicator.Barrier({name:"spot",value:"+0",color:"blue"});live_chart.add_indicator(a)},add_barrier:function(a){live_chart.config.has_indicator(a.component_id)&&live_chart.remove_indicator(a.component_id),a=new LiveChartIndicator.Barrier({name:a.component_id,value:a.value(),color:"green"}),live_chart.add_indicator(a)},get_duration:function(){var a=b?"600":BetForm.attributes.duration_seconds();return $("#live_chart_duration").find("#"+this.corrected_hours_to_chart(a)).data("live")},corrected_hours_to_chart:function(a){var b,c=[];$(".live_charts_stream_button").each(function(){c.push(parseInt($(this).attr("id")))}),c.sort(function(a,b){return a-b});for(b in c)if(a<=c[b])return c[b];return 1},get_duration_seconds:function(a){var b;if(a){b=a.replace(/[a-zA-Z]/g,"");var c=a.replace(/\d+/g,"");if("min"==c)return 60*b;if("h"==c)return 3600*b;if("d"==c)return 86400*b;if("w"==c)return 604800*b;if("m"==c)return 2592e3*b;if("y"==c)return 31536e3*b}return b},live_chart_config:void 0,load_timer:void 0}}();var BetForm=function(){return{init:function(){this.time="undefined"==typeof this.time?new BetForm.Time:this.time,this.barriers="undefined"==typeof this.barriers?new BetForm.Barriers:this.barriers,this.actions.init(),this.actions.register()},unregister_actions:function(){this.actions.unregister()},restore:function(){var a=this.attributes.model.form_name();showLoadingImage($("#betInputBox")),MenuContent.trigger({tab_id:a})},update_content:function(a){var b=$("#betInputBox");b.get(0).innerHTML='<div class="toggle-content">'+a+"</div>"},bom_gmt_time:function(){return moment.utc(page.header.time_now)
},error_message:function(){BetPrice.error_handler()},actions:function(){var a=!1,b=null;return{init:function(){this.on_bet_type_change()},register:function(){$(BetForm.spot).on("change",function(a,b){BetForm.barriers.spot_changed(b)}),$(BetForm.time).on("change",function(a,b){SessionStore.remove("live_chart_duration"),BetForm.barriers.time_changed(b),BetPrice.container().hide()}),$(BetForm.barriers).on("change",function(){BetPrice.container().hide(),BetAnalysis.tab_live_chart.render()});var a=this,b=function(){a.propagating_enter_pressed||(a.propagating_enter_pressed=setInterval(function(){BetPrice.get_price(),clearInterval(a.propagating_enter_pressed),a.propagating_enter_pressed=void 0},100))};BetForm.attributes.form().on("keydown",function(a){13==a.which&&b()}),$(BetForm.time).on("enter_pressed",b)},unregister:function(){BetForm.attributes.form().off("keydown"),$("#bet_underlying").off("change"),$("#submarket").off("change"),$("#bet_currency").off("change"),$("#atleast").off("change"),$(BetForm.spot).off("change"),$(BetForm.time).off("change"),$(BetForm.time).off("enter_pressed"),$(BetForm.barriers).off("change"),BetForm.time.unregister(),BetForm.barriers.unregister(),BetForm.attributes.form().off("submit")},on_bet_type_change:function(){var b=this;a||(a=!0,MenuContent.listen_click(function(a){"betsTab"==a.menu.attr("id")&&(BetForm.attributes.model.form_name()!=a.id&&(BetForm.attributes.model.form_name(a.id),"undefined"!=typeof BetForm.attributes.form_name()&&page.url.invalidate()),b.get_form_by_name(a.id),BetAnalysis.bet_type_changed())}))},get_form_by_name:function(a){b&&b.abort();var c=this;b=$.ajax({url:this.form_url(a),success:function(a){c.unregister(),BetForm.update_content(a),b=null,BetForm.underlying_drop_down.init(),BetForm.attributes.restore.all(),c.on_form_load()}}).fail(function(){BetForm.error_message()})},get_form_by_underlying:function(a){b&&b.abort();var c=this;b=$.ajax({url:this.form_url("",a),success:function(a){c.unregister(),BetForm.update_content(a),b=null,BetForm.underlying_drop_down.init(),BetForm.attributes.restore.all_but_underlying(),c.on_form_load()}}).fail(function(){BetForm.error_message()})},on_form_load:function(){this.correct_selected_tab(),BetPrice.clear_buy_results(),BetForm.time.init(),BetForm.barriers.init(),BetForm.amount.update_calculation_value(),this.show_or_hide_analysis_tabs(),this.on_form_submit(),this.on_underlying_change(),this.on_submarket_change(),this.on_amount_change(),this.on_amount_type_change(),this.on_other_input_change(),$("#bet_calculate").focus(),this.hide_sub_trade(),this.register(),BetForm.attributes.no_bets()||BetPrice.get_price(),BetAnalysis.restore()},hide_sub_trade:function(){for(var a=$("#betsTab").children().find(".tm-ul-2"),b=a.length,c=0;b>c;c++){var d=a.eq(c).children();1==d.length&&d.hide()}},on_underlying_change:function(){var a=this;$("#bet_underlying").on("change",function(){BetForm.attributes.model.underlying($(this).val()),a.update_for_underlying($(this).val())}).addClass("unbind_later")},on_submarket_change:function(){var a=this;$("#submarket").on("change",function(){BetForm.attributes.model.submarket(this.value),BetForm.underlying_drop_down.update_for_submarket(this.value),BetForm.attributes.model.underlying()!=BetForm.attributes.underlying()&&(BetForm.attributes.model.underlying(BetForm.attributes.underlying()),a.update_for_underlying(BetForm.attributes.underlying()))}).addClass("unbind_later")},update_for_underlying:function(a){BetPrice.streaming.stop(),BetForm.spot.clear(),this.get_form_by_underlying(a),BetAnalysis.underlying_changed()},on_other_input_change:function(){$("#bet_currency").on("change",function(){BetForm.attributes.model.currency(this.value),$("#bet_calculation_container").hide()}).addClass("unbind_later"),$("#atleast").on("change",function(){var a=this.value;BetForm.attributes.model.start_time(a),BetForm.time.update_for_start_time_change(),$("#bet_calculation_container").hide()}).addClass("unbind_later"),$("#stop_type").on("change",function(){var a=$(this).val();$("#stop_type_2").val(a),BetForm.attributes.model.stop_type(a),$("#bet_calculation_container").hide()}).addClass("unbind_later"),$("#stop_profit").on("change",function(){var a=$(this),b=BetPrice.spread.validate_change(a);a.val(b),BetForm.attributes.model.stop_profit(b),$("#bet_calculation_container").hide()}).addClass("unbind_later"),$("#stop_loss").on("change",function(){var a=$(this),b=BetPrice.spread.validate_change(a);a.val(b),BetForm.attributes.model.stop_loss(b),$("#bet_calculation_container").hide()}).addClass("unbind_later"),$("#amount_per_point").on("change",function(){var a=$(this),b=BetPrice.spread.validate_change(a);a.val(b),BetForm.attributes.model.amount_per_point(b),$("#bet_calculation_container").hide()}).addClass("unbind_later")},on_form_submit:function(){BetForm.attributes.form().on("submit",function(a){a.preventDefault(),BetPrice.clear_buy_results(),BetPrice.get_price()}).addClass("unbind_later")},show_or_hide_analysis_tabs:function(){BetForm.attributes.show_ohlc()?BetAnalysis.tab_ohlc.show_tab():(BetAnalysis.tab_ohlc.hide_tab(),BetAnalysis.was_showing_tab("tab_ohlc")&&BetAnalysis.show_tab());var a=BetForm.attributes.extratab();"pricing_table"==a?(BetAnalysis.tab_pricing_table.show_tab(),BetAnalysis.tab_intradayprices.hide_tab(),BetAnalysis.tab_last_digit.hide_tab(),(BetAnalysis.was_showing_tab("tab_intradayprices")||BetAnalysis.was_showing_tab("tab_last_digit"))&&BetAnalysis.show_tab("tab_pricing_table")):"last_digit"==a?(BetAnalysis.tab_last_digit.show_tab(),BetAnalysis.tab_pricing_table.hide_tab(),BetAnalysis.tab_intradayprices.hide_tab(),(BetAnalysis.was_showing_tab("tab_intradayprices")||BetAnalysis.was_showing_tab("tab_pricing_table"))&&BetAnalysis.show_tab("tab_last_digit")):"intradayprices"==a?(BetAnalysis.tab_intradayprices.show_tab(),BetAnalysis.tab_pricing_table.hide_tab(),BetAnalysis.tab_last_digit.hide_tab(),(BetAnalysis.was_showing_tab("tab_last_digit")||BetAnalysis.was_showing_tab("tab_pricing_table"))&&BetAnalysis.show_tab("tab_intradayprices")):(MenuContent.hide_tab($("#tab_intradayprices")),MenuContent.hide_tab($("#tab_pricing_table")),MenuContent.hide_tab($("#tab_last_digit")),MenuContent.trigger({tab_id:"tab_explanation"}))},on_amount_change:function(){BetPrice.clear_buy_results(),$("input#amount",BetForm.attributes.form_selector()).on("keyup",BetForm.amount.keyup).addClass("unbind_later"),$("input#amount",BetForm.attributes.form_selector()).on("change",BetForm.amount.lost_focus).addClass("unbind_later")},on_amount_type_change:function(){$("#amount_type").on("change",function(){BetForm.amount.lost_focus(),BetForm.attributes.model.amount_type(this.value)}).addClass("unbind_later")},correct_selected_tab:function(){var a=BetForm.attributes.form_name();$("#bets_tab_"+a).length>0&&0===$("#bets_tab_"+a+".active.tm-li").length&&($("#betsTab .active.tm-li").removeClass("active"),$("#bets_tab_"+a+".tm-li").addClass("active"))},form_url:function(a,b){var c="controller_action=bet_form",d=BetForm.attributes.model.market();"null"!=d&&(c+="&market="+d),a=a?a:BetForm.attributes.model.form_name(),a&&(c+="&form_name="+a),b=b||BetForm.attributes.model.underlying(),b&&markets.by_symbol(b).market.name==d&&(c+="&underlying_symbol="+b);var e=BetForm.attributes.model.time();e&&(c+="&time="+e);var f=BetForm.attributes.model.barrier_1();f&&(c+="&H="+f);var g=BetForm.attributes.model.barrier_2();g&&(c+="&L="+g);var h=BetForm.attributes.model.start_time();h&&(c+="&date_start="+h);var i=page.url.param_if_valid("type");i&&(c+="&type="+i);var j=BetForm.attributes.model.expiry_type();j&&(c+="&expiry_type="+j);var k=BetForm.attributes.model.stop_profit();k&&(c+="&stop_profit="+k);var l=BetForm.attributes.model.stop_loss();l&&(c+="&stop_loss="+l);var m=BetForm.attributes.model.amount_per_point();return m&&(c+="&amount_per_point="+m),page.url.url_for("trade_get.cgi",c)},disable:function(a){var b=$(BetForm.attributes.form_selector());b.find('input[type="submit"]').each(function(){this.disabled=!0}),b.find('button[type="submit"]').each(function(){this.disabled=!0}),a&&(b.find("input").each(function(){this.disabled=!0}),b.find("select").each(function(){this.disabled=!0}),b.find("textarea").each(function(){this.disabled=!0}),b.find("button").each(function(){this.disabled=!0}))},enable:function(a){var b=$(BetForm.attributes.form_selector());b.find('input[type="submit"]').each(function(){this.disabled=!1}),b.find('button[type="submit"]').each(function(){this.disabled=!1}),a&&(b.find("input").each(function(){this.disabled=!1}),b.find("select").each(function(){this.disabled=!1}),b.find("textarea").each(function(){this.disabled=!1}),b.find("button").each(function(){this.disabled=!1}))}}}(),spot:function(){var a=[];return{update:function(b){a.push(b),a.length>=30&&a.shift(),this.show_spot(b),$("#spot_spark").sparkline(a,this.spark_line_config),$(this).trigger("change",[b])},show_spot:function(a){var b=$("#spot");if(a&&parseFloat(a)==a){var c=a,d=b.text();d&&(c=parseFloat(d)),price_moved(b,c,a)}b.html(a)},clear:function(){this.clear_sparkline(),this.show_spot("")},clear_sparkline:function(){a=[],$("#spot_spark").sparkline(a,this.spark_line_config)},value:function(){return parseFloat(a[a.length-1])},spark_line_config:{type:"line",lineColor:"#606060",fillColor:!1,spotColor:"#00f000",minSpotColor:"#f00000",maxSpotColor:"#0000f0",highlightSpotColor:"#ffff00",highlightLineColor:"#000000",spotRadius:1.25}}}(),underlying_drop_down:function(){var a=[];return{init:function(){a=[],$("#bet_underlying > option").each(function(){var b={};b.className=$(this).attr("class"),b.value=$(this).val(),b.label=$(this).text(),a.push(b)})},has:function(b){for(var c in a)if(a[c].value==b)return!0;return!1},update_for_submarket:function(b){var c;if(b){var d=$("#bet_underlying").val();if(this.clear(),"all"==b){var e=a.length;for(c=0;e>c;c++)this.add(a[c])}else{var f=new RegExp("\\b"+b+"\\b");for(c in a)f.test(a[c].className)&&this.add(a[c])}null===$("#bet_underlying").val()&&$("#bet_underlying").val(d)}null===$("#bet_underlying").val()&&$("#bet_underlying").val($("#bet_underlying option:eq(0)").val())},clear:function(){$("#bet_underlying option").remove()},add:function(a){var b=this.create_option(a),c=document.getElementById("bet_underlying");try{c.add(b,c.options[null])}catch(d){c.add(b,null)}},create_option:function(a){var b=BetForm.attributes.model.underlying(),c=document.createElement("option");return c.className=a.className,c.value=a.value,b&&b==a.value&&(c.selected="selected"),c.text=a.label,c}}}(),amount:function(){return{payout_min:1,payout_max:1e5,payout_err:void 0,stake_min:.5,stake_max:1e5,stake_err:void 0,calculation_value:void 0,keyup:function(a){var b=BetForm.amount;if(b.update_calculation_value(),BetForm.attributes.model.amount(b.calculation_value),BetPrice.order_form.update(),188==a.keyCode){var c=$(this).val();$(this).val(c.replace(",","."))}},lost_focus:function(){var a=BetForm.amount;a.update_calculation_value(),BetForm.attributes.model.amount(a.calculation_value),BetPrice.order_form.update(),$("#amount").val(a.calculation_value)},update_calculation_value:function(){var a=BetForm.attributes.amount();this.valid(a)&&(this.calculation_value=a)},valid:function(a){return isNaN(a)?!1:!0},update_settings:function(){this.stake_min=parseFloat($("#staking_context #stake_min").html()),this.stake_max=parseFloat($("#staking_context #stake_max").html()),this.stake_err=$("#staking_context #stake_err").html(),this.payout_min=parseFloat($("#staking_context #payout_min").html()),this.payout_max=parseFloat($("#staking_context #payout_max").html()),this.payout_err=$("#staking_context #payout_err").html()}}}()}}();BetForm.attributes=function(){return{form:function(){return $("form[name=form0]")},expiry_type:function(){return $("[name=expiry_type]",this.form_selector()).val()},expiry_time:function(){return $("[name=expiry_time]",this.form_selector()).val()},expiry_date:function(){return $("[name=expiry_date]",this.form_selector()).val()},no_bets:function(){return $("#no_bets").length>0},form_selector:function(){return $("form[name=form0]").get(0)},form_name:function(){return $("[name=form_name]",this.form_selector()).val()},bet_type:function(){return LocalStore.get("bet_page.form_name")},prediction:function(){return $("[name=prediction]",this.form_selector()).val()},market:function(){return $("[name=market]",this.form_selector()).val()},submarket:function(){return $("[name=submarket]",this.form_selector()).val()},underlying:function(){return $("#bet_underlying",this.form_selector()).val()},underlying_text:function(){return $("#bet_underlying option:selected",this.form_selector()).text()},spot:function(){return $("[name=S]",this.form_selector()).val()},start_time:function(){return $("[name=date_start]",this.form_selector()).val()},start_time_moment:function(){var a=this.start_time(),b=moment.utc(BetForm.bom_gmt_time());return"undefined"!=typeof a&&"now"!==a&&(b=moment.utc(1e3*a)),b},barrier_1:function(){return $("#bet_H",this.form_selector()).val()},barrier_2:function(){return $("#bet_L",this.form_selector()).val()},pip_size:function(){return $("[name=pip_size]",this.form_selector()).val()},barrier_type:function(){var a=$("[name=H]",this.form_selector()).length+$("[name=L]",this.form_selector()).length;return a>0?$("[name=barrier_type]",this.form_selector()).val():void 0},duration_container:function(){return $("#duration_container",this.form_selector())},duration_amount:function(){return $("#duration_amount",this.form_selector()).val()},duration_units:function(){return $("[name=duration_units]",this.form_selector()).val()},duration_seconds:function(){var a=parseInt(parseFloat(this.duration_amount())),b=this.duration_units();return"m"==b?60*a:"h"==b?3600*a:"d"==b?86400*a:a},duration_string:function(){return this.duration_amount()+this.duration_units()},minimum_duration_for:function(a){var b=this.duration_container(),c=b.find("."+a);return c.html()?parseInt(parseFloat(c.html().split(":")[1])):void 0},currency:function(){return $("[name=currency]",this.form_selector()).val()},amount:function(){var a=$("#amount",BetForm.attributes.form_selector()).val();a&&(a=a.replace(",","."),a=a.replace(/[^\d\.]/g,""));var b=parseFloat(a),c=0;if(!isNaN(b)&&b>0){b=Math.round(100*b)/100;var d=Math.floor(b),e=b-d;c=e?b.toFixed(2):d}return c},is_amount_payout:function(){return"payout"==$("#amount_type").val()},is_amount_stake:function(){return"stake"==$("#amount_type").val()},amount_type:function(){return $("#amount_type",this.form_selector()).val()},show_ohlc:function(){return"yes"==$('input[name="showohlc"]',this.form_selector()).val()},extratab:function(){return $('input[name="extratab"]',this.form_selector()).val()},is_forward_starting:function(){return this.start_time()&&this.start_time().match(/^\d+$/)},can_select:function(a,b){return $("#"+a+' option[value="'+b+'"]').length>0?!0:!1},model:function(){return{form_name:function(a){var b="bets_tab_callput";return a&&LocalStore.set("bet_page.form_name",a),a=this.get_setting_or_param("bet_page.form_name","form_name")||b,$("#"+a).length||(a=b),a},market:function(){var a=page.url.param_if_valid("market");return a&&LocalStore.set("bet_page.market",a),page.url.param_if_valid("market")||LocalStore.get("bet_page.market")||"forex"},underlying:function(a){var b=this.market();return a&&(b=markets.by_symbol(a).market.name,LocalStore.set("bet_page.underlying."+b,a),page.url.invalidate()),page.url.param_if_valid("underlying_symbol")||LocalStore.get("bet_page.underlying."+b)},submarket:function(a){return a&&(LocalStore.set("bet_page.submarket",a),page.url.invalidate()),LocalStore.get("bet_page.submarket")},start_time:function(a){return a&&(LocalStore.set("bet_page.start_time",a),page.url.invalidate()),this.get_setting_or_param("bet_page.start_time","date_start")},stop_type:function(a){return a&&(LocalStore.set("bet_page.stop_type",a),page.url.invalidate()),page.url.param_if_valid("stop_type")||LocalStore.get("bet_page.stop_type")||"point"},stop_loss:function(a){return a&&(LocalStore.set("bet_page.stop_loss",a),page.url.invalidate()),page.url.param_if_valid("stop_loss")||LocalStore.get("bet_page.stop_loss")||10},stop_profit:function(a){return a&&(LocalStore.set("bet_page.stop_profit",a),page.url.invalidate()),page.url.param_if_valid("stop_profit")||LocalStore.get("bet_page.stop_profit")||10},amount_per_point:function(a){return a&&(LocalStore.set("bet_page.amount_per_point",a),page.url.invalidate()),page.url.param_if_valid("amount_per_point")||LocalStore.get("bet_page.amount_per_point")||1},expiry_type:function(a){return a&&(LocalStore.set("bet_page.expiry_type",a),page.url.invalidate()),page.url.param_if_valid("expiry_type")||LocalStore.get("bet_page.expiry_type")||"duration"},time:function(a){return a&&(LocalStore.set("bet_page.time",a),page.url.invalidate()),this.get_setting_or_param("bet_page.time","time")},barrier_1:function(){return page.url.param_if_valid("H")},barrier_2:function(){return page.url.param_if_valid("L")},amount:function(a){return a&&(LocalStore.set("bet_page.amount",a),page.url.invalidate()),this.get_setting_or_param("bet_page.amount","amount")},amount_type:function(a){return a&&(LocalStore.set("bet_page.amount_type",a),page.url.invalidate()),this.get_setting_or_param("bet_page.amount_type","amount_type")},currency:function(a){a&&(LocalStore.set("bet_page.currency",a),page.url.invalidate());var b=page.url.param_if_valid("currency");if(b)return b;var c=LocalStore.get("bet_page.currency");return c?c:void 0},get_setting_or_param:function(a,b){var c=LocalStore.get(a),d=page.url.param_if_valid(b);return d?d:c}}}(),restore:function(){return{all:function(){this.submarket(),this.underlying(),this.amount(),this.amount_type(),this.currency()},all_but_underlying:function(){this.submarket(),this.amount(),this.amount_type(),this.currency()},underlying:function(){{var a=BetForm.attributes.model.underlying();BetForm.attributes.model.market()}a&&BetForm.attributes.can_select("bet_underlying",a)&&$("#bet_underlying",BetForm.attributes.form_selector()).val(a)},submarket:function(){var a=(BetForm.attributes.model.market(),BetForm.attributes.model.submarket());a&&BetForm.attributes.can_select("submarket",a)&&($("#submarket",BetForm.attributes.form_selector()).val(a),BetForm.underlying_drop_down.update_for_submarket(a))},amount:function(){var a=BetForm.attributes.model.amount();a&&$("#amount",BetForm.attributes.form_selector()).val(a)},amount_type:function(){var a=BetForm.attributes.model.amount_type();a&&$("#amount_type",BetForm.attributes.form_selector()).val(a)},currency:function(){if(page.client.is_logged_in){var a=Settings.get("client.currencies");"undefined"!==a&&a.length>0&&$("#bet_currency option").each(function(){$.inArray($(this).val(),a)<0&&$(this).remove()})}var b=BetForm.attributes.model.currency();b&&BetForm.attributes.can_select("bet_currency",b)&&$("#bet_currency").val(b)}}}()}}(),BetForm.Barriers=function(){this.defaults={},this.barriers=[]},BetForm.Barriers.prototype={register:function(){var a=this;this.each(function(b){b.register(),$(b).on("change",function(b,c){$(a).trigger("change",[c])})})},unregister:function(){this.each(function(a){a.unregister(),$(a).off("change")})},spot_changed:function(){this.each(function(a){a.update_calclulated_value(a.value())})},time_changed:function(a){var b=BetForm.attributes.barrier_type();moment.utc().isSame(moment.utc(a),"day")?"absolute"==b&&page.settings.get("enable_relative_barrier")&&this.switch_to("relative"):"relative"==b&&this.switch_to("absolute")},init:function(){this.barriers=[];var a,b=BetForm.attributes.barrier_type();$("#bet_H").length>0&&(a=new BetForm.Barriers.Barrier({component_id:"bet_H",calculated_barrier_id:"betInputBox span.calculated_barrier_from_relative_high",barrier_type:b}),a.value(this.select_barrier_value(BetForm.attributes.barrier_1(),"H")),this.barriers.push(a)),$("#bet_L").length>0&&(a=new BetForm.Barriers.Barrier({component_id:"bet_L",calculated_barrier_id:"betInputBox span.calculated_barrier_from_relative_low",barrier_type:b}),a.value(this.select_barrier_value(BetForm.attributes.barrier_2(),"L")),this.barriers.push(a)),this.register()},select_barrier_value:function(a,b){var c=function(){return!0};if(c(a))return a;var d=this.get_defaults_for(BetForm.attributes.barrier_type());return d&&c(d[b])?d[b]:0},switch_to:function(a){"absolute"==a?($(".barrier_text_absolute").show(),$(".barrier_text_relative").hide(),$("[name=barrier_type]",BetForm.attributes.form_selector()).val("absolute"),this.each(function(a){a.switch_to("absolute")})):"relative"==a&&($(".barrier_text_absolute").hide(),$(".barrier_text_relative").show(),$("[name=barrier_type]",BetForm.attributes.form_selector()).val("relative"),this.each(function(a){a.switch_to("relative")}))},each:function(a){for(var b=[],c=this.barriers.length-1;c>=0;)b.push(a(this.barriers[c])),c--;return b},get_defaults_for:function(a){var b=this,c=BetForm.attributes.underlying();market=BetForm.attributes.market(),time=BetForm.attributes.duration_string(),form_name=BetForm.attributes.form_name(),prediction=BetForm.attributes.prediction();var d=c+"_"+time+"_"+form_name+"_"+prediction;return"undefined"==typeof this.defaults[d]&&$.ajax({url:page.url.url_for("trade_get.cgi"),data:{controller_action:"barrier_defaults",underlying_symbol:c,market:market,time:time,form_name:form_name,barrier_type:a},dataType:"json",type:"GET",async:!1}).done(function(a){b.defaults[d]=a}),this.defaults[d]}},BetForm.Barriers.Barrier=function(a){a="undefined"==typeof a?{}:a,this.component_id=a.component_id,this.calculated_barrier_id=a.calculated_barrier_id,this.barrier_type=a.barrier_type},BetForm.Barriers.Barrier.prototype={register:function(){this.on_change(),this.on_keyup()},unregister:function(){$("#"+this.component_id).off("keyup"),$("#"+this.component_id).off("change")},value:function(a){if("undefined"!=typeof a){var b="";"digits"!=BetForm.attributes.form_name()&&("relative"==this.barrier_type?a>0?b="+":0===a&&(b="+",a=this.min_value()):0>a?a=BetForm.spot.value():0===a&&(a=this.to_absolute_value(this.min_value())),a=this.pipsized_value(a)),$("#"+this.component_id).val(b+a),this.update_calclulated_value(a),$(this).trigger("change",[b+a])}return $("#"+this.component_id).val()},switch_to:function(a){this.barrier_type=a;var b=$("#"+this.component_id).val();"absolute"==a?(this.value(this.to_absolute_value(b)),$("#"+this.calculated_barrier_id).hide()):"relative"==a&&(this.value(this.to_relative_value(b)),$("#"+this.calculated_barrier_id).show())},update_calclulated_value:function(a){"relative"==this.barrier_type&&(a=this.pipsized_value(this.to_absolute_value(a)),$("#"+this.calculated_barrier_id).html("("+a+")"))},on_change:function(){var a=this;$("#"+this.component_id).on("change",function(){var b=$(this).val();b.length>0&&a.value(b)}).addClass("unbind_later")},on_keyup:function(){var a=this;$("#"+this.component_id).on("keyup",function(){var b=$(this).val();b.length>0&&a.update_calclulated_value(b)}).addClass("unbind_later")},pipsized_value:function(a){var b=BetForm.attributes.pip_size();return parseFloat(a).toFixed(b)},to_relative_value:function(a){var b=BetForm.spot.value();return b>0?this.pipsized_value(parseFloat(a)-b):0},to_absolute_value:function(a){var b=BetForm.spot.value();return b>0?this.pipsized_value(parseFloat(a)+b):0},min_value:function(){if("undefined"==typeof this.min_relative_value){for(var a=BetForm.attributes.pip_size(),b="0.",c=a-1;c>0;)b+=0,c--;b+=1,this.min_relative_value=b}return"absolute"==this.barrier_type?this.to_absolute_value(this.min_relative_value):this.min_relative_value}},BetForm.Time=function(){this.model={},this.model.expiry_type=BetForm.attributes.model.expiry_type(),this.trading_time=new BetForm.TradingTime,this.duration=new BetForm.Time.Duration(this.trading_time),this.end_time=new BetForm.Time.EndTime(this.trading_time)},BetForm.Time.prototype={init:function(){if("spreads"!=BetForm.attributes.model.form_name()){if(this.trading_time.init(),this.duration.init(),this.end_time.init(),this.register(),"digits"==BetForm.attributes.model.form_name()||"asian"==BetForm.attributes.model.form_name()){var a="duration";$("#expiry_type").val(a),page.url.invalidate(),LocalStore.set("bet_page.expiry_type",a),BetForm.attributes.model.expiry_type(a),this.model.expiry_type=a,$("#duration_amount").val(this.trading_time.min_unit().min)}else $("#expiry_type").val(this.model.expiry_type);this.update_ui()}},register:function(){this.on_expiry_type_change(),this.duration.register(),this.end_time.register();var a=this;$(this.duration).on("change",function(b,c){$(a).trigger("change",[c])}),$(this.end_time).on("change",function(b,c){$(a).trigger("change",[c])}),$(this.duration).on("enter_pressed",function(){$(a).trigger("enter_pressed")}),$(this.end_time).on("enter_pressed",function(){$(a).trigger("enter_pressed")})},unregister:function(){$("#expiry_type").off("change"),this.duration&&this.duration.unregister(),this.end_time&&this.end_time.unregister(),$(this.duration).off("change"),$(this.end_time).off("change"),$(this.duration).off("enter_pressed"),$(this.end_time).off("enter_pressed")},update_for_start_time_change:function(){this.duration.update_units_select(),this.duration.update_ui(),this.end_time.update_ui()},update_ui:function(){"duration"==this.model.expiry_type?(this.duration.show(),this.end_time.hide()):(this.duration.hide(),this.end_time.show())},on_expiry_type_change:function(){var a=this;$("#expiry_type").on("change",function(){BetForm.attributes.model.expiry_type($(this).val()),a.model.expiry_type=$(this).val(),a.update_ui()}).addClass("unbind_later")}},BetForm.TradingTime=function(){this.time_is_duration_regex=/^\d+[smhd]$/,this.time_is_tick_regex=/^\d+t$/,this.trading_info={}},BetForm.TradingTime.prototype={init:function(){this.suggested_duration=this.virgule_duration(""+$("#duration_amount").val()+$("#duration_units").val()),this.parse_units_from_form()},value:function(a){return a&&BetForm.attributes.model.time(a),a=BetForm.attributes.model.time(),a?a:""+$("#duration_amount").val()+$("#duration_units").val()},underlying:function(){return BetForm.attributes.underlying()},is_forward_starting:function(){return BetForm.attributes.is_forward_starting()},as_duration:function(){var a,b=this.value();a=this.time_is_tick(b)?this.virgule_duration(b):this.time_is_duration(b)?this.virgule_duration(b):isNaN(parseInt(b))?this.suggested_duration:this.convert_to_duration(b);var c=this.configured_unit_for(a.units);if(!c){var d=this.min_unit();a.amount=d.min,a.units=d.units}return a},as_end_time:function(){var a,b=this.value();if(this.time_is_duration(b)){var c=this.virgule_duration(b);a=this.convert_to_end_time(c.amount,c.units)}else a=isNaN(parseInt(b))?this.convert_to_end_time(this.suggested_duration):this.virgule_end_time(b);var d=this.min_time();a.moment.isBefore(d)&&(a=this.virgule_end_time(d.utc()/1e3));var e=this.max_time();return a.moment.isAfter(e)&&(a=this.virgule_end_time(d.utc()/1e3)),a},update_from_duration:function(a,b){this.configured_unit_for(b);this.value(""+a+b)},update_from_end_time:function(a,b){var c=moment.utc(a+" "+b),d=this.min_time();if(c.isBefore(d)&&(c=d),!moment.utc().isSame(c,"day")){var e=this.get_trading_times(a);c=moment.utc(e.closing)}this.value(Math.ceil(c.utc()/1e3))},min_time:function(){var a=this.min_unit();return this.convert_to_end_time(a.min,a.units).moment},max_time:function(){var a=this.max_unit();return this.convert_to_end_time(a.max,a.units).moment},min_unit:function(){for(var a=this.configured_units_by_start_time(),b=["d","h","m","s","t"],c=b.length;c>0;)if(c--,a[b[c]])return a[b[c]]},max_unit:function(){for(var a=this.configured_units_by_start_time(),b=["t","s","m","h","d"],c=b.length;c>0;)if(c--,a[b[c]])return a[b[c]]},time_is_tick:function(a){return this.time_is_tick_regex.test(a)},time_is_duration:function(a){return this.time_is_duration_regex.test(a)},convert_to_duration:function(a){var b,c,d=BetForm.attributes.start_time_moment(),e=moment.utc(1e3*parseInt(a)),f=e.valueOf()-d.valueOf(),g=this.min_unit(),h=BetForm.attributes.start_time_moment().add(g.min,g.units);return e.isBefore(h)?(b=g.units,c=g.min):60>f/1e3?(b="s",c=Math.ceil(f/1e3)):60>f/6e4?(b="m",c=Math.ceil(f/6e4)):24>f/36e5?(b="h",c=Math.ceil(f/36e5)):(b="d",c=e.diff(d,"day")),{units:b,amount:c}},convert_to_end_time:function(a,b){var c=BetForm.attributes.start_time_moment();if(c.add(a,b),"d"==b){var d=this.get_trading_times(c.format("YYYY-MM-DD"));c=d.closing}var e=c.format("HH:mm:ss");return moment.utc().isSame(c,"day")&&(e=c.format("HH:mm")),{expiry_date:c.format("YYYY-MM-DD"),expiry_time:e,moment:c}},virgule_duration:function(a){var b=a.substring(a.length-1),c=a.substring(0,a.length-1);return{units:b,amount:c}},virgule_end_time:function(a){var b=1e3*parseInt(a),c=moment.utc(b),d=c.format("HH:mm:ss");if(moment.utc().isSame(c,"day")&&(d=c.format("HH:mm")),!moment.utc().isSame(c,"day")){var e=this.get_trading_times(c.format("YYYY-MM-DD"));d=moment.utc(e.closing).format("HH:mm:ss")}return{expiry_date:c.format("YYYY-MM-DD"),expiry_time:d,moment:c}},is_valid_duration:function(a,b){var c=this.configured_unit_for(b);return a<c.min?!1:!0},configured_units_by_start_time:function(){var a=this.configured_units.spot;return this.is_forward_starting()&&(a=this.configured_units.forward_starting),a},configured_unit_for:function(a){var b=this.configured_units_by_start_time();return b[a]},parse_units_from_form:function(){var a={},b={},c=BetForm.attributes.duration_container();$("#duration_units > option").each(function(){var d={};d.className=$(this).attr("class"),d.selected=$(this).attr("selected"),d.units=$(this).val(),d.label=$(this).text(),d.max=59,"d"==d.units?d.max=365:"h"==d.units?d.max=23:"t"==d.units&&(d.max=10),"forward_starting"==d.className?(d.min_select=c.find(".non_input.forward_starting."+d.units),d.min=parseInt(d.min_select.html().split(":")[1]),b[d.units]=d):(d.min_select=c.find(".non_input."+d.units+":not(.forward_starting)"),d.min=parseInt(d.min_select.html().split(":")[1]),a[d.units]=d)}),this.configured_units={},this.configured_units.spot=a,this.configured_units.forward_starting=b},trading_dates:function(){var a=[],b=this.get_trading_days();for(var c in b)b[c].trading&&a.push(c);return a},get_trading_days:function(){var a=BetForm.attributes.underlying(),b=BetForm.attributes.barrier_1();if("undefined"==typeof this.trading_info[a]){var c=this;$.ajax({url:page.url.url_for("trade_get.cgi"),data:{controller_action:"trading_days",underlying_symbol:a,form_name:BetForm.attributes.form_name(),date_start:BetForm.attributes.start_time(),barrier:b},dataType:"json",async:!1}).done(function(b){c.trading_info[a]={};for(var d in b)if(b.hasOwnProperty(d)){var e=d.split("-");e[1]=parseInt(e[1]-1);var f=moment.utc(e).format("YYYY-MM-DD");c.trading_info[a][f]={trading:1==b[d]?!0:!1}}})}return this.trading_info[a]},get_trading_times:function(a){var b=this.underlying();"undefined"==typeof this.trading_info[b]&&this.get_trading_days();var c=this;return"undefined"==typeof this.trading_info[b][a]&&(this.trading_info[b][a]={trading:0}),("undefined"==typeof this.trading_info[b][a].opening||"undefined"==typeof this.trading_info[b][a].closing)&&$.ajax({url:page.url.url_for("trade_get.cgi","","cached"),data:{controller_action:"trading_times",underlying_symbol:b,trading_date:a},dataType:"json",type:"GET",async:!1}).done(function(d){c.trading_info[b][a].opening=moment.utc(d.opening),c.trading_info[b][a].closing=moment.utc(d.closing)}),this.trading_info[b][a]}},BetForm.Time.Duration=function(a){this.trading_time=a,this.date_picker=new DatePicker.SelectedDates("duration_amount","diff")},BetForm.Time.Duration.prototype={init:function(){this.update_units_select()},register:function(){this.on_unit_change(),this.on_amount_change();var a=this;$(this.date_picker).on("enter_pressed",function(){$(a).trigger("enter_pressed")})},unregister:function(){this.date_picker.hide(),$(this.date_picker).off("change"),$("#duration_amount").off("change"),$(this.date_picker).off("enter_pressed"),$("#duration_units").off("change")
},show:function(){$("#expiry_type_duration").show(),this.update_ui()},hide:function(){$("#expiry_type_duration").hide(),this.date_picker.hide()},update_units_select:function(){$("#duration_units option").remove();var a=this.trading_time.configured_units_by_start_time();for(var b in a)a.hasOwnProperty(b)&&this.add_duration_unit(a[b])},update_ui:function(){var a=this.trading_time.as_duration();if($("#duration_units >option[value="+a.units+"]").length>0){$("#duration_units").val(a.units);var b=this.trading_time.configured_unit_for(a.units);BetForm.attributes.duration_container().find(".non_input").hide(),b.min_select.show()}$("#duration_amount").val(a.amount),"d"==a.units?this.date_picker.show(this.trading_time.trading_dates()):this.date_picker.hide();"t"==a.units?$('#expiry_type option[value="endtime"]').prop("disabled",!0):($('#expiry_type option[value="endtime"]').prop("disabled",!1),$(this).trigger("change",[this.trading_time.as_end_time().moment]))},on_unit_change:function(){var a=this;$("#duration_units").on("change",function(){var b=a.trading_time.as_duration().amount;a.trading_time.update_from_duration(b,this.value),$(a).trigger("change",[a.trading_time.as_end_time().moment]),a.update_ui()}).addClass("unbind_later")},on_amount_change:function(){var a=this,b=function(b){var c=a.trading_time.as_duration().units;b=isNaN(parseInt(b))?BetForm.time.trading_time.configured_unit_for(c).min:parseInt(b);var d=a.trading_time.configured_unit_for(c).min_select;a.trading_time.update_from_duration(b,c),a.update_ui(),a.trading_time.is_valid_duration(b,c)?($(this).removeClass("error"),d.removeClass("error")):($(this).addClass("error"),d.addClass("error"))};$("#duration_amount").on("change",function(){b($(this).val())}).addClass("unbind_later"),$(this.date_picker).on("change",function(a,c){b(c)})},add_duration_unit:function(a){if(a){var b=this.create_option(a),c=document.getElementById("duration_units");try{c.add(b,c.options[null])}catch(d){c.add(b,null)}}},create_option:function(a){var b=document.createElement("option");return b.className=a.className,b.value=a.units,b.selected=a.selected,b.text=a.label,b}},BetForm.Time.EndTime=function(a){this.trading_time=a,this.time_picker=new TimePicker("expiry_time"),this.date_picker=new DatePicker.SelectedDates("expiry_date")},BetForm.Time.EndTime.prototype={init:function(){},register:function(){this.on_time_change(),this.on_date_change();var a=this,b=function(){$(a).trigger("enter_pressed")};$(this.time_picker).on("enter_pressed",b),$(this.date_picker).on("enter_pressed",b)},unregister:function(){this.time_picker.hide(),this.date_picker.hide(),$(this.date_picker).off("change"),$(this.time_picker).off("change"),$(this.date_picker).off("enter_pressed"),$(this.time_picker).off("enter_pressed")},show:function(){$("#expiry_type_endtime").show(),this.update_ui()},hide:function(){$("#expiry_type_endtime").hide(),this.time_picker.hide(),this.date_picker.hide()},update_ui:function(){var a=this.trading_time.as_end_time();$("#expiry_date").val(a.expiry_date),$("#expiry_time").val(a.expiry_time),$(this).trigger("change",[a.moment]);var b=moment.utc();if(this.date_picker.hide(),this.time_picker.hide(),b.isSame(a.moment,"day")){$("#expiry_time").attr("disabled",!1);var c=this.trading_time.get_trading_times(a.expiry_date);this.time_picker.show(c.opening,c.closing),$("#market-closed-tip").hide()}else $("#expiry_time").attr("disabled",!0),$("#market-closed-tip").show();this.trading_time.is_forward_starting()?$("#expiry_date").attr("disabled",!0):$("#expiry_date").attr("disabled",!1);var d=this.trading_time.min_unit(),e=this.trading_time.trading_dates();("d"!==d.units||0===d.min)&&e.push(b.format("YYYY-MM-DD")),this.date_picker.show(e)},on_date_change:function(){var a=this;$(this.date_picker).on("change",function(b,c){var d=a.trading_time.as_end_time();a.trading_time.update_from_end_time(c,d.expiry_time),a.update_ui()}).addClass("unbind_later")},on_time_change:function(){var a=this;$(this.time_picker).on("change",function(b,c){var d=a.trading_time.as_end_time();a.trading_time.update_from_end_time(d.expiry_date,c),a.update_ui()}).addClass("unbind_later")}};var BetPrice=function(){var a=null,b=null;return{deregister:function(){$("#content button.buy_bet_button").off("click")},container:function(){return $("#bet_calculation_container")},price_url:function(){var a=BetForm.attributes.form_selector()?BetForm.attributes.form_selector().action:"";return a?a:""},params:function(){var a=getFormParams(BetForm.attributes.form_selector());return a+="&st="+BetForm.attributes.underlying(),a+="&expiry="+BetForm.attributes.duration_string(),a+="&"+Math.floor(83720*Math.random()),a+="&ajax_only=1&price_only=1"},cancel_previous_request:function(){a&&a.abort()},get_price:function(){var b=this;this.cancel_previous_request(),this.show_loading();var c=this.price_url();c?a=$.ajax(ajax_loggedin({url:c,dataType:"html",data:this.params(),success:function(a){b.price_update(a)}})).fail(function(){b.error_handler()}):b.error_handler()},error_handler:function(){this.container().find("div.rbox-lowpad:first").html(text.localize("There was a problem accessing the server.")),this.streaming.stop()},price_update:function(b){a=null,this.deregister();var c=BetPrice.container().find("div.rbox-lowpad:first");c.hide().html(b),this.on_buy();var d=$("#sendBetUrlLink").attr("href");d&&page.url.update(d),c.show(),BetForm.amount.update_settings(),this.streaming.start()},on_buy:function(){var a=this;$("#content button.buy_bet_button").on("click",function(b){b=b||window.event,"function"==typeof b.preventDefault&&b.preventDefault(),BetPrice.order_form.disable_buy_buttons(),a.hide_buy_buttons();var c=$(b.target).parents("form");return a.buy_bet(c),!1}).addClass("unbind_later"),$("a.spread_250, a.spread_260").on("click",function(b){b=b||window.event,"function"==typeof b.preventDefault&&b.preventDefault();var c=$(b.target),d=c.parents('a[class^="spread"]');a.spread.disable(d);var e=$(b.target).parents("form");return a.buy_bet(e),!1}).addClass("unbind_later")},buy_bet:function(a){var b=this,c=6e4;if(!$.cookie("login"))return page.client.is_logged_in=!1,void(window.location.href=page.url.url_for("login"));var d=getFormParams(a.get(0))+"&ajax_only=1";$.ajax(ajax_loggedin({url:a.attr("action"),type:"POST",async:!0,data:d,timeout:c,success:function(c,d,e){b.on_buy_bet_success(a,c,d,e)},error:function(c,d,e){b.on_buy_bet_error(a,c,d,e)}})),$(".price_box").fadeTo(200,.6)},on_buy_bet_success:function(a,b){var c={};if("object"==typeof b)c=b;else try{c=JSON&&JSON.parse(b)||$.parseJSON(b)||{}}catch(d){{this.container().width()||300}return}if(c.redirect)return void(window.location.href=c.redirect);if(c.error){{this.container().width()}this.display_buy_error(c.error)}else{if(!c.display)throw new Error("Invalid server response: "+c);this.display_buy_results(c),BetSell.register()}$(".price_box").fadeTo(0,1),BetPrice.order_form.enable_buy_buttons(),this.display_buy_buttons()},on_buy_bet_error:function(a,b,c,d){var e=""+d;e+=b.responseText?b.responseText:!document.location.href.match(/^http:/)||e&&!e.match(/access/i)?text.localize("There was a problem accessing the server during purchase."):'<ul>Please <a href="'+document.location.href.replace("http://","https://")+'">continue browsing using HTTPS secure protocol</a></ul>';var f=this.container().width();this.display_buy_error('<div style="width: '+f+'px;"><h3>Error</h3><p>'+e+" </p></div>",1),$(".price_box").fadeTo(0,1),BetPrice.order_form.enable_buy_buttons(),this.display_buy_buttons()},buy_response_container:function(){if(!b){var a=this.container();b=$('<div id="buy_confirm_container" class="trade_confirm_container ajax_response"><a class="close">x</a><div></div></div>'),b.hide(),b.height("100%"),a.append(b)}return b},display_buy_results:function(a){var b=this,c=a.display,d=this.buy_response_container();if(d.children("div").first().html(c),$("#tick_chart").length>0&&(a.show_contract_result=1,TickDisplay.initialize(a)),$("#is-digit").data("is-digit")){var e=moment(1e3*a.contract_start).utc();b.digit.process(e)}d.show();var f=function(){b.clear_buy_results()};d.find("a.close").on("click",f).css("cursor","pointer").addClass("unbind_later")},spread:function(){return{reset:function(){"undefined"!=typeof this._stream&&(this._stream.close(),this._stream.onmessage=function(){})},validate_change:function(a){var b=a.attr("value"),c=a.val();return c.toString().match(/^[0-9.]*$/)||(c=b),c},disable:function(a){a.unbind("click")},on_sell:function(){var a=this;$("button.close_position").on("click",function(b){b=b||window.event,"function"==typeof b.preventDefault&&b.preventDefault();var c=$(b.target);return BetSell.model.reload_page_on_close(!0),a.spread_con().find("#sell_level").parent().hide(),a.sell_bet(c),!1}).addClass("unbind_later")},sell_bet:function(a){var b=this;b.reset(),a.attr("disabled","disabled").hide();var c=a.parents("form"),d=6e4;if(!$.cookie("login"))return page.client.is_logged_in=!1,void(window.location.href=page.url.url_for("login"));var e=getFormParams(c.get(0))+"&ajax_only=1";$.ajax(ajax_loggedin({url:c.attr("action"),type:"POST",async:!0,data:e,timeout:d,success:function(a,d,e){b.on_sell_success(c,a,d,e)},error:function(a,d,e){b.on_sell_error(c,a,d,e)}})),$(".price_box").fadeTo(200,.6)},on_sell_error:function(a,b){var c=this;"undefined"!=typeof b.error&&(c.err_con().find("p").text(b.error),c.err_con().show())},on_sell_success:function(a,b){var c=this,d=c.spread_con();"undefined"!=typeof b.error?(c.err_con().find("p").text(b.error),c.err_con().show()):(d.find("#status").addClass("loss").text(text.localize("Closed")),c.paint_it(b.value.dollar,d.find("#pnl_value").text(b.value.dollar)),d.find("#pnl_point").text(b.value.point),d.find("#exit_level").text(b.exit_level).parents("tr").show())},paint_it:function(a,b){var c=a>0?"profit":"loss";$(b).removeClass().addClass(c)},stream:function(a){var b=this;b.on_sell();var c=window.location.protocol+"//"+page.settings.get("streaming_server")+"/push/price/"+a;b._stream=new EventSource(c,{withCredentials:!0}),b._stream.onmessage=function(a){for(var c=JSON.parse(a.data),d=c.prices,e=b.spread_con(),f=b.err_con(),g=0;g<d.length;g++){var h=(d[g].id,parseFloat(d[g].level));if("undefined"!=typeof d[g].value){if(null!==d[g].err){e.find(".close_position").hide(),f.find("p").text(d[g].err),f.show();break}f.hide(),e.find(".close_position").show(),e.find("#sell_level").text(h);var i=b.round(parseFloat(d[g].value.dollar),2);b.paint_it(i,e.find("#pnl_value").text(i)),e.find("#pnl_point").text(d[g].value.point)}var j,k;if(b.stop_loss_level()>b.stop_profit_level()?(j=b.stop_loss_level(),k=b.stop_profit_level()):(k=b.stop_loss_level(),j=b.stop_profit_level()),h>=j||k>=h){var l=e.find(".close_position");l.click();break}}},b._stream.onerror=function(){b._stream.close()}},err_con:function(){var a=this;return a.spread_con().find("#error_box")},spread_con:function(){return $("#sell_content_wrapper")},split_level:function(a){var b=a.toString().match(/[0-9]+/g),c=b[0],d=b[1]||"00";return{point:c,decimal:d}},stop_loss_level:function(){var a=this;return parseFloat(a.spread_con().find("#stop_loss_level").text())},stop_profit_level:function(){var a=this;return parseFloat(a.spread_con().find("#stop_profit_level").text())},round:function(a,b){var c=Math.round(a*Math.pow(10,b))/Math.pow(10,b);return c=c.toFixed(b)}}}(),digit:function(){return{reset:function(){var a=this;a.ev.close(),a.digit_tick_count=0,a.applicable_ticks=[],a.info_for_display=[]},process:function(a){var b=this;b.digit_tick_count=0,b.applicable_ticks=[],b.info_for_display=[];var c=BetForm.attributes.underlying(),d=$("#tick-count").data("count"),e=window.location.protocol+"//"+page.settings.get("streaming_server");e+="/stream/ticks/"+c+"/"+a.unix(),b.ev=new EventSource(e,{withCredentials:!0}),b.ev.onmessage=function(c){var e=JSON.parse(c.data);e[0]instanceof Array||(e=[e]);for(var f=0;f<e.length;f++)if("tick"===e[f][0]){var g={epoch:e[f][1],quote:e[f][2]};if(g.epoch>a.unix()&&b.digit_tick_count<d){if(b.applicable_ticks.length>0){var h=b.info_for_display[b.info_for_display.length-1][1];if(h===g.epoch)continue}b.applicable_ticks.push(g.quote),b.digit_tick_count++,b.info_for_display.push([b.digit_tick_count,g.epoch,g.quote]),b.update_display(),"none"===$("#digit-contract-details").css("display")&&$("#digit-contract-details").show()}if(b.applicable_ticks.length===d){b.evaluate_digit_outcome(),b.reset();break}}},b.ev.onerror=function(){b.ev.close()}},update_display:function(){for(var a=this,b=a.info_for_display.slice(-5),c=0;5>c;c++)if("undefined"!=typeof b[c]){var d=b[c][0],e=moment.utc(1e3*b[c][1]).format("hh:mm:ss"),f=b[c][2].toString();$("#count-"+c).text("Tick "+d),$("#time-"+c).text(e);var g=f.substr(0,f.length-1),h=f.substr(-1);$("#tick-"+c+" span#latest-shorten").text(g),$("#tick-"+c+" span#latest-last").text(h)}},evaluate_digit_outcome:function(){var a=this,b=$("#contract-sentiment").data("contract-sentiment"),c=$("#client-prediction").data("client-prediction"),d=a.applicable_ticks[a.applicable_ticks.length-1],e=parseInt(d.toString().substr(-1)),f=parseFloat($("#outcome-payout").data("payout").toString().replace(",","")),g=parseFloat($("#outcome-buyprice").data("buyprice").toString().replace(",",""));$("#contract-outcome-buyprice").text($("#outcome-buyprice").data("buyprice"));var h;"match"===b?h=e===c?f:0:"differ"===b&&(h=e!==c?f:0),$("#confirmation_table").hide(),$("#contract-outcome-payout").text(a.round(h,2)),0!==h?($("#bet-confirm-header").text(text.localize("This contract won")),$("#contract-outcome-profit").removeClass("standin").addClass("standout profit").text(a.round(f-g,2)),$("#digit-contract-details").css("background","rgba(46,136,54,0.198039)")):($("#bet-confirm-header").text(text.localize("This contract lost")),$("#contract-outcome-label").removeClass("standout profit").addClass("standin loss").text(text.localize("Loss")),$("#contract-outcome-profit").removeClass("standout profit").addClass("standin loss").text(a.round(g,2)),$("#digit-contract-details").css("background","rgba(204,0,0,0.098039)")),$("#contract-outcome-details").show()},round:function(a,b){var c=Math.round(a*Math.pow(10,b))/Math.pow(10,b);return c=c.toFixed(b)}}}(),display_buy_error:function(a,b){var c=this,d=this.buy_response_container();d.addClass("bet_confirm_error"),b&&(a+="<p>"+text.localize("Please confirm the trade on your statement before proceeding.")+"</p>"),a="<p>"+a+"</p>",d.children("div").first().html(a),d.show();var e=function(){c.clear_buy_results()};d.find("a.close").on("click",e).css("cursor","pointer").addClass("unbind_later")},clear_buy_results:function(){var a=this.buy_response_container();$("#tick_chart").length>0&&TickDisplay.reset(),$("#is-digit").data("is-digit")&&this.digit.reset(),$("a[class^=spread]").length>0&&this.spread.reset(),a.hide().remove(),b=null},hide_buy_buttons:function(){this.deregister(),this.order_form.hide_buy_button()},display_buy_buttons:function(){this.on_buy(),this.order_form.show_buy_button()},show_loading:function(){var a=page.settings.get("image_link"),b='<p id="loading-price">'+text.localize("loading...")+'<br /><img src="'+a.hourglass+'" /></p>';this.container().find("div.rbox-lowpad:first").show().html('<div class="rbox rbox-bg-alt"><div class="rbox-wrap"><div class="rbox-content">'+b+'</div></div><span class="tl">&nbsp;</span><span class="tr">&nbsp;</span><span class="bl">&nbsp;</span><span class="br">&nbsp;</span></div></div>'),this.container().show()},streaming:function(){var a=null,b=!1;return{start:function(){BetForm.spot.clear_sparkline(),this.stop(),b=!0;var c=this.stream_channel(),d=window.location.protocol+"//"+page.settings.get("streaming_server")+"/push/price/"+c;if(d&&"undefined"!=typeof EventSource){a=new EventSource(d,{retry:18e6});var e=this;a.onmessage=function(a){e.process_message(a.data)},a.addEventListener("ping",function(){return!0})}else $("#spot_spark").html('<span title="'+text.localize("We are not able to stream live prices at the moment. To enjoy live streaming of prices try refreshing the page, if you get this issue after repeated attempts try a different browser")+'">'+text.localize("No Live price update")+"</span>")},stop:function(){null!==a&&(a.close(),a=null)},ignore_updates:function(){b=!1},stream_channel:function(){return $("#stream_channel").html()},process_message:function(a){if("stop_bet"==a?BetPrice.order_form.hide_buy_button():BetPrice.order_form.show_buy_button(),b){var c=JSON.parse(a);BetForm.spot.update(c.spot),BetPrice.order_form.update_from_stream(c),BetAnalysis.tab_last_digit.update(BetForm.attributes.underlying(),c.spot)}}}}(),order_form:function(){return{forms:function(){return $("form[name=orderform]")},form_by_id:function(a){return $("#orderform_"+a)},verify_display_id:function(a){var b=$('input[name="display_id"]',this.form_by_id(a));return b&&b.val()==a},hide_buy_button:function(){return $('button[name^="btn_buybet"]').parent().hide()},show_buy_button:function(){return $('button[name^="btn_buybet"]').parent().show()},disable_buy_buttons:function(){$('button[name^="btn_buybet"]').attr("disabled","disabled")},enable_buy_buttons:function(){$('a[id^="spread"]').removeAttr("disabled"),$('button[name^="btn_buybet"]').removeAttr("disabled")},update_from_stream:function(a){var b=a.type;if("spread"===b)this.update_spread_ui(a.prices);else if("price"===b){var c=this.prices_from_stream(a.prices);this.update_form(c),this.update_ui(c)}},update:function(a){a="undefined"!=typeof a?a:this.prices_from_form(),this.update_form(a),this.update_ui(a)},prices_from_stream:function(a){for(var b=[],c=0;c<a.length;c++){var d=a[c].id||void 0,e=a[c].value||void 0;d&&void 0!==e&&b.push(this.calculate_price(d,e,a[c].err))}return b},prices_from_form:function(){var a,b,c,d,e=[],f=$(".orderform"),g=f?f.length:0;if(g>0)for(a=0;g>a;a++){b=$('input[name="display_id"]',h).val(),c=$('input[name="prob"]',h).val();var h=$(f[a]),i=h.parent().parent().parents().siblings(".bet-error-box").html();i.length>0&&i!=BetForm.amount.payout_err&&i!=BetForm.amount.stake_err&&(d=i),e.push(this.calculate_price(b,c,d))}else{var j=$("#bet_calculation_container").find(".bet-error-box"),k=j.length;for(a=0;k>a;a++){var l=$(j[a]);b=l.find("#error_display_id").val(),b&&(c=l.find("#error_probability_"+b).val(),d=void 0,l.html().length>0&&(d=l.html()),e.push(this.calculate_price(b,c,d)))}}return e},calculate_price:function(a,b,c){var d,e,f,g,h=this.form_by_id(a),i=BetForm.amount.calculation_value;BetForm.attributes.is_amount_stake()?(e=this.virgule_amount(Math.round(i/b*100)),d=this.virgule_amount(100*i)):BetForm.attributes.is_amount_payout()&&(d=this.virgule_amount(Math.round(i*b*100)),e=this.virgule_amount(100*i));var j=$('input[name="price"]',h).length?parseFloat($('input[name="price"]',h).val()):0,k=$('input[name="payout"]',h).length?parseFloat($('input[name="payout"]',h).val()):0;return e&&d?(f=this.virgule_amount(e.raw-d.raw),g=Math.round(f.raw/d.raw*100)):(f=this.virgule_amount(0),g=this.virgule_amount(0)),e=e?e:this.virgule_amount(0),d=d?d:this.virgule_amount(0),{type:"price",id:a,prob:b,err:c,price:d,payout:e,profit:f,roi:g,prev_price:this.virgule_amount(100*j),prev_payout:this.virgule_amount(100*k)}},update_form:function(a){for(var b=0;b<a.length;b++){var c=this.form_by_id(a[b].id);$('input[name="prob"]',c).val(a[b].prob),$('input[name="price"]',c).val(a[b].price.raw/100),$('input[name="payout"]',c).val(a[b].payout.raw/100),$('input[name="amount_type"]',c).val(BetForm.attributes.amount_type())}},update_ui:function(a){for(var b=0;b<a.length;b++){var c=this.form_by_id(a[b].id),d=a[b].err,e=BetForm.amount,f=.001;a[b].payout.raw/100-f>e.payout_max||a[b].payout.raw/100+f<e.payout_min?d=e.payout_err:(a[b].price.raw/100-f>e.stake_max||a[b].price.raw/100+f<e.stake_min)&&(d=e.stake_err),this.show_error(c,d),this.update_price(a[b].id,a[b].price,a[b].prev_price),this.update_description(a[b].id,a[b].payout,a[b].prev_payout),this.update_profit_roi(a[b].id,a[b].profit,a[b].roi)}},update_spread_ui:function(a){for(var b=0;b<a.length;b++){var c=a[b].id,d=a[b].level,e=BetPrice.spread.split_level(d),f=$(".spread_"+c);f.find(".spread_point_"+c).text(e.point),f.find(".spread_decimal_"+c).text("."+e.decimal)}},update_price:function(a,b,c){var d=$("#units_for_"+a),e=$("#cents_for_"+a),f=$("#amount_for_"+a);price_moved(f,c.raw,b.raw),d.text(b.units),e.text(b.cents)},update_description:function(a,b){$("#amount_for_"+a).siblings(".bet_description").each(function(){var a=$(this);if(a){var c=a.text();c&&(c=c.trim(),/^([A-Z]{3}) \d+\.\d+/.test(c)&&(c=c.replace(/\d+\.\d+/,b.value),a.text(c)))}})},update_profit_roi:function(a,b,c){$("#id_"+a+"_profit").text(b.value),$("#id_"+a+"_roi").text(c)},show_error:function(a,b){var c=a.parent(),d=c.parents().siblings(".bet-error-box");b?(d.html(b),d.show(),c.hide()):(d.hide(),c.show())},virgule_amount:function(a){for(var b=a.toFixed(0).toString();b.length<3;)b="0"+b;var c=b.length-2,d=virgule(b.substr(0,c)),e="."+b.substr(c);return{units:d,cents:e,value:d+e,raw:a}}}}()}}(),BetSell=function(){var a=null,b=null,c=null,d=!1,e={},f={},g=null,h=300,i={currency:null,shortcode:null,payout:null,purchase_price:null,reload_page_on_close:!1};return{_init:function(){a=null,b=null,c=null,d=!1,e={},f={},g=null,i={currency:null,shortcode:null,payout:null,purchase_price:null,reload_page_on_close:!1},this.update_high_low(!0)},model:{currency:function(a){return a?(i.currency=a,this):i.currency},shortcode:function(a){return a?(i.shortcode=a,this):i.shortcode},payout:function(a){return a?(i.payout=a,this):i.payout},purchase_price:function(a){return a?(i.purchase_price=a,this):i.purchase_price},reload_page_on_close:function(a){return void 0!==a?(i.reload_page_on_close=a?!0:!1,this):i.reload_page_on_close}},container:function(a){if(a&&(this._container&&this._container.remove(),this._container=null),!this._container){var b=this,c=$('<div class="inpage_popup_container" id="sell_popup_container"><a class="close">x</a><div class="inpage_popup_content"></div></div>');c.hide();var d=function(){var a=b.model.reload_page_on_close();b.cleanup(!0),a&&window.location.reload(!0)};c.find("a.close").on("click",function(){d()}),$(document).on("keydown",function(a){27===a.which&&d()}),this._container=c}return this._container},clear_timers:function(){for(var a in e)e.hasOwnProperty(a)&&window.clearInterval(e[a]);for(var b in f)f.hasOwnProperty(b)&&window.clearTimeout(f[b])},cleanup:function(a){this.close_container(),a&&(this.cancel_previous_sell_request(),this.cancel_previous_analyse_request()),this._init()},basic_cleanup:function(){this.clear_timers(),this.sparkline.clear(),this.streaming.stop(),this.streaming.url(null)},close_container:function(){this.basic_cleanup(),live_chart&&"undefined"!=typeof live_chart&&live_chart.close_chart(),this._container&&(this._container.hide().remove(),this._container=null)},server_data:function(){var a={},b=$("#sell_extra_info_data");return b&&(sessionStorage.getItem("stream_url")&&sessionStorage.getItem("stream_url")==b.attr("stream_url")?a.stream_url=sessionStorage.getItem("stream_url"):(sessionStorage.setItem("stream_url",b.attr("stream_url")),a.stream_url=b.attr("stream_url")),sessionStorage.getItem("submit_url")&&sessionStorage.getItem("submit_url")==b.attr("submit_url")?a.submit_url=sessionStorage.getItem("submit_url"):(sessionStorage.setItem("submit_url",b.attr("submit_url")),a.submit_url=b.attr("submit_url")),sessionStorage.getItem("error_message")&&sessionStorage.getItem("error_message")==b.attr("submit_url")?a.error_message=sessionStorage.getItem("error_message"):(sessionStorage.setItem("error_message",b.attr("error_message")),a.error_message=b.attr("error_message")),a.barrier=b.attr("barrier"),a.barrier2=b.attr("barrier2"),a.is_immediate=b.attr("is_immediate"),a.is_negative=b.attr("is_negative"),a.is_forward_starting=b.attr("is_forward_starting"),a.trade_feed_delay=b.attr("trade_feed_delay")),a},general_error_message:function(){var a=this.server_data();return a.error_message||"Contract cannot be sold at this time."},show_warning:function(a,b){b&&this.clear_warnings();var c=this.container();$(".sell_price_wrapper",c).hide();var d=$(c.find("#warning_container")[0]),e=$('<p class="comment">'+a+"</p>");d.html(e).show(),e.show()},clear_warnings:function(){var a=$(this.container().find("#warning_container")[0]);a.hide(),$(".message",a).each(function(){$(this).hide().remove()})},sell_button:function(){return $(this.container().find("#sell_at_market")[0])},disable_button:function(a){a.attr("disabled","disabled"),a.fadeTo(0,.5)},enable_button:function(a){a.removeAttr("disabled"),a.fadeTo(0,1)},disable_sell_button:function(a,b){var c=$(a);c.attr("disabled","disabled"),b&&c.hide(),this._sell_button_disabled=!0},enable_sell_button:function(){if(this._sell_button_disabled){$("#sell_contract_form",this.container()).show();var a=this.sell_button();a.removeAttr("disabled"),a.show(),this._sell_button_disabled=!1}},get_loading_html:function(){var a=page.settings.get("image_link");return'<span class="loading">'+text.localize("loading...")+'&nbsp;<img src="'+a.hourglass+'" /></span>'},show_inpage_popup:function(a){var b=this.container(!0);a&&$(".inpage_popup_content",b).html(a);var c=$(document.body);return b.css("position","fixed").css("z-index",get_highest_zindex()+100),c.append(b),b.show(),$("#sell_bet_desc",b).length>0?b.draggable({handle:"#sell_bet_desc"}):b.draggable(),this.reposition_confirmation(),b},reposition_confirmation:function(a,b){var c=this.container(),d=$(window),e=50,f=50;d.width()<767&&(e=0,f=0),void 0===a&&(a=Math.max(Math.floor((d.width()-d.scrollLeft()-c.width())/2),e)+d.scrollLeft()),void 0===b&&(b=Math.min(Math.floor((d.height()-c.height())/2),f)+d.scrollTop()),c.offset({left:a,top:b})},update_price:function(a){var b=this._container;if(!b)throw new Error("container is not available yet");if("object"==typeof a)if("undefined"!=typeof a.price)a=a.price;else if("undefined"!=typeof a.value){var c=this.model.payout();if(isNaN(c))throw new Error("Invalid payout "+c);a=a.value*c}if(isNaN(a))throw new Error("Invalid price structure: "+a);this.update_return(a),a=parseFloat(a).toFixed(2);var d,e=this.model.currency(),f=stylized_price(a),g=$("#sell_price_container",b);if(g.length>0){var h=$(".stylized_price",g);$(".stylized_units",h).html(f.units),$(".stylized_cents",h).html(f.cents),$(".stylized_currency",h).html(e);var i=$('input[name="price"]',g);if(d=i.val(),i.val(a),BetSell.sparkline.update(a),!d)return;a>d?(h.removeClass("price_moved_down"),h.addClass("price_moved_up")):d>a?(h.removeClass("price_moved_up"),h.addClass("price_moved_down")):(h.removeClass("price_moved_up"),h.removeClass("price_moved_down"))}var j=$("#trade_details_price",b);j.length>0&&(d=parseFloat(j.html()),j.html(f.units+""+f.cents),a>d?(j.removeClass("price_moved_down"),j.addClass("price_moved_up")):d>a?(j.removeClass("price_moved_up"),j.addClass("price_moved_down")):(j.removeClass("price_moved_up"),j.removeClass("price_moved_down")))},update_return:function(a){var b=this._container,c=$("#trade_details_return",b);c.length>0&&(a=((a-this.model.purchase_price())/this.model.purchase_price()*100).toFixed(2),c.html(a+"%"))},update_spot:function(a){var b=this._container;if(!b)throw new Error("container is not available yet");var c=$("#now_spot",b);if(c.length>0){var d=parseFloat(c.html());c.html(a),a>d?(c.removeClass("price_moved_down"),c.addClass("price_moved_up")):d>a?(c.removeClass("price_moved_up"),c.addClass("price_moved_down")):(c.removeClass("price_moved_up"),c.removeClass("price_moved_down"))}},update_barriers:function(a){var b=$("#live_barriers");a.barrier&&($("#now_barrier .dir",b).text(a.barrier.dir),$("#now_barrier .diff",b).text(a.barrier.diff)),a.barrier2&&($("#now_barrier2 .dir",b).html(a.barrier2.dir),$("#now_barrier2 .diff",b).text(a.barrier2.diff))},update_high_low:function(a){var b=this._container,c=$("#now_spot",b).html(),d=$("#now_high",b),e=$("#now_low",b),f=!1;d.length>0&&(c=parseFloat(c),c>parseFloat(d.html())&&(d.html(c),f=!0)),e.length>0&&(c=parseFloat(c),c<parseFloat(e.html())&&(e.html(c),f=!0)),(f||a)&&["now","final","eo"].forEach(function(a){var b=$("#"+a+"_high_low_tooltip"),c=$("#"+a+"_high"),d=$("#"+a+"_low");b&&c&&d&&b.attr("title",text.localize("High")+": "+c.html()+" "+text.localize("Low")+": "+d.html())}),$("abbr").css("z-index",get_highest_zindex()+1e3)},resubmit_sell_at_market:function(){var a=this;this.basic_cleanup(),$(".sell_bottom_content").hide(),this.add_overlay(),$("#reload_sell_container").show(),$("#reload_sell_container").on("click","#reload_sell",function(){a.close_container(),f[Object.keys(f).length]=setTimeout(function(){a.sell_at_market(g)},2e3)})},sell_at_market:function(a){var c=this,d=$(a);this.cancel_previous_analyse_request();var e=this.data_attr(a),f=this.get_params(a);b=$.ajax(ajax_loggedin({url:e.url(),type:"POST",async:!0,data:f,success:function(b){var d=c.show_sell_at_market(b),f=c.server_data();$(".tab_menu_container").tabs({load:function(a,b){var d=b.tab.find(".ui-tabs-anchor").attr("load_live_chart");if(d&&1==d){var e=b.tab.find(".ui-tabs-anchor").attr("underlying_symbol"),g=new LiveChartConfig({renderTo:"analysis_live_chart",symbol:e,with_trades:0,shift:0}),i=c.get_time_interval();if(i.is_live&&1===i.is_live)g.update({live:"10min"});else{var j,k;f.is_forward_starting>0?f.trade_feed_delay>0&&(j=c.get_date_from_seconds(i.from_time-parseInt(f.trade_feed_delay)),k=c.get_date_from_seconds(i.to_time+parseInt(f.trade_feed_delay))):(j=c.get_date_from_seconds(i.from_time-5),k=c.get_date_from_seconds(i.to_time));var l=!1;i.to_time-i.from_time<=h&&(l=!0),i.force_tick&&g.update({force_tick:!0}),g.update({interval:{from:j,to:k},with_markers:l})}configure_livechart(),updateLiveChart(g);var m,n=$("#trade_details_purchase_date").attr("epoch_time");n||(f.barrier&&f.barrier2?(g.has_indicator("high")&&live_chart.remove_indicator("high"),m=new LiveChartIndicator.Barrier({name:"high",value:f.barrier,color:"green",label:text.localize("High Barrier")}),live_chart.add_indicator(m),g.has_indicator("low")&&live_chart.remove_indicator("low"),m=new LiveChartIndicator.Barrier({name:"low",value:f.barrier2,color:"red",label:text.localize("Low Barrier")}),live_chart.add_indicator(m)):(g.has_indicator("barrier")&&live_chart.remove_indicator("barrier"),m=new LiveChartIndicator.Barrier({name:"barrier",value:f.barrier,color:"green",label:text.localize("Barrier")}),live_chart.add_indicator(m))),c.add_time_indicators(g)}}}),c.model.currency(e.model.currency()),c.model.shortcode(e.model.shortcode()),c.model.payout(e.model.payout()),c.model.purchase_price(e.model.purchase_price()),c.clear_warnings();var g=d.find("#now_time_container");if(g.length>0){var i=f.stream_url+"/"+e.model.sell_channel();c.streaming.start(i),c.start_now_timer(d,"now_time_container","trade_date_now"),c.create_date_timer(d.find("#trade_details_now_date"));var j=g.attr("duration");parseInt(j)>0&&""!==d.find("#end_time_container").attr("duration")&&(j=parseInt(d.find("#end_time_container").attr("duration"))-parseInt(j),j>0&&c.start_end_timer(d,"end_time_container","now_time_container","trade_date_end",j))}d.find($("#sell_price_container")).length>0&&(c.sparkline.init(55),d.on("click","#sell_at_market",function(b){return b.preventDefault(),c.on_sell_button_click("#sell_at_market",a),!1})),c.update_high_low(!0),c.reposition_confirmation()}})).always(function(){c.enable_button(d)})},start_end_timer:function(a,b,c,d,e){{var f=this,g=a.find("#"+b);a.find("#"+c)}if(g.length>0){var h=f.seconds_to_time(e);h.is_inverse=1;var i=text.localize("year"),j=text.localize("years"),k=text.localize("month"),l=text.localize("months"),m=text.localize("day"),n=text.localize("days"),o=text.localize("hour"),p=text.localize("hours"),q=text.localize("minute"),r=text.localize("minutes"),s=text.localize("second"),t=text.localize("seconds"),u={year:{value:h.year,text:i,text_plural:j,interval:31536e3},month:{value:h.month,text:k,text_plural:l,interval:2592e3},day:{value:h.day,text:m,text_plural:n,interval:86400},hour:{value:h.hour,text:o,text_plural:p,interval:3600},minute:{value:h.minute,text:q,text_plural:r,interval:60},second:{value:h.second,text:s,text_plural:t,interval:1},is_inverse:h.is_inverse};
f.create_timer(a.find("#"+d),u)}},start_now_timer:function(a,b,c){var d=this,e=a.find("#"+b);if(e.length>0){var f=d.seconds_to_time(e.attr("duration")),g=text.localize("year"),h=text.localize("years"),i=text.localize("month"),j=text.localize("months"),k=text.localize("day"),l=text.localize("days"),m=text.localize("hour"),n=text.localize("hours"),o=text.localize("minute"),p=text.localize("minutes"),q=text.localize("second"),r=text.localize("seconds"),s={year:{value:f.year,text:g,text_plural:h,interval:31536e3},month:{value:f.month,text:i,text_plural:j,interval:2592e3},day:{value:f.day,text:k,text_plural:l,interval:86400},hour:{value:f.hour,text:m,text_plural:n,interval:3600},minute:{value:f.minute,text:o,text_plural:p,interval:60},second:{value:f.second,text:q,text_plural:r,interval:1},is_negative:f.is_negative};d.create_timer(a.find("#"+c),s)}},get_params:function(a){var b=[];if(!a)return"";for(var c=a.attributes,d=0,e=0;e<c.length;e++)"class"!=c[e].name&&"onclick"!=c[e].name&&(b[d]=c[e].name+"="+encodeURIComponent(c[e].value),d++);return b.join("&")},show_sell_at_market:function(a){return this.show_inpage_popup('<div class="inpage_popup_content_box">'+a+"</div>")},on_sell_button_click:function(a,b){this.disable_sell_button(a,!0),this.streaming.stop(),this.model.reload_page_on_close(!0),this.show_loading(),this.sell_bet(b)},cancel_previous_sell_request:function(){a&&a.abort()},cancel_previous_analyse_request:function(){b&&b.abort()},show_loading:function(){var a=this.container(),b=$(a.find(".sell_info")[0]),c=this.get_loading_html();c=$(c),c.show(),b.append(c)},hide_loading:function(){var a=this.container();a.find(".loading").each(function(){$(this).hide().remove()})},sell_bet:function(b){var c=this,d=6e4,e=(this.data_attr(b),this.get_params(b)+"&ajax_only=1");e+="&price="+$('input[name="price"]',$("#sell_price_container")).val(),this.cancel_previous_sell_request();var f=this.server_data().submit_url;a=$.ajax(ajax_loggedin({url:f,type:"POST",async:!0,data:e,timeout:d,success:function(a,b,d){c.on_sell_bet_success(a,b,d)},error:function(a,b,d){c.on_sell_bet_error(a,b,d)}}))},on_sell_bet_success:function(a){var b={};if(b="object"==typeof a?a:JSON&&JSON.parse(a)||$.parseJSON(a)||{},this.hide_loading(),b.redirect)return void(window.location.href=b.redirect);if(b.error)this.show_warning(b.error,!0);else{if(!b.display)throw new Error("Invalid server response: "+b);this.clear_warnings(),this.show_inpage_popup(b.display)}},on_sell_bet_error:function(a,b,c){this.hide_loading();var d=""+c;a.responseText?d+=a.responseText:!document.location.href.match(/^http:/)||d&&!d.match(/access/i)||(d+='<p>Please <a href="'+document.location.href.replace("http://","https://")+'">continue browsing using HTTPS secure protocol</a></p>'),this.show_warning(d,!0)},register:function(){var a=this;$("#profit-table, #portfolio-table, #bet_container, #statement-table, #trading_socket_container").on("click",".open_contract_details",function(b){var c=$(this);return b.preventDefault(),g=this,a.disable_button(c),a.data_attr(this).model.tick_expiry()?a.only_show_chart(this):a.data_attr(this).model.spread_bet()?a.show_buy_sell(this):a.sell_at_market(this),a.enable_button(c),!1})},show_buy_sell:function(a){var c=this,d=$(a);this.cancel_previous_analyse_request();var e=this.data_attr(a),f=this.get_params(a);b=$.ajax(ajax_loggedin({url:e.url(),type:"POST",async:!0,data:f,success:function(a){var b=c.show_spread_popup(a),d=b.find("#status").text();"Open"===d&&BetPrice.spread.stream(e.model.sell_channel())}})).always(function(){c.enable_button(d)})},show_spread_popup:function(a){var b=this,c=b.container(!0);c.addClass("spread_popup"),a='<div class="inpage_popup_content_box">'+a+"</div>",a&&$(".inpage_popup_content",c).html(a);var d=$(document.body);return c.css("position","fixed").css("z-index",get_highest_zindex()+100),d.append(c),c.show(),$("#sell_bet_desc",c).length>0?c.draggable({handle:"#sell_bet_desc"}):c.draggable(),this.reposition_confirmation(),c},only_show_chart:function(a){var c=this,d=c.data_attr(a),e=c.get_params(a);b=$.ajax(ajax_loggedin({url:d.url(),type:"POST",async:!0,data:e,success:function(a){var b=a;c.show_inpage_popup('<div class="inpage_popup_content_box"><div class="popup_bet_desc drag-handle">'+b.longcode+'</div><div id="tick_chart"></div></div>'),TickDisplay.initialize(b)}})).always(function(){c.enable_button($(a))})},data_attr:function(a){var b=$(a);return{selector:b,url:function(){return b.attr("url")},model:{shortcode:function(){return b.attr("shortcode")},currency:function(){return b.attr("currency")},purchase_price:function(){return b.attr("purchase_price")},payout:function(){return b.attr("payout")},sell_channel:function(){return b.attr("sell_channel")},controller_action:function(){return b.attr("controller_action")},tick_expiry:function(){return b.attr("tick_expiry")||0},spread_bet:function(){return b.attr("spread_bet")||0},is_expired:function(){return b.attr("is_expired")||0}}}},streaming:function(){var a=!1;return{start:function(b){if(BetSell.sparkline.clear(),this.stop(),b&&(this._url=b),a=!0,b=this._url,b&&"undefined"!=typeof EventSource){this._stream=new EventSource(b,{retry:18e6});var c=this;return this._stream.onmessage=function(a){c.process_message(a.data)},this._stream.addEventListener("ping",function(){return!0}),!0}var d="We are not able to stream live prices at the moment. To enjoy live streaming of prices try refreshing the page, if you get this issue after repeated attempts try a different browser";return BetSell.show_warning(d),$("#spot_spark").html('<span title="'+d+'">No Live price update</span>"'),!1},stop:function(){this._stream&&(this._stream.close(),this._stream=null)},ignore_updates:function(){a=!1},process_message:function(b){if(a){var c=JSON.parse(b);this.update_price(c)}},update_price:function(a){for(var b=a.prices,c=a.spot,d=0;d<b.length;d++)b[d]&&"sell"==b[d].id&&(b[d].err?(BetSell.show_warning(b[d].err,!0),BetSell.disable_sell_button("#sell_at_market",!0),no_error=!1):(BetSell.clear_warnings(),BetSell.enable_sell_button()),BetSell.update_price(b[d]),BetSell.update_barriers(a.barriers));BetSell.update_spot(c)},url:function(a){return void 0!==a?(this._url=a,this):this._url}}}(),sparkline:function(){var a=[],b=30;return{init:function(c){a=[],c&&(b=c);var d=$(BetSell.container().find("#sell_price_container")[0]);$("#sell_price_sparkline").remove();var e=$('<div id="sell_price_sparkline"></div>');d.append(e),e.show(),$("#sell_price_container").on("mouseover","#sell_price_sparkline canvas",function(){$("#jqstooltip").css("z-index",get_highest_zindex()+100)})},update:function(c){var d=this;a.push(c),a.length>=b&&a.shift(),$("#sell_price_sparkline").sparkline(a,d._config)},clear:function(){var b=this;a=[],$("#sell_price_sparkline").sparkline(a,b._config)},_config:{type:"line",lineColor:"#606060",fillColor:!1,spotColor:"#00f000",minSpotColor:"#f00000",maxSpotColor:"#0000f0",highlightSpotColor:"#ffff00",highlightLineColor:"#000000",spotRadius:1.25}}}(),create_timer:function(a,b){var c={},d=1,f=this;b.year&&b.year.value>0&&(c.year=b.year.value,d=b.year.interval),b.month&&b.month.value>0&&(c.month=b.month.value,d=b.month.interval),b.day&&b.day.value>0&&(c.day=b.day.value,d=b.day.interval),b.hour&&b.hour.value>0&&(c.hour=b.hour.value,d=b.hour.interval),b.minute&&b.minute.value>0&&(c.minute=b.minute.value,d=b.minute.interval),b.second&&b.second.value>0&&(c.second=b.second.value,d=b.second.interval);var g=moment.duration(c);e[Object.keys(e).length]=setInterval(function h(){var c,e=0;b.is_negative?(c="- ",g=moment.duration(g.asSeconds()-d,"seconds")):b.is_inverse?(c="",g=moment.duration(g.asSeconds()-d,"seconds")):(c="",g=moment.duration(g.asSeconds()+d,"seconds"));var i=Math.floor(g.asDays());return 1==i&&2>e?(c+=i+" "+b.day.text+" ",e++):i>1&&2>e&&(c+=i+" "+b.day.text_plural+" ",e++),1==g.hours()&&2>e?(c+=g.hours()+" "+b.hour.text+" ",e++):g.hours()>1&&2>e&&(c+=g.hours()+" "+b.hour.text_plural+" ",e++),1==g.minutes()&&2>e?(c+=g.minutes()+" "+b.minute.text+" ",e++):g.minutes()>1&&2>e&&(c+=g.minutes()+" "+b.minute.text_plural+" ",e++),1==g.seconds()&&2>e?(c+=g.seconds()+" "+b.second.text,e++):g.seconds()>1&&2>e?(c+=g.seconds()+" "+b.second.text_plural,e++):0===g.seconds()&&1>e&&(c+=g.seconds()+" "+b.second.text,e++),0===e?f.resubmit_sell_at_market():0===i&&0===g.hours()&&0===g.minutes()&&0===g.seconds()?(a.html(c),f.resubmit_sell_at_market()):a.html(c),h}(),1e3*Math.abs(d))},create_date_timer:function(a){var b=1,c=this,d=parseInt(a.attr("epoch_time"))+1;e[Object.keys(e).length]=setInterval(function f(){d+=b;var e=c.get_date_from_seconds(d),g=moment.utc(e).format("YYYY-MM-DD HH:mm:ss");return a.attr("epoch_time",d),a.html(g),f},1e3*Math.abs(b))},seconds_to_time:function(a){var b,c,d=moment.duration(Math.abs(parseInt(a)),"seconds");d.asDays()>365?(b=d.days(),c=d.months()):(b=Math.floor(d.asDays()),c=0);var e={year:d.years(),month:c,day:b,hour:d.hours(),minute:d.minutes(),second:d.seconds()};return e.is_negative=parseInt(a)<0?1:0,e},get_date_from_seconds:function(a){var b=new Date(1e3*a);return b},get_time_interval:function(){var a={},b=$("#trade_details_start_date").attr("epoch_time"),c=$("#trade_details_purchase_date").attr("epoch_time"),d=$("#trade_details_now_date").attr("epoch_time"),e=$("#trade_details_end_date").attr("epoch_time");return c?(a.from_time=parseInt(c),a.to_time=parseInt(b)):b&&d?d>b&&(parseInt(e)-parseInt(b)>3600&&parseInt(d)-parseInt(b)<3600?(a.from_time=parseInt(b),a.to_time=parseInt(b)+3595):parseInt(e)-parseInt(b)===3600?(a.from_time=parseInt(b),a.to_time=parseInt(e),a.force_tick=1):(a.from_time=parseInt(b),a.to_time=parseInt(e))):!d&&b&&e?(a.from_time=parseInt(b),a.to_time=parseInt(e)):a.is_live=1,a},add_time_indicators:function(a){var b,c=this,d=$("#trade_details_start_date").attr("epoch_time"),e=$("#trade_details_purchase_date").attr("epoch_time"),f=$("#trade_details_sold_date").attr("epoch_time"),g=$("#trade_details_end_date").attr("epoch_time"),h=$("#trade_details_entry_spot_time").attr("epoch_time");e&&(a.has_indicator("purchase_time")&&live_chart.remove_indicator("purchase_time"),b=new LiveChartIndicator.Barrier({name:"purchase_time",label:"Purchase Time",value:c.get_date_from_seconds(parseInt(e)),color:"#e98024",axis:"x"}),live_chart.add_indicator(b)),d&&(a.has_indicator("start_time")&&live_chart.remove_indicator("start_time"),b=new LiveChartIndicator.Barrier({name:"start_time",label:"Start Time",value:c.get_date_from_seconds(parseInt(d)),color:"#e98024",axis:"x"}),live_chart.add_indicator(b)),h&&h!=d&&(a.has_indicator("entry_spot_time")&&live_chart.remove_indicator("entry_spot_time"),b=new LiveChartIndicator.Barrier(d&&d>h?{name:"entry_spot_time",label:"Entry Spot",value:c.get_date_from_seconds(parseInt(h)),color:"#e98024",axis:"x"}:{name:"entry_spot_time",label:"Entry Spot",value:c.get_date_from_seconds(parseInt(h)),color:"#e98024",axis:"x",nomargin:!0}),live_chart.add_indicator(b)),g&&(a.has_indicator("end_time")&&live_chart.remove_indicator("end_time"),b=new LiveChartIndicator.Barrier({name:"end_time",label:"End Time",value:c.get_date_from_seconds(parseInt(g)),color:"#e98024",axis:"x"}),live_chart.add_indicator(b)),f&&(a.has_indicator("sold_time")&&live_chart.remove_indicator("sold_time"),b=new LiveChartIndicator.Barrier({name:"sold_time",label:"Sell Time",value:c.get_date_from_seconds(parseInt(f)),color:"#e98024",axis:"x"}),live_chart.add_indicator(b))},add_overlay:function(){var a=$("#overlay-wrapper");a.show(),a.css({height:$("#sell_content_container").outerHeight(!0)+"px",top:$("#sell_bet_desc").outerHeight()+"px"})}}}(),PricingDetails=function(){return{register:function(){this.popup().length>0&&(this.on_open_debug_link(),this.on_close())},on_open_debug_link:function(){var a=this;$("a.pricing-details").on("click",function(b){var c=a.popup();$(".draggable").draggable(),c.toggleClass("invisible"),$("#"+c.children(":first").attr("id")).tabs(),b.preventDefault()}).addClass("unbind_later")},on_close:function(){var a=this;$("a.pricing-details-close").on("click",function(b){a.popup().addClass("invisible"),b.preventDefault()}).addClass("unbind_later")},popup:function(){return $("#pricing_details_popup")}}}(),TickDisplay=function(){return{reset:function(){var a=this;a.contract_barrier=null,a.applicable_ticks=[],a.number_of_ticks=null,a.ev.close(),a.chart.destroy()},initialize:function(a){var b=this;b.number_of_ticks=parseInt(a.number_of_ticks),b.symbol=a.symbol,b.display_symbol=a.display_symbol,b.contract_start_ms=parseInt(1e3*a.contract_start),b.contract_category=a.contract_category,b.set_barrier=b.contract_category.match("digits")?!1:!0,b.display_decimal=0;var c=5;"undefined"!=typeof a.decimal&&(b.number_of_decimal=parseInt(a.decimal)+1),a.show_contract_result&&(b.show_contract_result=!0,b.contract_sentiment=a.contract_sentiment,b.price=parseFloat(a.price),b.payout=parseFloat(a.payout));var d=a.show_contract_result;b.set_x_indicators(),b.initialize_chart({plot_from:1e3*a.previous_tick_epoch,plot_to:new Date(1e3*(parseInt(a.contract_start)+parseInt((b.number_of_ticks+2)*c))).getTime(),minimize:d})},set_x_indicators:function(){var a=this,b=a.number_of_ticks-1;a.contract_category.match("asian")?(a.ticks_needed=a.number_of_ticks,a.x_indicators={_0:{label:"Tick 1",id:"start_tick"}},a.x_indicators["_"+b]={label:"Exit Spot",id:"exit_tick"}):a.contract_category.match("callput")?(a.ticks_needed=a.number_of_ticks+1,a.x_indicators={_0:{label:"Entry Spot",id:"entry_tick"}},a.x_indicators["_"+a.number_of_ticks]={label:"Exit Spot",id:"exit_tick"}):a.contract_category.match("digits")?(a.ticks_needed=a.number_of_ticks,a.x_indicators={_0:{label:"Tick 1",id:"start_tick"}},a.x_indicators["_"+b]={label:"Tick "+a.number_of_ticks,id:"last_tick"}):a.x_indicators={}},initialize_chart:function(a){var b=this;b.chart=new Highcharts.Chart({chart:{type:"line",renderTo:"tick_chart",width:a.minimize?394:null,height:a.minimize?143:null,backgroundColor:null,events:{load:b.plot(a.plot_from,a.plot_to)}},credits:{enabled:!1},tooltip:{formatter:function(){var a=this,c=a.y.toString().split(".")[1].length,d=Math.max(b.display_decimal,c);b.display_decimal=d;var e=a.y.toFixed(d),f=moment.utc(1e3*b.applicable_ticks[a.x].epoch).format("dddd, MMM D, HH:mm:ss");return f+"<br/>"+b.display_symbol+" "+e}},xAxis:{type:"linear",min:0,max:b.number_of_ticks+1,labels:{enabled:!1}},yAxis:{opposite:!1,labels:{align:"left",x:0},title:""},series:[{data:[]}],title:"",exporting:{enabled:!1,enableImages:!1},legend:{enabled:!1}})},plot:function(a,b){var c=this,d=moment(a).utc(),e=moment(b).utc(),f=moment(c.contract_start_ms).utc();c.counter=0,c.applicable_ticks=[];var g=c.symbol,h=window.location.protocol+"//"+page.settings.get("streaming_server");h+="/stream/ticks/"+g+"/"+d.unix()+"/"+e.unix(),c.ev=new EventSource(h,{withCredentials:!0}),c.ev.onmessage=function(a){if(c.applicable_ticks.length>=c.ticks_needed)return c.ev.close(),void c.evaluate_contract_outcome();var b=JSON.parse(a.data);if(!b||b[0]instanceof Array||(b=[b]),b)for(var d=0;d<b.length;d++)if("tick"===b[d][0]){var e={epoch:parseInt(b[d][1]),quote:parseFloat(b[d][2])};if(e.epoch>f.unix()){if(c.applicable_ticks.length>=c.ticks_needed)return c.ev.close(),void c.evaluate_contract_outcome();if(!c.chart)return;if(!c.chart.series)return;c.chart.series[0].addPoint([c.counter,e.quote],!0,!1),c.applicable_ticks.push(e);var g="_"+c.counter;"undefined"!=typeof c.x_indicators[g]&&(c.x_indicators[g].index=c.counter,c.add(c.x_indicators[g])),c.add_barrier(),c.apply_chart_background_color(e),c.counter++}}},c.ev.onerror=function(){c.ev.close()}},apply_chart_background_color:function(a){var b=this,c=$("#tick_chart");"up"===b.contract_sentiment?a.quote>b.contract_barrier?c.css("background-color","rgba(46,136,54,0.198039)"):c.css("background-color","rgba(204,0,0,0.098039)"):"down"===b.contract_sentiment&&(a.quote<b.contract_barrier?c.css("background-color","rgba(46,136,54,0.198039)"):c.css("background-color","rgba(204,0,0,0.098039)"))},add_barrier:function(){var a=this;if(a.set_barrier){var b=a.contract_category.match("asian")?"asian":"static";if("static"===b){var c=a.applicable_ticks[0];a.chart.yAxis[0].addPlotLine({id:"tick-barrier",value:c.quote,label:{text:"Barrier ("+c.quote+")",align:"center"},color:"green",width:2}),a.contract_barrier=c.quote,a.set_barrier=!1}if("asian"===b){for(var d=0,e=0;e<a.applicable_ticks.length;e++)d+=parseFloat(a.applicable_ticks[e].quote);var f=d/a.applicable_ticks.length;f=f.toFixed(a.number_of_decimal),a.chart.yAxis[0].removePlotLine("tick-barrier"),a.chart.yAxis[0].addPlotLine({id:"tick-barrier",value:f,color:"green",label:{text:"Average ("+f+")",align:"center"},width:2}),a.contract_barrier=f}}},add:function(a){var b=this;b.chart.xAxis[0].addPlotLine({value:a.index,id:a.id,label:{text:a.label},color:"#e98024",width:2})},evaluate_contract_outcome:function(){var a=this;if(a.contract_barrier){var b=a.applicable_ticks.length-1,c=a.applicable_ticks[b].quote;"up"===a.contract_sentiment?c>a.contract_barrier?a.win():a.lose():"down"===a.contract_sentiment&&(c<a.contract_barrier?a.win():a.lose())}},win:function(){var a=this,b=a.payout-a.price;a.update_ui(a.payout,b,text.localize("This contract won"))},lose:function(){var a=this;a.update_ui(0,-a.price,text.localize("This contract lost"))},update_ui:function(a,b,c){var d=this;$("#bet-confirm-header").text(text.localize(c)),$("#contract-outcome-buyprice").text(d.to_monetary_format(d.price)),$("#contract-outcome-payout").text(d.to_monetary_format(a)),b>0?($("#contract-outcome-label").removeClass("standin loss").addClass("standout profit").text(text.localize("Profit")),$("#contract-outcome-profit").removeClass("standin loss").addClass("standout profit").text(d.to_monetary_format(b))):($("#contract-outcome-label").removeClass("standout profit").addClass("standin loss").text(text.localize("Loss")),$("#contract-outcome-profit").removeClass("standout profit").addClass("standin loss").text(d.to_monetary_format(b))),$("#confirmation_table").hide(),$("#contract-outcome-details").show()},to_monetary_format:function(a){return a.toFixed(2)}}}(),rearrange_compare_underlying_list=function(){var a=$("#instrument-content");a.find("input").removeAttr("disabled");var b=$("#chart_compare_underlying").find("li");1==b.length&&$("#instrument-content").find("input:checked").attr("disabled",!0),b.each(function(b){var c=$(this),d=a.find("#s_"+c.find("input[type=checkbox]").val().replace(/-$/,""));c.removeClass().addClass("line_"+(b+1)),0===b&&d.attr("checked","checked")})},check_input_error=function(a){var b=!0;return a.find(".errorfield").remove().end().find("input[type=text]").each(function(){var a;return this.value.toString().match(/^\d+\.?\d*$/)?this.value<=0&&(a=lightchart_text.error_nonzero):a=lightchart_text.error_digitonly,a?(a=a.replace(/\{\d+:INPUT\}/,this.previousSibling.innerHTML),$(this).after('<div class="errorfield">'+a+"</div>"),b=!1):void 0}).end().siblings().find("input[type=text]").each(function(){this.value.toString().match(/^\d+\.?\d*$/)||$(this).remove()}),b},draw_chart=function(a){var b=document.getElementById("chart_director_imageholder");if(null!==b){var c=$("#chart_compare_underlying").find("li");1==c.length&&$("#instrument-content").find("input:checked").attr("disabled",!0);var d=(parseInt(8989898*Math.random(),10),$("#form_chart_director")),e=d.attr("action")+"&"+d.serialize()+"&cache="+parseInt(8989898*Math.random(),10)+"&current_width="+get_container_width(),f=e.replace("print_chart","getticker");$("#ticker").load(f);var g=new Image;showLoadingImage($("#chart_director_imageholder")),g.src=e,g.complete?(b.innerHTML="",b.appendChild(g),"function"==typeof a&&a()):(g.onerror=function(){b.innerHTML="<p>Chart couldn't be loaded. </p>"},g.onload=function(){b.innerHTML="",b.appendChild(g),this.onload=null,"function"==typeof a&&a()})}};onLoad.queue_for_url(function(){listen_to_chart_element()},"smartchart");var load_chart_app=function(){var a=/Mac/i.test(navigator.platform),b=/iPhone|iPad|iPod/i.test(navigator.userAgent),c=/Android/i.test(navigator.userAgent),d=/Windows Phone/i.test(navigator.userAgent),e=navigator.javaEnabled(),f=b||c||d,g=!e&&!f;$("#install-java").toggle(g),$("#download-app").toggle(e),$("#download-app").on("click",function(){return a?void alert("You need to change your security preferences!"):void(f&&alert("The charting app is not available on mobile devices!"))})},client_form;onLoad.queue(function(){client_form=new ClientForm({valid_loginids:page.settings.get("valid_loginids")})});var select_user_country=function(){if($("#residence").length>0){var a=$("#residence").val(),b=page.settings.get("countries_list");a.length>0?("none"==b[a].gaming_company&&"none"==b[a].financial_company&&(a=""),$("#residence").val(a).change()):$.ajax({crossDomain:!0,url:page.url.url_for("country"),async:!0,dataType:"json"}).done(function(c){a=c.country,"none"==b[a].gaming_company&&"none"==b[a].financial_company&&(a=""),$("#residence").val(a).change()})}},disable_residence=function(){var a=page.client.residence;a.length>0&&a==$("#residence").val()&&$("#residence").attr("disabled",!0)},enable_residence_form_submit=function(){$("form#openAccForm").submit(function(){var a=!1;$("form#openAccForm").find("p.errorfield:visible").each(function(){return $(this).text().length>0?(a=!0,!1):void 0}),a||$("#residence").removeAttr("disabled")})};pjax_config_page("new_account/real",function(){return{onLoad:function(){client_form.on_residence_change(),select_user_country(),disable_residence(),enable_residence_form_submit(),page.client.is_logged_in&&client_form.set_virtual_email_id(page.client.email)}}});var upgrade_investment_disabled_field=function(){if(page.client.is_real){var a=["mrms","fname","lname","dobdd","dobmm","dobyy","residence","secretquestion","secretanswer"];a.forEach(function(a){var b=$("#"+a);b.length>0&&$("#"+a).attr("disabled",!0)})}else $("#residence").attr("disabled",!0)},financial_enable_fields_form_submit=function(){$("form#openAccForm").submit(function(){var a=!1;if($("form#openAccForm").find("p.errorfield:visible").each(function(){return $(this).text().length>0?(a=!0,!1):void 0}),!a)if(page.client.is_real){var b=["mrms","fname","lname","dobdd","dobmm","dobyy","residence","secretquestion","secretanswer"];b.forEach(function(a){var b=$("#"+a);b.length>0&&b.removeAttr("disabled")})}else $("#residence").removeAttr("disabled")})},hide_account_opening_for_risk_disclaimer=function(){var a=$("#risk_disclaimer_section");a.length>0&&$(".formObject fieldset").not("#risk_disclaimer_section").hide()};pjax_config_page("new_account/maltainvest",function(){return{onLoad:function(){page.client.is_real||(client_form.on_residence_change(),select_user_country()),upgrade_investment_disabled_field(),financial_enable_fields_form_submit(),hide_account_opening_for_risk_disclaimer()}}}),pjax_config_page("user/assessment",function(){return{onLoad:function(){hide_account_opening_for_risk_disclaimer()}}});var ClientForm=function(a){this.valid_loginids=new RegExp(a.valid_loginids)};ClientForm.prototype={validate_post_code:function(){var a=$("select[name=residence]").val(),b=$("input[name=AddressPostcode]").val();return"gb"!=a||b.length?!0:!1},validate_DOB:function(){var a=$("select#dobdd").val(),b=$("select#dobmm").val();b=parseInt(b)-1;var c=$("select#dobyy").val(),d=new Date(c,b,a);return d.getDate()!=a||d.getMonth()!=b||d.getFullYear()!=c?!1:!0},compare_new_password:function(a,b){return a.length>0&&b.length>0&&a!=b?!1:!0},is_allowed_opening_account_country:function(a){var b=clearInputErrorField("errorresidence"),c=page.settings.get("countries_list")[a];return"none"==c.gaming_company&&"none"==c.financial_company?(b.innerHTML=text.localize("We are not accepting accounts from residents of this country at the present time."),!1):(b.innerHTML="",!0)},tnc_accepted:function(){var a=document.getElementById("tnc"),b=clearInputErrorField("errortnc");return a&&b&&a.checked===!1?(b.innerHTML=text.localize("You must accept the terms and conditions to open an account."),!1):!0},check_ip:function(a){var b=/^(\d{1,3})\.(\d{1,3})\.(\d{1,3})\.(\d{1,3})$/,c=a.match(b);if(c)for(i=0;i<c.length;i++)if(c[i]>255)return!1;return!0},fixLoginID:function(){var a=$("#LoginForm_loginID"),b=a.val();b=b.toUpperCase(),b=b.replace(/\\s/g,""),a.val(b)},is_loginid_valid:function(a){return a.length>0?(a=a.toUpperCase(),this.valid_loginids.test(a)):!0},self_exclusion:function(){return{has_something_to_save:function(a){var b,c,d=["MAXCASHBAL","MAXOPENPOS","DAILYTURNOVERLIMIT","DAILYLOSSLIMIT","7DAYTURNOVERLIMIT","7DAYLOSSLIMIT","SESSIONDURATION","EXCLUDEUNTIL"];for(c=0;c<d.length;c++)if(b=document.getElementById(d[c])){if(b.value=b.value.replace(/^\s*/,"").replace(/\s*$/,""),b.value==(void 0===a[d[c]]?"":a[d[c]]))continue;return!0}return!1},validate_exclusion_date:function(){var a=$("#EXCLUDEUNTIL").val();if(a){var b=clearInputErrorField("errorEXCLUDEUNTIL");a=new Date(a);var c=new Date;return c.setMonth(c.getMonth()+6),c>a?(b.innerHTML=text.localize("Please enter a date that is at least 6 months from now."),!1):confirm(text.localize("When you click 'Ok' you will be excluded from trading on the site until the selected date."))===!0?!0:!1}return!0}}}(),set_idd_for_residence:function(a){var b=$("#Tel");if(!b.val()||b.val().length<6){var c=idd_codes[a];b.val(c?"+"+c:"")}},on_residence_change:function(){var a=this;$("#residence").on("change",function(){a.set_idd_for_residence($(this).val());var b=$("#AddressState"),c=b.length>0?b.val():"",d=$("label[for=AddressPostcode]");"gb"==$(this).val()?d.prepend('<em class="required_asterisk">* </em>'):d.find("em").remove(),a.is_allowed_opening_account_country($(this).val())?$.ajax({crossDomain:!0,url:page.url.url_for("states_list"),data:{c:$("#residence").get(0).value,l:page.language()},async:!0,dataType:"html"}).done(function(b){$("#AddressState").html(b),a.hide_state_list_if_empty(c)}):$("#AddressState").parents(".row").first().hide()})},hide_state_list_if_empty:function(a){var b=$("#AddressState");b.children().size()>2?(b.parents(".row").first().show(),b.val(a)):b.parents(".row").first().hide()},set_virtual_email_id:function(a){$("#Email").val(a),$("#Email").disableSelection()}};var sidebar_scroll=function(a){if(a.on("click","#sidebar-nav li",function(){var a=$(this);return $.scrollTo($(".section:eq("+a.index()+")"),500),!1}).addClass("unbind_later"),a.size()){var b=a.find(".sidebar"),c=b.width(),d=b.offset().top,e=function(){var a=$(window).scrollTop();b.css(a>d?{position:"fixed",top:0,width:c}:{position:"relative"})};e();var f=b.find("#sidebar-nav"),g=a.find(".section").length;$(window).on("scroll",function(){e();for(var a=0;g>a;a++)(0===$(window).scrollTop()||$(this).scrollTop()>=$(".section:eq("+a+")").offset().top-5)&&(f.find("li").removeClass("selected"),0===$(window).scrollTop()?f.find("li:first-child").addClass("selected"):$(window).scrollTop()+$(window).height()>=$(document).height()?f.find("li:last-child").addClass("selected"):f.find("li:eq("+a+")").addClass("selected"))})}},get_started_behaviour=function(){var a,b,c=function(a){var b,c=$(".subsection");c.addClass("hidden"),a.removeClass("hidden");var d=$(".subsection-navigation .back"),e=$(".subsection-navigation .next");return a.hasClass("first")?(d.addClass("disabled"),e.removeClass("disabled")):a.hasClass("last")?(d.removeClass("disabled"),e.addClass("disabled")):(d.removeClass("disabled"),e.removeClass("disabled")),b=a.find("a[name]").attr("name").slice(0,-8),document.location.hash=b,!1},d=$(".get-started").find(".subsection-navigation"),e=d.length;e&&(d.on("click","a",function(){var a=$(this);if(a.hasClass("disabled"))return!1;var b=$(".subsection:not(.hidden)"),d=a.hasClass("next")?b.next(".subsection"):b.prev(".subsection");return c(d)}),b=location.href.split("#")[1],a=b?$("a[name="+b+"-section]").parent(".subsection"):$(".subsection.first"),c(a));var f=$(".random-markets");f.length>0&&sidebar_scroll(f)},get_ticker=function(){var a=$("#hometicker");a.size()&&$.ajax({crossDomain:!0,url:page.url.url_for("ticker"),async:!0,dataType:"html"}).done(function(b){a.html(b),a.find("ul").simplyScroll()})},Charts=function(a){window.open(a,"DetWin","width=580,height=710,scrollbars=yes,location=no,status=no,menubar=no")},email_rot13=function(a){return a.replace(/[a-zA-Z]/g,function(a){return String.fromCharCode(("Z">=a?90:122)>=(a=a.charCodeAt(0)+13)?a:a-26)})},display_cs_contacts=function(){$(".contact-content").on("change","#cs_telephone_number",function(){var a=$(this).val();$("#display_cs_telephone").text(a)}),$("#cs_contact_eaddress").html(email_rot13('<n uers="znvygb:fhccbeg@ovanel.pbz" ery="absbyybj">fhccbeg@ovanel.pbz</n>'))},change_chat_icon=function(){var a=$("#live-chat-icon").length;if(a>0){var b=null,c=function(){var a=page.settings.get("image_link"),c=$(".a-desk-widget"),d=c.css("background-image");d&&(c.css({"background-image":'url("'+a.livechaticon+'")',"background-size":"contain","min-width":50,"min-height":50,width:"auto"}),c.hover(function(){$(this).css({background:'url("'+a.livechaticon+'") no-repeat scroll 0 0',"background-size":"contain"})}),d.match(/live-chat-icon/g)&&clearInterval(b))};b=setInterval(c,500)}},render_desk_widget=function(){new DESK.Widget({version:1,site:"binary.desk.com",port:"80",type:"chat",id:"live-chat-icon",displayMode:0,features:{offerAlways:!0,offerAgentsOnline:!1,offerRoutingAgentsAvailable:!1,offerEmailIfChatUnavailable:!1},fields:{ticket:{},interaction:{},chat:{},customer:{}}}).render()},show_live_chat_icon=function(){"undefined"==typeof DESK&&(loadCSS("https://d3jyn100am7dxp.cloudfront.net/assets/widget_embed_191.cssgz?1367387331"),loadJS("https://d3jyn100am7dxp.cloudfront.net/assets/widget_embed_libraries_191.jsgz?1367387332"));var a=setInterval(function(){"undefined"!=typeof DESK&&(render_desk_widget(),change_chat_icon(),clearInterval(a))},80)},display_career_email=function(){$("#hr_contact_eaddress").html(email_rot13('<n uers="znvygb:ue@ovanel.pbz" ery="absbyybj">ue@ovanel.pbz</n>'))},get_residence_list=function(){var a=page.url.url_for("residence_list");$.getJSON(a,function(a){var b=[];$.each(a.residence,function(a,c){var d="",e="";c.disabled?d=" disabled ":c.selected&&(e=' selected="selected" '),b.push('<option value="'+c.value+'"'+d+e+">"+c.text+"</option>"),$("#residence").html(b.join("")),$("form#virtual-acc-form #btn_registration").removeAttr("disabled")})})},on_input_password=function(){$("#chooseapassword").on("input",function(){$("#chooseapassword_2").css("visibility","visible")})},on_click_signup=function(){$("form#virtual-acc-form #btn_registration").on("click",function(){var a=$("#chooseapassword").val(),b=$("#chooseapassword_2").val(),c=$("#Email").val(),d=$("#residence").val(),e="";return/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,4}$/.test(c)?a.length<6||a.length>25||b.length<6||b.length>25?e=text.localize("Password length should be between 6 and 25 characters"):0!==a.length&&0!==b.length&&client_form.compare_new_password(a,b)?c==a?e=text.localize("Your password cannot be the same as your email"):0===d.length&&(e=text.localize("Please specify your country.")):e=text.localize("The two passwords that you entered do not match."):e=text.localize("Invalid email address"),e.length>0?($("#signup_error").text(e),$("#signup_error").removeClass("invisible"),$("#signup_error").show(),!1):void $("#virtual-acc-form").submit()})};pjax_config_page("/$|/home",function(){return{onLoad:function(){on_input_password(),on_click_signup(),get_residence_list(),get_ticker()}}}),pjax_config_page("/why-us",function(){return{onLoad:function(){var a=$(".why-us");sidebar_scroll(a)},onUnload:function(){$(window).off("scroll")}}}),pjax_config_page("/smart-indices",function(){return{onLoad:function(){sidebar_scroll($(".smart-indices"))},onUnload:function(){$(window).off("scroll")}}}),pjax_config_page("/open-source-projects",function(){return{onLoad:function(){sidebar_scroll($(".open-source-projects"))},onUnload:function(){$(window).off("scroll")}}}),pjax_config_page("/white-labels",function(){return{onLoad:function(){sidebar_scroll($(".white-labels"))
},onUnload:function(){$(window).off("scroll")}}}),pjax_config_page("/payment-agent",function(){return{onLoad:function(){sidebar_scroll($(".payment-agent"))},onUnload:function(){$(window).off("scroll")}}}),pjax_config_page("/get-started",function(){return{onLoad:function(){get_started_behaviour()},onUnload:function(){$(window).off("scroll")}}}),pjax_config_page("/contact",function(){return{onLoad:function(){display_cs_contacts(),show_live_chat_icon()}}}),pjax_config_page("/careers",function(){return{onLoad:function(){display_career_email()}}}),pjax_config_page("/bulk-trader-facility",function(){return{onLoad:function(){var a=$(".bulk-trader-facility");sidebar_scroll(a)},onUnload:function(){$(window).off("scroll")}}});var minDT=new Date;minDT.setUTCFullYear(minDT.getUTCFullYear-3);var liveChartsFromDT,liveChartsToDT,liveChartConfig,updateDatesFromConfig=function(a){var b=$("#live_chart_duration li[data-live="+a.live+"]").attr("id"),c=new Date;liveChartsFromDT.setDateTime(new Date(c.getTime()-1e3*b)),liveChartsToDT.setDateTime(c)},show_chart_for_instrument=function(){var a,b;$("#instrument_select .deleteme").remove(),$("#instrument_select option:selected").each(function(){a=$(this).val(),b=$(this).text()}),a&&(liveChartConfig.update({symbol:a,update_url:1}),updateLiveChart(liveChartConfig))},remove_highlight_chart_duration=function(){$("#live_chart_duration").find(".live_charts_stream_button").each(function(){$(this).find("span").removeClass("current")})},build_markets_select=function(){var a=$("#market_select");markets.each(function(){a.append("forex"==this.name?"<option id='opt_"+this.name+"' value='"+this.name+"'>"+this.translated_display_name()+"</option>":"<option class='ja-hide' id='opt_"+this.name+"' value='"+this.name+"'>"+this.translated_display_name()+"</option>")}),$("#market_select").val(liveChartConfig.market.name),build_instrument_select(),$("#market_select").change(build_instrument_select)},build_instrument_select=function(){var a=$("#instrument_select"),b=markets.get($("#market_select").val());$("#instrument_span").hide(),b&&($("#instrument_select option").remove(),a.append("<option class='deleteme'></option>"),b.each(function(){this.each(function(){a.append("<option value='"+this.symbol+"'>"+this.translated_display_name()+"</option>")})}),$("#instrument_span").show(),$("#instrument_select").change(show_chart_for_instrument),$("#instrument_select").val(liveChartConfig.symbol.symbol))},init_live_chart=function(){liveChartsFromDT=new DateTimePicker({id:"live_charts_from",onChange:function(a){liveChartsToDT.setMinDateTime(a)}}),liveChartsToDT=new DateTimePicker({id:"live_charts_to",onChange:function(a){liveChartsFromDT.setMaxDateTime(a)}}),liveChartConfig=new LiveChartConfig({renderTo:"live_chart_div"}),configure_livechart(),build_markets_select(),$(".notice").hide(),$("#live_chart_extended_options").hide(),$("#live_charts_show_extended_options").on("click",function(a){a.preventDefault(),$("#live_chart_extended_options").toggle()}),$("#live_charts_high_barrier").change(function(){var a=$(this).val();if((liveChartConfig.has_indicator("high")||!a)&&live_chart.remove_indicator("high"),a){var b=new LiveChartIndicator.Barrier({name:"high",value:a,color:"green"});live_chart.add_indicator(b)}}),$("#live_charts_low_barrier").change(function(){var a=$(this).val();if((liveChartConfig.has_indicator("low")||!a)&&live_chart.remove_indicator("low"),a){var b=new LiveChartIndicator.Barrier({name:"low",value:a,color:"red"});live_chart.add_indicator(b)}}),$("#live_charts_hide_spot").hide(),$("#live_charts_show_spot").on("click",function(a){a.preventDefault();var b=new LiveChartIndicator.Barrier({name:"spot",value:"+0"});live_chart.add_indicator(b),$(this).hide(),$("#live_charts_hide_spot").show()}),$("#live_charts_hide_spot").on("click",function(a){a.preventDefault(),live_chart.remove_indicator("spot"),$(this).hide(),$("#live_charts_show_spot").show()}),$("#live_charts_show_interval").on("click",function(){liveChartConfig.update({interval:{from:liveChartsFromDT.getDateTime(),to:liveChartsToDT.getDateTime()},update_url:1}),updateLiveChart(liveChartConfig)}),$("#live_chart_duration").on("duration_change",function(a){updateDatesFromConfig(a.config)}),show_chart_for_instrument(),updateDatesFromConfig(liveChartConfig)};pjax_config_page("livechart",function(){return{onLoad:function(){init_live_chart()},onUnload:function(){live_chart.close_chart(),live_chart=null}}}),$(function(){!live_chart&&/livechart/.test(window.location.pathname)&&init_live_chart()});var Portfolio=function(){var a=null,b=$("button.open_contract_details");return{update_indicative_prices:function(){if(!page.client.is_logged_in)return void(window.location.href=page.url.url_for("login"));this.cancel_price_request();var c=this;$.isEmptyObject(b)||(a=$.ajax(ajax_loggedin({url:"/d/trade.cgi",type:"POST",async:!0,data:"controller_action=open_position_values",timeout:6e4,success:c.on_price_request_success,error:c.on_price_request_error})))},cancel_price_request:function(){a&&a.abort()},on_price_request_success:function(a,b,c){var d={},e={};if(d="object"==typeof a?a:JSON&&JSON.parse(a)||$.parseJSON(a)||{},d.redirect)return void(window.location.href=d.redirect);if(!d.error){if(d.prices)e=d.prices;else{console.log(d);var f=new Error("Invalid server response: "+d);Portfolio.on_price_request_error(c,b,f)}Portfolio.set_contract_prices(e)}},on_price_request_error:function(){},set_contract_prices:function(a){var c=a&&a["*"]?a["*"]:null,d=function(){var b,d=$(this);data=element_data_attrs(d);var e=data.shortcode,f=data.currency;if(!a[f]){if(null===c)return;a[f]={}}null!==c&&void 0===a[f][e]&&(a[f][e]=c),b=a[f][e],void 0!==b&&(isNaN(b)?$("p",d.parents("div").children("div")[2]).text(b):(d.attr("price",b),b=stylized_price(b),b=b.units+b.cents,$("p",d.parents("div").children("div")[2]).text(f+" "+b)))};b.each(d)}}}();pjax_config_page("portfolio",function(){return{onLoad:function(){$("#portfolio-table .hourglass").hide(),$("#currencyfrom").change(function(a){currencyConvertorCalculator(a.target)}),$("#currencyfrom").keyup(function(a){currencyConvertorCalculator(a.target)}),$("#currencyfromvalue").change(function(a){checkCurrencyAmountFormat(a.target)}),$("#currencyfromvalue").keyup(function(a){checkCurrencyAmountFormat(a.target)}),Portfolio.update_indicative_prices()}}});var calculate_button_event=function(){$("#pricingtable_calculate").on("click",function(a){a.preventDefault();var b=$("form[name=pricing_table_input]").get(0),c=page.url.url_for("resources/pricing_table",getFormParams(b));$("#pricingtable_calculate").hide(),$("#pricingtable_calculating").show(),$("#pricing_table_prices_div").html(""),$.ajax({url:c,data:{ajax_only:1,prices_only:1}}).done(function(a){$("#pricing_table_prices_div").html(a),page.url.update(c),$("#pricingtable_calculating").hide(),$("#pricingtable_calculate").show(),attach_tabs("#pricing_table_tabs")})})},bet_type_select=function(){$("#pricing_table_input").find('select[name="bet_type"]').on("change",function(){for(var a=$(this).val(),b=["RANGE","UPORDOWN","EXPIRYRANGE","EXPIRYMISS"],c=0,d=0;d<b.length;d++)if(a==b[d]){c=1;break}1==c?($("#lower_strike").show(),$("#high_strike_label").show(),$("#strike_label").hide()):($("#lower_strike").hide(),$("#high_strike_label").hide(),$("#strike_label").show());var e=$("#pricingtable_underlying").val(),f=page.url.url_for("resources/pricing_table");$.post(f,{action:"get_underlyings",ajax_only:1,bet_type:a,underlying:e},function(a){$("#pricingtable_underlying_div").html(a);var b=$("#pricingtable_underlying");b.val()!=e&&(b.find("option").get(0).selected=!0,b.find("option").get(0).val(),b.trigger("change"))},"html")})},select_underlying_change=function(){$("#pricingtable_underlying").on("change",function(){var a=$(this).val(),b=page.url.url_for("resources/pricing_table");$.post(b,{action:"get_low_strike",ajax_only:1,underlying:a},function(a){$("#low_strike").attr("value",a)},"html")})},select_strike_type=function(){$("#strike_type").on("change",function(){var a=$(this).val();"Moneyness terms"==a?($("#from_strike_percent").show(),$("#from_strike_label").hide()):($("#from_strike_percent").hide(),$("#from_strike_label").show())}).change()},expiry_date_picker=function(){var a=new Date,b=new Date;b.setDate(a.getDate()+60);var c=$("#from_expiry");c.datepicker({dateFormat:"yy-mm-dd",monthNames:[text.localize("January"),text.localize("February"),text.localize("March"),text.localize("April"),text.localize("May"),text.localize("June"),text.localize("July"),text.localize("August"),text.localize("September"),text.localize("October"),text.localize("November"),text.localize("December")],dayNamesShort:[text.localize("Su"),text.localize("Mo"),text.localize("Tu"),text.localize("We"),text.localize("Th"),text.localize("Fr"),text.localize("Sa")],minDate:a,maxDate:b,onSelect:function(a){c.attr("value",a)}}).datepicker("setDate","0")};onLoad.queue_for_url(initialize_pricing_table,"pricing_table"),onLoad.queue_for_url(function(){$("#profit-table-date").on("change",function(){$("#submit-date").removeClass("invisible")})},"profit_table");var self_exclusion_date_picker=function(){var a=new Date;a.setMonth(a.getMonth()+6);var b=new Date;b.setFullYear(b.getFullYear()+5);var c=$("#EXCLUDEUNTIL");c.datepicker({dateFormat:"yy-mm-dd",minDate:a,maxDate:b,onSelect:function(a){c.attr("value",a)}})},self_exclusion_validate_date=function(){$("#selfExclusion").on("click","#self_exclusion_submit",function(){return client_form.self_exclusion.validate_exclusion_date()})};onLoad.queue_for_url(function(){self_exclusion_date_picker(),self_exclusion_validate_date()},"self_exclusion"),onLoad.queue_for_url(function(){$("#statement-date").on("change",function(){$("#submit-date").removeClass("invisible")})},"statement");var Barriers=function(){"use strict";var a=!1,b=function(){var a=Contract.barriers(),b=Contract.form();if(a&&b){var c=a[b];if(c){var d=document.getElementById("duration_units"),e=Tick.quote(),f=document.getElementById("indicative_barrier_tooltip"),g=document.getElementById("indicative_high_barrier_tooltip"),h=document.getElementById("indicative_low_barrier_tooltip"),i=countDecimalPlaces(e);if(1===c.count){document.getElementById("high_barrier_row").style.display="none",document.getElementById("low_barrier_row").style.display="none",document.getElementById("barrier_row").setAttribute("style","");var j=document.getElementById("barrier"),k=document.getElementById("barrier_tooltip"),l=document.getElementById("barrier_span");return void(d&&"d"===d.value?(e&&!isNaN(e)?(j.value=(parseFloat(e)+parseFloat(c.barrier)).toFixed(i),j.textContent=(parseFloat(e)+parseFloat(c.barrier)).toFixed(i)):(j.value=parseFloat(c.barrier),j.textContent=parseFloat(c.barrier)),k.style.display="none",l.style.display="inherit",f.textContent=""):(j.value=c.barrier,j.textContent=c.barrier,l.style.display="none",k.style.display="inherit",f.textContent=e&&!isNaN(e)?(parseFloat(e)+parseFloat(c.barrier)).toFixed(i):""))}if(2===c.count){document.getElementById("barrier_row").style.display="none",document.getElementById("high_barrier_row").setAttribute("style",""),document.getElementById("low_barrier_row").setAttribute("style","");var m=document.getElementById("barrier_high"),n=document.getElementById("barrier_low"),o=document.getElementById("barrier_high_tooltip"),p=document.getElementById("barrier_high_span"),q=document.getElementById("barrier_low_tooltip"),r=document.getElementById("barrier_low_span");return void(d&&"d"===d.value?(e&&!isNaN(e)?(m.value=(parseFloat(e)+parseFloat(c.barrier)).toFixed(i),m.textContent=(parseFloat(e)+parseFloat(c.barrier)).toFixed(i),n.value=(parseFloat(e)+parseFloat(c.barrier1)).toFixed(i),n.textContent=(parseFloat(e)+parseFloat(c.barrier1)).toFixed(i)):(m.value=parseFloat(c.barrier),m.textContent=parseFloat(c.barrier),n.value=parseFloat(c.barrier1),n.textContent=parseFloat(c.barrier1)),o.style.display="none",p.style.display="inherit",q.style.display="none",r.style.display="inherit",g.textContent="",h.textContent=""):(m.value=c.barrier,m.textContent=c.barrier,n.value=c.barrier1,n.textContent=c.barrier1,p.style.display="none",o.style.display="inherit",r.style.display="none",q.style.display="inherit",e&&!isNaN(e)?(g.textContent=(parseFloat(e)+parseFloat(c.barrier)).toFixed(i),h.textContent=(parseFloat(e)+parseFloat(c.barrier1)).toFixed(i)):(g.textContent="",h.textContent="")))}}}for(var s=document.getElementsByClassName("barrier_class"),t=0;t<s.length;t++)s[t].style.display="none"};return{display:b,isBarrierUpdated:function(){return a},setBarrierUpdate:function(b){a=b}}}();Element.prototype.hide=function(){this.style.display="none"},Element.prototype.show=function(){this.style.display=""};var Content=function(){"use strict";var a={},b=function(){a={textStartTime:text.localize("Start time"),textSpot:text.localize("Spot"),textBarrier:text.localize("Barrier"),textBarrierOffset:text.localize("Barrier offset"),textHighBarrier:text.localize("High barrier"),textHighBarrierOffset:text.localize("High barrier offset"),textLowBarrier:text.localize("Low barrier"),textLowBarrierOffset:text.localize("Low barrier offset"),textPayout:text.localize("Payout"),textStake:text.localize("Stake"),textPurchase:text.localize("Purchase"),textDuration:text.localize("Duration"),textEndTime:text.localize("End Time"),textMinDuration:text.localize("min"),textMinDurationTooltip:text.localize("minimum available duration"),textBarrierOffsetTooltip:text.localize("Enter the barrier in terms of the difference from the spot price. If you enter +0.005, then you will be purchasing a contract with a barrier 0.005 higher than the entry spot. The entry spot will be the next tick after your order has been received"),textDurationSeconds:text.localize("seconds"),textDurationMinutes:text.localize("minutes"),textDurationHours:text.localize("hours"),textDurationDays:text.localize("days"),textDurationTicks:text.localize("ticks"),textNetProfit:text.localize("Net profit"),textReturn:text.localize("Return"),textNow:text.localize("Now"),textContractConfirmationHeading:text.localize("Contract Confirmation"),textContractConfirmationReference:text.localize("Your transaction reference is"),textContractConfirmationBalance:text.localize("Account balance:"),textFormRiseFall:text.localize("Rise/Fall"),textFormHigherLower:text.localize("Higher/Lower"),textFormUpDown:text.localize("Up/Down"),textFormInOut:text.localize("In/Out"),textContractPeriod:text.localize("Contract period"),textExercisePeriod:text.localize("Exercise price"),predictionLabel:text.localize("Last Digit Prediction"),textContractConfirmationPayout:text.localize("Potential Payout"),textContractConfirmationCost:text.localize("Total Cost"),textContractConfirmationProfit:text.localize("Potential Profit"),textAmountPerPoint:text.localize("Amount per point"),textStopLoss:text.localize("Stop-loss"),textStopProfit:text.localize("Stop-profit"),textStopType:text.localize("Stop-type"),textStopTypePoints:text.localize("Points"),textContractConfirmationButton:text.localize("View"),textIndicativeBarrierTooltip:text.localize("This is an indicative barrier. Actual barrier will be the entry spot plus the barrier offset."),textSpreadTypeLong:text.localize("Long"),textSpreadTypeShort:text.localize("Short"),textSpreadDepositComment:text.localize("Deposit of"),textSpreadRequiredComment:text.localize("is required. Current spread"),textSpreadPointsComment:text.localize("points")};var b=document.getElementById("start_time_label");b&&(b.textContent=a.textStartTime);var c=document.getElementById("duration_tooltip");c&&(c.textContent=a.textMinDuration,c.setAttribute("title",a.textMinDurationTooltip));var d=document.getElementById("spot_label");d&&(d.textContent=a.textSpot);var e=document.getElementById("barrier_tooltip");e&&(e.textContent=a.textBarrierOffset,e.setAttribute("title",a.textBarrierOffsetTooltip));var f=document.getElementById("barrier_span");f&&(f.textContent=a.textBarrier);var g=document.getElementById("barrier_high_tooltip");g&&(g.textContent=a.textHighBarrierOffset,g.setAttribute("title",a.textBarrierOffsetTooltip));var h=document.getElementById("barrier_high_span");h&&(h.textContent=a.textHighBarrier);var i=document.getElementById("barrier_low_tooltip");i&&(i.textContent=a.textLowBarrierOffset,i.setAttribute("title",a.textBarrierOffsetTooltip));var j=document.getElementById("barrier_low_span");j&&(j.textContent=a.textLowBarrier);var k=document.getElementById("prediction_label");k&&(k.textContent=a.predictionLabel);var l=document.getElementById("payout_option");l&&(l.textContent=a.textPayout);var m=document.getElementById("stake_option");m&&(m.textContent=a.textStake);var n=document.getElementById("purchase_button_top");n&&(n.textContent=a.textPurchase);var o=document.getElementById("purchase_button_bottom");o&&(o.textContent=a.textPurchase);var p=document.getElementById("period_label");p&&(p.textContent=a.textContractPeriod);var q=document.getElementById("amount_per_point_label");q&&(q.textContent=a.textAmountPerPoint);var r=document.getElementById("stop_loss_label");r&&(r.textContent=a.textStopLoss);var s=document.getElementById("stop_profit_label");s&&(s.textContent=a.textStopProfit);var t=document.getElementById("stop_type_label");t&&(t.textContent=a.textStopType);var u=document.getElementById("stop_type_points_label");u&&(u.textContent=a.textStopTypePoints);var v=document.getElementById("indicative_barrier_tooltip");v&&v.setAttribute("title",a.textIndicativeBarrierTooltip);var w=document.getElementById("indicative_high_barrier_tooltip");w&&w.setAttribute("title",a.textIndicativeBarrierTooltip);var x=document.getElementById("indicative_low_barrier_tooltip");x&&x.setAttribute("title",a.textIndicativeBarrierTooltip);var y=document.getElementById("jbarrier_label");y&&(y.textContent=a.textExercisePeriod);var z=document.getElementById("jbarrier_high_label");z&&(z.textContent=a.textHighBarrier);var A=document.getElementById("jbarrier_low_label");A&&(A.textContent=a.textLowBarrier)};return{localize:function(){return a},populate:b}}(),Contract=function(){"use strict";var a,b,c,d,e={},f={},g={},h={},i={},j=function(a){var b=a.contract_category;f[a.expiry_type]||(f[a.expiry_type]={}),f[a.expiry_type][b]||(f[a.expiry_type][b]={}),f[a.expiry_type][b][a.barrier_category]||(f[a.expiry_type][b][a.barrier_category]={}),f[a.expiry_type][b][a.barrier_category][a.start_type]||(f[a.expiry_type][b][a.barrier_category][a.start_type]={}),f[a.expiry_type][b][a.barrier_category][a.start_type].max_contract_duration=a.max_contract_duration,f[a.expiry_type][b][a.barrier_category][a.start_type].min_contract_duration=a.min_contract_duration},k=function(e){var k,l=Contract.contracts().contracts_for;g={has_spot:0,list:[]},f={},a=l.open,b=l.close;var m=getFormNameBarrierCategory(e);c=e=m.formName,d=k=m.barrierCategory,l.available.forEach(function(a){var b=a.contract_category;if(e&&e===b){k?k===a.barrier_category&&j(a):j(a),a.forward_starting_options&&"forward"===a.start_type&&"higherlower"!==sessionStorage.formname?g.list=a.forward_starting_options:"spot"===a.start_type&&(g.has_spot=1);var c={};a.barrier_category&&"non_financial"!==a.barrier_category&&(1===a.barriers?h.hasOwnProperty(b)||(c.count=1,c.barrier=a.barrier,c.barrier_category=a.barrier_category,h[e]=c):2===a.barriers&&(h.hasOwnProperty(b)||(c.count=2,c.barrier=a.high_barrier,c.barrier1=a.low_barrier,c.barrier_category=a.barrier_category,h[e]=c))),i[b]||(i[b]={}),i[b].hasOwnProperty(a.contract_type)||(i[b][a.contract_type]=a.contract_display)}}),e&&k&&h&&h[e]&&h[e].barrier_category!==k&&(h={})},l=function(a){TradeSocket.send({contracts_for:a})},m=function(){var a=Contract.contracts().contracts_for,b={};return a.available.forEach(function(a){var c=a.contract_category;c&&!b.hasOwnProperty(c)&&("callput"===c?"euro_atm"===a.barrier_category?b.risefall=Content.localize().textFormRiseFall:b.higherlower=Content.localize().textFormHigherLower:b[c]=a.contract_category_display)}),b.risefall&&(b.updown=Content.localize().textFormUpDown),(b.endsinout||b.staysinout)&&(b.inout=Content.localize().textFormInOut),b};return{details:k,getContracts:l,contractForms:m,open:function(){return a},close:function(){return b},contracts:function(){return e},durations:function(){return f},startDates:function(){return g},barriers:function(){return h},contractType:function(){return i},form:function(){return c},barrier:function(){return d},setContracts:function(a){e=a}}}(),Durations=function(){var a={},b="",c=function(a){"use strict";var b=Contract.durations();if(b===!1)return document.getElementById("expiry_row").style.display="none",!1;for(var c=document.getElementById("duration_units"),f=Contract.form(),g=Contract.barrier(),h=(document.createDocumentFragment(),{});c&&c.firstChild;)c.removeChild(c.firstChild);for(var i in b)if(b.hasOwnProperty(i))for(var j in b[i][f])if(b[i][f].hasOwnProperty(j)){var k={};k=g?b[i][f][g]:b[i][f][j];for(var l in k)k.hasOwnProperty(l)&&(a?a===l&&(h.hasOwnProperty(a)||(h[i]=k[a])):h.hasOwnProperty(l)||(h[i]=k[l]))}var m={};for(var n in h)if(h.hasOwnProperty(n)){var o,p,q=h[n].min_contract_duration,r=d(q);if("intraday"===n)switch(r.value){case"s":o=document.createElement("option"),p=document.createTextNode(r.text),o.setAttribute("value",r.value),o.setAttribute("data-minimum",r.min),o.appendChild(p),m[r.value]=o,o=document.createElement("option"),p=document.createTextNode(Content.localize().textDurationMinutes),o.setAttribute("value","m"),o.setAttribute("data-minimum",1),o.setAttribute("selected","selected"),o.appendChild(p),m.m=o,o=document.createElement("option"),p=document.createTextNode(Content.localize().textDurationHours),o.setAttribute("value","h"),o.setAttribute("data-minimum",1),o.appendChild(p),m.h=o;break;case"m":o=document.createElement("option"),p=document.createTextNode(r.text),o.setAttribute("value",r.value),o.setAttribute("data-minimum",r.min),o.setAttribute("selected","selected"),o.appendChild(p),m[r.value]=o,o=document.createElement("option"),p=document.createTextNode(Content.localize().textDurationHours),o.setAttribute("value","h"),o.setAttribute("data-minimum",1),o.appendChild(p),m.h=o;break;case"h":o=document.createElement("option"),p=document.createTextNode(r.text),o.setAttribute("value",r.value),o.setAttribute("data-minimum",r.min),o.appendChild(p),m[r.value]=o;break;default:o=document.createElement("option"),p=document.createTextNode(r.text),o.setAttribute("value",r.value),o.setAttribute("data-minimum",r.min),o.appendChild(p),m[r.value]=o}else"daily"===n?(o=document.createElement("option"),p=document.createTextNode(r.text),o.setAttribute("value",r.value),o.setAttribute("data-minimum",r.min),o.appendChild(p),m[r.value]=o):"tick"===n&&(o=document.createElement("option"),p=document.createTextNode(r.text),o.setAttribute("value",r.value),o.setAttribute("data-minimum",r.min),o.appendChild(p),m[r.value]=o)}for(var s=Object.keys(m).sort(function(a,b){return durationOrder(a)>durationOrder(b)?1:-1}),t=0;t<s.length;t++){var u=s[t];m.hasOwnProperty(u)&&c.appendChild(m[u])}e()},d=function(a){"use strict";var b={s:Content.localize().textDurationSeconds,m:Content.localize().textDurationMinutes,h:Content.localize().textDurationHours,d:Content.localize().textDurationDays,t:Content.localize().textDurationTicks},c=a?a.toString().match(/[a-zA-Z]+|[0-9]+/g):[],d={};return c.length>1?(d.value=c[1],d.text=b[c[1]],d.min=c[0]):(d.value="t",d.text=b.t,d.min=c[0]),d},e=function(){"use strict";var a=document.getElementById("duration_units");if(isVisible(a)){var b=a.options[a.selectedIndex].getAttribute("data-minimum");document.getElementById("duration_amount").value=b,document.getElementById("duration_minimum").textContent=b,f(a.value)}else f();Barriers.display()},f=function(a){"use strict";var b=document.getElementById("expiry_type"),c=document.createDocumentFragment(),d=b.value||"duration",e=d,f="duration"===d?"endtime":"duration";for(e=document.getElementById("expiry_type_"+e),e&&(e.style.display="flex"),f=document.getElementById("expiry_type_"+f),f&&(f.style.display="none");b&&b.firstChild;)b.removeChild(b.firstChild);var g=document.createElement("option"),h=document.createTextNode(Content.localize().textDuration);g.setAttribute("value","duration"),"duration"===d&&g.setAttribute("selected","selected"),g.appendChild(h),c.appendChild(g),"t"!==a&&(g=document.createElement("option"),h=document.createTextNode(Content.localize().textEndTime),g.setAttribute("value","endtime"),"endtime"===d&&g.setAttribute("selected","selected"),g.appendChild(h),c.appendChild(g)),b.appendChild(c)},g=function(b){if(!a.hasOwnProperty(b.echo_req.trading_times)&&b.hasOwnProperty("trading_times")&&b.trading_times.hasOwnProperty("markets"))for(var c=0;c<b.trading_times.markets.length;c++){var d=b.trading_times.markets[c].submarkets;if(d)for(var e=0;e<d.length;e++){var f=d[e].symbols;if(f)for(var g=0;g<f.length;g++){var h=f[g];a[b.echo_req.trading_times]||(a[b.echo_req.trading_times]={}),a[b.echo_req.trading_times][h.symbol]=h.times.close}}}};return{display:c,populate:e,setTime:function(a){b=a},getTime:function(){return b},processTradingTimesAnswer:g,trading_times:function(){return a}}}(),TradingEvents=function(){"use strict";var a=function(){var a=document.getElementById("contract_markets"),b=function(a){showPriceOverlay(),sessionStorage.setItem("market",a),sessionStorage.removeItem("formname"),sessionStorage.removeItem("underlying"),processMarket(1)};a&&a.addEventListener("change",function(a){var c=a.target;b(c.value)});var c=function(){processContractForm(),requestTradeAnalysis()},d=document.getElementById("contract_form_name_nav");d&&d.addEventListener("click",function(a){if(a.target&&a.target.getAttribute("menuitem")){var b=a.target,e=b.classList.contains("active");sessionStorage.setItem("formname",b.getAttribute("menuitem")),setFormPlaceholderContent(),toggleActiveCatMenuElement(d,a.target.getAttribute("menuitem")),e||c();var f=document.getElementById("contract_form_show_menu");f&&(f.checked=!1)}});var e=document.getElementById("underlying");e&&e.addEventListener("change",function(a){if(a.target){showPriceOverlay();var b=a.target.value;sessionStorage.setItem("underlying",b),requestTradeAnalysis(),Contract.getContracts(b),processForgetTickId(),TradeSocket.send({ticks:b})}});var f=document.getElementById("duration_amount");f&&f.addEventListener("input",debounce(function(){processPriceRequest(),submitForm(document.getElementById("websocket_form"))}));var g=document.getElementById("expiry_type");g&&g.addEventListener("change",function(a){if(Durations.populate(),a.target&&"endtime"===a.target.value){var b=moment().add(5,"minutes").utc();document.getElementById("expiry_date").value=b.format("YYYY-MM-DD"),document.getElementById("expiry_time").value=b.format("HH:mm"),Durations.setTime(b.format("HH:mm"))}processPriceRequest()});var h=document.getElementById("duration_units");h&&h.addEventListener("change",function(){Durations.populate(),processPriceRequest()});var i=document.getElementById("expiry_date");i&&i.addEventListener("change",function(){var a=this.value,b=a.match(/^(\d{4})-(\d{2})-(\d{2})$/);if(b){var c=new Date;c.setUTCFullYear(b[1]),c.setUTCMonth(b[2]-1),c.setUTCDate(b[3]);var d=new Date,e=c.getTime()-d.getTime(),f=document.getElementById("expiry_time");e>864e5?(Durations.setTime(""),f.hide()):(Durations.setTime(f.value),f.show()),processTradingTimesRequest(a)}});var j=document.getElementById("expiry_time");j&&j.addEventListener("change",function(){Durations.setTime(j.value),processPriceRequest()});var k=document.getElementById("amount");k&&k.addEventListener("input",debounce(function(a){sessionStorage.setItem("amount",a.target.value),processPriceRequest(),submitForm(document.getElementById("websocket_form"))}));var l=document.getElementById("date_start");l&&l.addEventListener("change",function(a){Durations.display(a.target&&"now"===a.target.value?"spot":"forward"),processPriceRequest()});var m=document.getElementById("amount_type");m&&m.addEventListener("change",function(a){sessionStorage.setItem("amount_type",a.target.value),processPriceRequest()});var n=document.getElementById("submarket");n&&n.addEventListener("change",function(a){if(a.target){for(var b=document.getElementById("underlying"),c=b.children,d=0,e=c.length;e>d;d++)c[d].disabled="all"!==a.target.value&&a.target.value!==c[d].className?!0:!1;document.querySelectorAll("#underlying option:enabled")[0].selected="selected";var f=new Event("change");b.dispatchEvent(f)}});var o=document.getElementById("currency");o&&o.addEventListener("change",function(a){sessionStorage.setItem("currency",a.target.value);var b=document.getElementById("stop_type_dollar_label");b&&isVisible(b)&&(b.textContent=a.target.value),processPriceRequest()});var p=function(){var a=this.getAttribute("data-purchase-id"),b=this.getAttribute("data-ask-price"),c={buy:a,price:b,passthrough:{}},d=Price.bufferedIds();if(d[a]){for(var e in this.attributes)if(e&&this.attributes[e]&&this.attributes[e].name){var f=this.attributes[e].name.match(/data\-(.+)/);f&&f[1]&&"purchase-id"!==f[1]&&"passthrough"!==f[1]&&(c.passthrough[f[1]]=this.attributes[e].value)}a&&b&&(TradeSocket.send(c),Price.incrFormId(),processForgetPriceIds())}},q=document.getElementsByClassName("purchase_button");if(q)for(var r=0,s=q.length;s>r;r++)q[r].addEventListener("click",p);var t=document.getElementById("close_confirmation_container");t&&t.addEventListener("click",function(a){a.target&&(a.preventDefault(),document.getElementById("contract_confirmation_container").style.display="none",document.getElementById("contracts_list").style.display="flex",processPriceRequest())});var u=document.getElementById("barrier");u&&u.addEventListener("input",debounce(function(){processPriceRequest(),submitForm(document.getElementById("websocket_form"))}));var v=document.getElementById("barrier_low");v&&v.addEventListener("input",debounce(function(){processPriceRequest(),submitForm(document.getElementById("websocket_form"))}));var w=document.getElementById("barrier_high");w&&w.addEventListener("input",debounce(function(){processPriceRequest(),submitForm(document.getElementById("websocket_form"))}));var x=document.getElementById("prediction");x&&x.addEventListener("input",debounce(function(){processPriceRequest(),submitForm(document.getElementById("websocket_form"))}));var y=document.getElementById("amount_per_point");y&&y.addEventListener("input",debounce(function(){processPriceRequest(),submitForm(document.getElementById("websocket_form"))}));var z=function(){processPriceRequest()},A=document.querySelectorAll('input[name="stop_type"]');if(A)for(var B=0,C=A.length;C>B;B++)A[B].addEventListener("click",z);var D=document.getElementById("stop_loss");D&&D.addEventListener("input",debounce(function(){processPriceRequest(),submitForm(document.getElementById("websocket_form"))}));var E=document.getElementById("stop_profit");E&&E.addEventListener("input",debounce(function(){processPriceRequest(),submitForm(document.getElementById("websocket_form"))}));var F=document.getElementById("trading_init_progress");F&&F.addEventListener("click",debounce(function(){sessionStorage.removeItem("market"),sessionStorage.removeItem("formname"),sessionStorage.removeItem("underlying"),location.reload()}))};return{init:a}}(),Message=function(){"use strict";var a=function(a){var b=JSON.parse(a.data);if(b){var c=b.msg_type;"authorize"===c?(User.set(b.authorize),TradeSocket.send({payout_currencies:1})):"active_symbols"===c?processActiveSymbols(b):"contracts_for"===c?processContract(b):"payout_currencies"===c?(sessionStorage.setItem("currencies",a.data),displayCurrencies()):"proposal"===c?processProposal(b):"buy"===c?Purchase.display(b):"tick"===c?processTick(b):"trading_times"===c&&processTradingTimes(b)}else console.log("some error occured")};return{process:a}}(),Price=function(){"use strict";var a={},b={},c={},d=0,e=function(a){var b={proposal:1},c=document.getElementById("underlying"),e=(document.getElementById("submarket"),a),f=document.getElementById("amount_type"),g=document.getElementById("currency"),h=document.getElementById("amount"),i=document.getElementById("date_start"),j=document.getElementById("expiry_type"),k=document.getElementById("duration_amount"),l=document.getElementById("duration_units"),m=document.getElementById("expiry_date"),n=(document.getElementById("expiry_time"),document.getElementById("barrier")),o=document.getElementById("barrier_high"),p=document.getElementById("barrier_low"),q=document.getElementById("prediction"),r=document.getElementById("amount_per_point"),s=document.querySelector('input[name="stop_type"]:checked'),t=document.getElementById("stop_loss"),u=document.getElementById("stop_profit");
if(h&&isVisible(h)&&h.value&&(b.amount=parseFloat(h.value)),f&&isVisible(f)&&f.value&&(b.basis=f.value),e&&(b.contract_type=a),g&&g.value&&(b.currency=g.value),c&&c.value&&(b.symbol=c.value),i&&isVisible(i)&&"now"!==i.value&&(b.date_start=i.value),j&&isVisible(j)&&"duration"===j.value)b.duration=parseInt(k.value),b.duration_unit=l.value;else if(j&&isVisible(j)&&"endtime"===j.value){var v=m.value,w=Durations.getTime();if(!w){var x=Durations.trading_times();x.hasOwnProperty(v)&&(w=x[v][c.value])}b.date_expiry=moment.utc(v+" "+w).unix()}return n&&isVisible(n)&&n.value&&(b.barrier=n.value),o&&isVisible(o)&&o.value&&(b.barrier=o.value),p&&isVisible(p)&&p.value&&(b.barrier2=p.value),q&&isVisible(q)&&(b.barrier=parseInt(q.value)),r&&isVisible(r)&&(b.amount_per_point=parseFloat(r.value)),s&&isVisible(s)&&(b.stop_type=s.value),t&&isVisible(t)&&(b.stop_loss=parseFloat(t.value)),u&&isVisible(u)&&(b.stop_profit=parseFloat(u.value)),e&&(b.contract_type=a),b.passthrough={form_id:d},b},f=function(d,e){var f=d.proposal,g=d.echo_req,h=f.id,i=g.contract_type||a[h],j=f.spread?!0:!1;g&&Object.getOwnPropertyNames(g).length>0&&(a[h]=i,b.hasOwnProperty(h)||(b[h]=moment().utc().unix()),c.hasOwnProperty(h)||(c[h]=g));var k=contractTypeDisplayMapping(i),l=document.getElementById("price_container_"+k),m=document.getElementById("price_container_"+k),n=l.getElementsByClassName("contract_heading")[0],o=l.getElementsByClassName("contract_amount")[0],p=l.getElementsByClassName("purchase_button")[0],q=l.getElementsByClassName("contract_description")[0],r=l.getElementsByClassName("price_comment")[0],s=l.getElementsByClassName("contract_error")[0],t=document.getElementById("currency"),u=i&&e?e[i]:"";if(u&&(n.setAttribute("class","contract_heading "+u.toLowerCase().replace(/ /g,"_")),n.textContent=j?"top"===k?Content.localize().textSpreadTypeLong:Content.localize().textSpreadTypeShort:u),f.ask_price&&(o.textContent=j?f.ask_price:t.value+" "+f.ask_price),f.longcode&&(f.longcode=f.longcode.replace(/[\d\,]+\.\d\d/,function(a){return"<b>"+a+"</b>"}),q.innerHTML=f.longcode),document.getElementById("websocket_form")&&(document.getElementById("websocket_form").checkValidity()?document.getElementById("websocket_form").checkValidity()&&m&&(m.style.display="block"):(m&&(m.style.display="none"),processForgetPriceIds())),d.error)p.hide(),r.hide(),s.show(),s.textContent=d.error.message;else{p.show(),r.show(),s.hide(),j?displayCommentSpreads(r,t.value,f.spread):displayCommentPrice(r,t.value,f.ask_price,f.payout);var v=p.getAttribute("data-ask-price");v&&displayPriceMovement(o,v,f.ask_price),p.setAttribute("data-purchase-id",h),p.setAttribute("data-ask-price",f.ask_price),p.setAttribute("data-symbol",h);for(var w in c[h])w&&"proposal"!==w&&p.setAttribute("data-"+w,c[h][w])}},g=function(){a={}},h=function(){b={},d=0};return{proposal:e,display:f,clearMapping:g,idDisplayMapping:function(){return a},bufferedIds:function(){return b},bufferRequests:function(){return c},getFormId:function(){return d},incrFormId:function(){d++},clearBufferIds:h}}(),Purchase=function(){"use strict";var a={};BetSell.register();var b=function(b){a=b;var c=b.buy,d=b.echo_req.passthrough,e=document.getElementById("contract_confirmation_container"),f=document.getElementById("confirmation_message"),g=document.getElementById("contract_purchase_heading"),h=document.getElementById("contract_purchase_descr"),i=document.getElementById("contract_purchase_reference"),j=document.getElementById("tick_chart"),k=document.getElementById("contract_purchase_balance"),l=document.getElementById("contract_purchase_payout"),m=document.getElementById("contract_purchase_cost"),n=document.getElementById("contract_purchase_profit"),o=document.getElementById("contract_purchase_spots"),p=document.getElementById("confirmation_error"),q=document.getElementById("contracts_list"),r=document.getElementById("contract_purchase_button"),s=b.error,t=!s&&d.duration<=10&&"t"===d.duration_unit&&("risefall"===sessionStorage.formname||"higherlower"===sessionStorage.formname);if(e.style.display="block",q.style.display="none",s)f.hide(),p.show(),p.textContent=s.message;else{f.show(),p.hide(),g.textContent=Content.localize().textContractConfirmationHeading,h.textContent=c.longcode,i.textContent=Content.localize().textContractConfirmationReference+" "+c.fmb_id;var u,v,w;if("payout"===d.basis)u=d.amount,v=d["ask-price"];else{v=d.amount;var x=c.longcode.match(/\d+\.\d\d/);u=x[0]}w=Math.round(100*(u-v))/100,l.innerHTML=Content.localize().textContractConfirmationPayout+" <p>"+u+"</p>",m.innerHTML=Content.localize().textContractConfirmationCost+" <p>"+v+"</p>",n.innerHTML=Content.localize().textContractConfirmationProfit+" <p>"+w+"</p>",k.textContent=Content.localize().textContractConfirmationBalance+" "+User.get().currency+" "+Math.round(100*c.balance_after)/100,t?j.show():j.hide(),"digits"===sessionStorage.formname?(o.textContent="",o.show()):o.hide(),r.textContent=Content.localize().textContractConfirmationButton;var y=new Date(1e3*c.purchase_time),z={contract_id:c.fmb_id,controller_action:"sell",currency:document.getElementById("currency").value,payout:u,purchase_price:v,purchase_time:y.getUTCFullYear()+"-"+(y.getUTCMonth()+1)+"-"+y.getUTCDate()+" "+y.getUTCHours()+":"+y.getUTCMinutes()+":"+y.getUTCSeconds(),qty:1,shortcode:c.shortcode,url:"https://"+window.location.host+"/trade/analyse_contract?l=EN"};for(var A in z)A&&r.setAttribute(A,z[A])}t&&WSTickDisplay.initialize({symbol:d.symbol,number_of_ticks:d.duration,previous_tick_epoch:c.start_time,contract_category:"callput",display_symbol:Symbols.getName(d.symbol),contract_start:c.start_time,decimal:3,contract_sentiment:"CALL"===d.contract_type?"up":"down",price:d["ask-price"],payout:d.amount,show_contract_result:1})},c=function(b){var c=document.getElementById("contract_purchase_spots");if(isVisible(c)&&a.echo_req.passthrough.duration&&b.tick.epoch&&b.tick.epoch>a.buy.start_time){var d=document.createElement("div");d.classList.add("row");var e=document.createElement("div");e.classList.add("col"),e.textContent="Tick "+(c.getElementsByClassName("row").length+1),d.appendChild(e);var f=document.createElement("div");f.classList.add("col");var g=new Date(1e3*b.tick.epoch),h=g.getUTCHours()<10?"0"+g.getUTCHours():g.getUTCHours(),i=g.getUTCMinutes()<10?"0"+g.getUTCMinutes():g.getUTCMinutes(),j=g.getUTCSeconds()<10?"0"+g.getUTCSeconds():g.getUTCSeconds();f.textContent=h+":"+i+":"+j,d.appendChild(f);var k,l=b.tick.quote.replace(/\d$/,function(a){return k=a,"<b>"+a+"</b>"}),m=document.createElement("div");if(m.classList.add("col"),m.innerHTML=l,d.appendChild(m),c.appendChild(d),c.scrollTop=c.scrollHeight,k&&1===a.echo_req.passthrough.duration){var n;k==a.echo_req.passthrough.barrier?(c.className="won",n="This contract won"):(c.className="lost",n="This contract lost"),document.getElementById("contract_purchase_heading").textContent=text.localize(n)}a.echo_req.passthrough.duration--}};return{display:b,update_spot_list:c}}(),TradeSocket=function(){"use strict";var a,b="wss://"+window.location.host+"/websockets/v2",c=[];page.language()&&(b+="?l="+page.language());var d=function(){return a&&1===a.readyState},e=function(){return!a||3===a.readyState},f=function(){for(;c.length>0;)a.send(JSON.stringify(c.shift()))},g=function(){a=new WebSocket(b),a.onopen=function(){var b=getCookieItem("login");a.send(b?JSON.stringify({authorize:b}):JSON.stringify({payout_currencies:1})),f()},a.onmessage=function(a){Message.process(a)},a.onclose=function(a){Price.clearMapping(),Price.clearBufferIds(),Tick.clearBufferIds(),console.log("socket closed",a)},a.onerror=function(a){console.log("socket error",a)}},h=function(b){e()?(c.push(b),g()):d()?a.send(JSON.stringify(b)):c.push(b)},i=function(){a&&a.close()};return{init:g,send:h,close:i,socket:function(){return a}}}(),Symbols=function(){"use strict";var a={},b={},c={},d=1,e={},f=function(d){var f=d.active_symbols;f.forEach(function(d){var f=d.market,g=d.submarket,h=d.symbol,i=!d.is_trading_suspended&&d.exchange_is_open;a[f]||(a[f]={name:d.market_display_name,is_active:0,submarkets:{}}),a[f].submarkets[g]||(a[f].submarkets[g]={name:d.submarket_display_name,is_active:0}),i&&(a[f].is_active=1,a[f].submarkets[g].is_active=1),b[f]=a[f],b[g]=a[f].submarkets[g],c.hasOwnProperty(f)||(c[f]={}),c.hasOwnProperty(g)||(c[g]={}),c[f].hasOwnProperty(h)||(c[f][h]={is_active:i,display:d.display_name}),c[g].hasOwnProperty(h)||(c[g][h]={is_active:i,display:d.display_name}),e[h]=d.display_name})},g=function(a){TradeSocket.send({active_symbols:"brief"}),d=a};return{details:f,getSymbols:g,markets:function(c){return c?b:a},underlyings:function(){return c},getName:function(a){return e[a]},need_page_update:function(){return d}}}(),Tick=function(){"use strict";var a="",b="",c="",d="",e={},f=function(f){if(d="",f)if(f.error)d=f.error.message;else{var g=f.tick;a=g.quote,b=g.id,c=g.epoch,e.hasOwnProperty(b)||(e[b]=moment().utc().unix())}},g=function(){var b=document.getElementById("spot"),c="";c=d?d:a,parseFloat(c)!=c?b.className="error":(b.classList.remove("error"),displayPriceMovement(b,b.textContent,c),displayIndicativeBarrier()),b.textContent=c},h=function(){e={}};return{details:f,display:g,quote:function(){return a},id:function(){return b},epoch:function(){return c},errorMessage:function(){return d},bufferedIds:function(){return e},clearBufferIds:h}}(),WSTickDisplay=Object.create(TickDisplay);WSTickDisplay.plot=function(){var a=this;a.contract_start_moment=moment(a.contract_start_ms).utc(),a.counter=0,a.applicable_ticks=[]},WSTickDisplay.update_ui=function(a,b,c){$("#contract_purchase_heading").text(text.localize(c))},WSTickDisplay.updateChart=function(a){var b=this,c=document.getElementById("tick_chart");if(c&&isVisible(c)&&a&&a.tick){var d={epoch:parseInt(a.tick.epoch),quote:parseFloat(a.tick.quote)};if(d.epoch>b.contract_start_moment.unix()){if(b.applicable_ticks.length>=b.ticks_needed)return void b.evaluate_contract_outcome();if(!b.chart)return;if(!b.chart.series)return;b.chart.series[0].addPoint([b.counter,d.quote],!0,!1),b.applicable_ticks.push(d);var e="_"+b.counter;"undefined"!=typeof b.x_indicators[e]&&(b.x_indicators[e].index=b.counter,b.add(b.x_indicators[e])),b.add_barrier(),b.apply_chart_background_color(d),b.counter++}}};var User=function(){var a={};return{set:function(b){a=b},get:function(){return a}}}();RealityCheck=function(a){"use strict";function b(b,c,d){var e;return this.cookieName=b,this.storage=c,e=(a.cookie(this.cookieName)||"").split(","),e[0]=parseInt(e[0]),isNaN(e[0])||e[0]<=0||(e[1]&&e[1]!=c.get("reality_check.srvtime")&&(c.set("reality_check.srvtime",e[1]),c.set("reality_check.basetime",(new Date).getTime()),c.set("reality_check.ack",1)),this.logoutLocation=d,!this.logoutLocation)?void 0:(this.interval=60*parseInt(e)*1e3,this.basetime=c.get("reality_check.basetime"),this.setAlarm())}var c=page.url.url_for("user/reality_check");return b.prototype.setAlarm=function(){var a=this,b=this.interval-((new Date).getTime()-this.basetime)%this.interval;this.tmout&&window.clearTimeout(this.tmout),this.tmout=window.setTimeout(function(){a.fire()},b)},b.prototype.fire=function(){var b=this;a.ajax({url:c,dataType:"text",success:function(a){b.display(a)},error:function(a){404!==a.status&&window.setTimeout(function(){b.fire()},5e3)}})},b.prototype.display=function(b){var c,d,e,f=this;c=a("#reality-check"),c&&c.remove(),c=a("<div id='reality-check' class='lightbox'></div>").appendTo("body"),d=a("<div />").appendTo(c),a("<div>"+b+"</div>").appendTo(d),e=function(b){var c;"reality_check.ack"===b.originalEvent.key&&(c=parseInt(b.originalEvent.newValue||1),c>f.lastAck&&(a(window).off("storage",e),f.setAlarm(),a("#reality-check").remove()))},a(window).on("storage",e),this.lastAck=parseInt(this.storage.get("reality_check.ack")||1),a("#reality-check [bcont=1]").on("click",function(){f.storage.set("reality_check.ack",f.lastAck+1),a(window).off("storage",e),f.setAlarm(),a("#reality-check").remove()}),a("#reality-check .blogout").on("click",function(){window.location.href=f.logoutLocation})},b}(jQuery),onLoad.queue(function(){var a=$("#btn_logout")[0];a&&(window.reality_check_object||(window.reality_check_object=new RealityCheck("reality_check",LocalStore,a.getAttribute("href"))))});var ajax_loggedin=function(a){var b=$.cookie("login");if(b){var c="login="+encodeURIComponent(b),d=$.cookie("staff");d&&(c+="&staff="+encodeURIComponent(d)),a.data?a.data+="&"+c:a.data=c}return a.data&&a.data.length>2e3&&(a.type="POST"),a};if("function"==typeof is_japan)var Contract=function(){"use strict";var a,b,c,d,e={},f={},g={},h=function(a){var b=a.contract_category;g[b]||(g[b]={}),g[b][a.underlying_symbol]||(g[b][a.underlying_symbol]={});var c=a.trading_period.date_start.epoch+"_"+a.trading_period.date_expiry.epoch;g[b][a.underlying_symbol][c]={available_barriers:a.available_barriers,barrier:a.barrier,high_barrier:a.high_barrier,low_barrier:a.low_barrier,barriers:a.barriers,date_start:a.trading_period.date_start,date_expiry:a.trading_period.date_expiry,duration:a.trading_period.duration}},i=function(e){var g,i=Contract.contracts().contracts_for;a=i.open,b=i.close;var j=getFormNameBarrierCategory(e);c=e=j.formName,d=g=j.barrierCategory,i.available.forEach(function(a){var b=a.contract_category;e&&e===b&&(h(a),f[b]||(f[b]={}),f[b].hasOwnProperty(a.contract_type)||(f[b][a.contract_type]=a.contract_display))})},j=function(a){TradeSocket.send({contracts_for:a,region:"japan"})},k=function(){var a=Contract.contracts().contracts_for,b={};return a.available.forEach(function(a){var c=a.contract_category;c&&!b.hasOwnProperty(c)&&("callput"===c?"euro_atm"===a.barrier_category?b.risefall=Content.localize().textFormRiseFall:b.higherlower=Content.localize().textFormHigherLower:b[c]=a.contract_category_display)}),b};return{details:i,getContracts:j,contractForms:k,open:function(){return a},close:function(){return b},contracts:function(){return e},durations:function(){return!1},startDates:function(){return!1},barriers:function(){return!1},periods:function(){return g},contractType:function(){return f},form:function(){return c},barrier:function(){return d},setContracts:function(a){e=a}}}();if("function"==typeof is_japan){var lowBarrierElement=document.getElementById("barrier_low");lowBarrierElement&&lowBarrierElement.addEventListener("change",function(){processPriceRequest()});var jhighBarrierElement=document.getElementById("jbarrier_high");jhighBarrierElement&&jhighBarrierElement.addEventListener("change",function(){processPriceRequest()});var jlowBarrierElement=document.getElementById("jbarrier_low");jlowBarrierElement&&jlowBarrierElement.addEventListener("change",function(){var a=jhighBarrierElement.getElementsByTagName("option"),b=0;jhighBarrierElement.value>jlowBarrierElement.value&&(b=1);for(var c=0;c<a.length;c++)option=a[c],option.value<=jlowBarrierElement.value?option.setAttribute("disabled",!0):(b||(jhighBarrierElement.value=option.value,b=1),option.removeAttribute("disabled"));processPriceRequest()});var barrierElement=document.getElementById("jbarrier");barrierElement&&barrierElement.addEventListener("change",function(){processPriceRequest()});var period=document.getElementById("period");period&&period.addEventListener("change",function(){Periods.displayBarriers(),processPriceRequest()});for(var amount_type=document.getElementById("amount_type"),options=amount_type.getElementsByTagName("option"),i=0;i<options.length;i++)"payout"!=options[i].value&&options[i].setAttribute("disabled",!0)}if("function"==typeof is_japan)var Periods=function(){var a=0,b=0,c=function(){var a=Contract.periods();if(!a)return!1;for(var b=document.getElementById("period_row"),c=document.getElementById("period"),e=Contract.form(),f=document.getElementById("underlying").value,g=document.createDocumentFragment();c&&c.firstChild;)c.removeChild(c.firstChild);return a[e]&&a[e][f]?(b.style.display="flex",a=a[e][f],list=Object.keys(a),list.sort(function(b,c){return a[b].date_expiry.epoch-a[b].date_start.epoch>a[c].date_expiry.epoch-a[c].date_start.epoch?1:a[b].date_expiry.epoch-a[b].date_start.epoch<a[c].date_expiry.epoch-a[c].date_start.epoch?-1:a[b].date_start.epoch>a[c].date_start.epoch?1:-1}),list.forEach(function(b){var c,d,e,f=a[b];if(f.duration.match(/^\d+h$/)){var h=f.date_start.date.match(/^\d{4}-\d{2}-\d{2}\s+(\d{2}):(\d{2}):\d{2}$/),i=h[1],j=h[2],k=f.date_expiry.date.match(/^\d{4}-\d{2}-\d{2}\s+(\d{2}):(\d{2}):\d{2}$/),l=k[1],m=k[2];e=i+":"+j+" - "+l+":"+m+" ("+f.duration+")"}else e=f.date_expiry.date+" ("+f.duration+")";c=document.createElement("option"),d=document.createTextNode(e),c.setAttribute("value",b),c.appendChild(d),g.appendChild(c)}),c.appendChild(g),void d()):!1},d=function(){var c=Contract.periods();if(!c)return!1;for(var d=document.getElementById("jbarrier"),e=document.getElementById("jbarrier_high"),f=document.getElementById("jbarrier_low"),g=Contract.form(),h=document.getElementById("underlying").value,i=document.getElementById("period").value,j=document.createDocumentFragment();d&&d.firstChild;)d.removeChild(d.firstChild);for(;e&&e.firstChild;)e.removeChild(e.firstChild);for(;f&&f.firstChild;)f.removeChild(f.firstChild);if(!c[g]||!c[g][h]||!c[g][h][i])return!1;if(document.getElementById("barrier_row").style.display="none",document.getElementById("high_barrier_row").style.display="none",document.getElementById("low_barrier_row").style.display="none",1==c[g][h][i].barriers){document.getElementById("jbarrier_row").style.display="flex",document.getElementById("jhigh_barrier_row").style.display="none",document.getElementById("jlow_barrier_row").style.display="none";var k=c[g][h][i].available_barriers;k.sort(),k.forEach(function(a){option=document.createElement("option"),content=document.createTextNode(a),option.setAttribute("value",a),option.appendChild(content),j.appendChild(option)}),d.appendChild(j),a=d.value=c[g][h][i].barrier}else{document.getElementById("jbarrier_row").style.display="none",document.getElementById("jhigh_barrier_row").style.display="flex",document.getElementById("jlow_barrier_row").style.display="flex";var l=c[g][h][i].available_barriers[1];l.sort(),l.forEach(function(a){option=document.createElement("option"),content=document.createTextNode(a),option.setAttribute("value",a),a<=c[g][h][i].low_barrier&&option.setAttribute("disabled",!0),option.appendChild(content),j.appendChild(option)}),e.appendChild(j),a=e.value=c[g][h][i].high_barrier;var m=c[g][h][i].available_barriers[0];m.sort(),m.forEach(function(a){option=document.createElement("option"),content=document.createTextNode(a),option.setAttribute("value",a),option.appendChild(content),j.appendChild(option)}),f.appendChild(j),b=f.value=c[g][h][i].low_barrier}};return{barrier:function(){return a},barrier2:function(){return b},displayPeriods:c,displayBarriers:d}}();if("function"==typeof is_japan){var Price=Object.create(Price);Object.defineProperties(Price,{proposal:{value:function(a){var b=Object.getPrototypeOf(this),c=b.proposal(a),d=document.getElementById("period"),e=document.getElementById("jbarrier"),f=document.getElementById("jbarrier_high"),g=document.getElementById("jbarrier_low");if(e&&isVisible(e)&&e.value&&(c.barrier=e.value),f&&isVisible(f)&&f.value&&(c.barrier=f.value),g&&isVisible(g)&&g.value&&(c.barrier2=g.value),d&&isVisible(d)&&d.value){var h=d.value.match(/^\d+_(\d+)$/);h&&(c.date_expiry=h[1])}return c}}})}if("function"==typeof is_japan)var processContractForm=function(){Contract.details(sessionStorage.getItem("formname")),displayStartDates(),Durations.display(),Periods&&Periods.displayPeriods(),displayPrediction(),processPriceRequest()};"function"==typeof is_japan&&(Symbols._details=Symbols.details.bind({}),Object.defineProperties(Symbols,{details:{value:function(a){var b=[];return a.active_symbols.forEach(function(a){"forex"===a.market&&"major_pairs"===a.submarket&&b.push(a)}),a.active_symbols=b,Symbols._details(a)}}}));
//# sourceMappingURL=binary.min.js.map